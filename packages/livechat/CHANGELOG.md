# @rocket.chat/livechat Change Log

## 1.21.2

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@14.0.1
  </details>

## 1.21.1

### Patch Changes

- ([#34205](https://github.com/RocketChat/Rocket.Chat/pull/34205)) Fixes an error where the engine would not retry a subprocess restart if the last attempt failed

- ([#34205](https://github.com/RocketChat/Rocket.Chat/pull/34205)) Fixes error propagation when trying to get the status of apps in some cases

- ([#34158](https://github.com/RocketChat/Rocket.Chat/pull/34158)) Fixes issue that caused different sessions when opening a livechat popover in cross domain

- ([#34205](https://github.com/RocketChat/Rocket.Chat/pull/34205)) Fixes wrong data being reported to total failed apps metrics and statistics

- <details><summary>Updated dependencies [76f6239ff1a9f34f163c03c140c4ceba62563b4e, 76f6239ff1a9f34f163c03c140c4ceba62563b4e, 76f6239ff1a9f34f163c03c140c4ceba62563b4e]:</summary>

  - @rocket.chat/gazzodown@14.0.0
  </details>

## 1.21.1-rc.3

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@14.0.0-rc.3
  </details>

## 1.21.1-rc.2

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@14.0.0-rc.2
  </details>

## 1.21.1-rc.1

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@14.0.0-rc.1
  </details>

## 1.21.1-rc.0

### Patch Changes

- ([#34205](https://github.com/RocketChat/Rocket.Chat/pull/34205)) Fixes an error where the engine would not retry a subprocess restart if the last attempt failed

- ([#34205](https://github.com/RocketChat/Rocket.Chat/pull/34205)) Fixes error propagation when trying to get the status of apps in some cases

- ([#34158](https://github.com/RocketChat/Rocket.Chat/pull/34158)) Fixes issue that caused different sessions when opening a livechat popover in cross domain

- ([#34205](https://github.com/RocketChat/Rocket.Chat/pull/34205)) Fixes wrong data being reported to total failed apps metrics and statistics

- <details><summary>Updated dependencies [76f6239ff1a9f34f163c03c140c4ceba62563b4e, 76f6239ff1a9f34f163c03c140c4ceba62563b4e, 76f6239ff1a9f34f163c03c140c4ceba62563b4e]:</summary>

  - @rocket.chat/gazzodown@14.0.0-rc.0
  </details>

## 1.21.0

### Minor Changes

- ([#33997](https://github.com/RocketChat/Rocket.Chat/pull/33997)) Prevent apps' subprocesses from crashing on unhandled rejections or uncaught exceptions

### Patch Changes

- ([#33911](https://github.com/RocketChat/Rocket.Chat/pull/33911)) Fixes the 'Finish Chat' option in Livechat appearing before the conversation is started, which caused the action to fail.

- ([#33944](https://github.com/RocketChat/Rocket.Chat/pull/33944)) Fixes livechat popout mode not working correctly in cross domain situations

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@13.0.0
  </details>

## 1.21.0-rc.3

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@13.0.0-rc.3
  </details>

## 1.21.0-rc.2

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@13.0.0-rc.2
  </details>

## 1.21.0-rc.1

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@13.0.0-rc.1
  </details>

## 1.21.0-rc.0

### Minor Changes

- ([#33997](https://github.com/RocketChat/Rocket.Chat/pull/33997)) Prevent apps' subprocesses from crashing on unhandled rejections or uncaught exceptions

### Patch Changes

- ([#33911](https://github.com/RocketChat/Rocket.Chat/pull/33911)) Fixes the 'Finish Chat' option in Livechat appearing before the conversation is started, which caused the action to fail.

- ([#33944](https://github.com/RocketChat/Rocket.Chat/pull/33944)) Fixes livechat popout mode not working correctly in cross domain situations

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@13.0.0-rc.0
  </details>

## 1.20.1

### Patch Changes

- ([#33229](https://github.com/RocketChat/Rocket.Chat/pull/33229)) Fixes an issue where the unread message counter in the livechat widget does not update when a visitor receives their first response from an agent while the widget is minimized.

- <details><summary>Updated dependencies [687f1efd5f, 9274cf4586, debd3ffa22]:</summary>

  - @rocket.chat/ui-kit@0.37.0
  - @rocket.chat/gazzodown@12.0.0
  </details>

## 1.20.1-rc.6

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@12.0.0-rc.6
  </details>

## 1.20.1-rc.5

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@12.0.0-rc.5
  </details>

## 1.20.1-rc.4

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@12.0.0-rc.4
  </details>

## 1.20.1-rc.3

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@12.0.0-rc.3
  </details>

## 1.20.1-rc.2

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@12.0.0-rc.2
  </details>

## 1.20.1-rc.1

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@12.0.0-rc.1
  </details>

## 1.20.1-rc.0

### Patch Changes

- ([#33229](https://github.com/RocketChat/Rocket.Chat/pull/33229)) Fixes an issue where the unread message counter in the livechat widget does not update when a visitor receives their first response from an agent while the widget is minimized.

- <details><summary>Updated dependencies [687f1efd5f, 9274cf4586, debd3ffa22]:</summary>

  - @rocket.chat/ui-kit@0.37.0-rc.0
  - @rocket.chat/gazzodown@12.0.0-rc.0
  </details>

## 1.20.0

### Minor Changes

- ([#33139](https://github.com/RocketChat/Rocket.Chat/pull/33139)) Added new setting `Allow visitors to finish conversations` that allows admins to decide if omnichannel visitors can close a conversation or not. This doesn't affect agent's capabilities of room closing, neither apps using the livechat bridge to close rooms.
  However, if currently your integration relies on `livechat/room.close` endpoint for closing conversations, it's advised to use the authenticated version `livechat/room.closeByUser` of it before turning off this setting.

### Patch Changes

- ([#33229](https://github.com/RocketChat/Rocket.Chat/pull/33229)) Fixes an issue where the unread message counter in the livechat widget does not update when a visitor receives their first response from an agent while the widget is minimized.

- <details><summary>Updated dependencies [cd0d50016e, 79c16d315a]:</summary>

  - @rocket.chat/gazzodown@11.0.0
  - @rocket.chat/message-parser@0.31.31
  </details>

## 1.20.0-rc.6

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@11.0.0-rc.6
  </details>

## 1.20.0-rc.5

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@11.0.0-rc.5
  </details>

## 1.20.0-rc.4

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@11.0.0-rc.4
  </details>

## 1.20.0-rc.3

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@11.0.0-rc.3
  </details>

## 1.20.0-rc.2

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@11.0.0-rc.2
  </details>

## 1.20.0-rc.1

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@11.0.0-rc.1
  </details>

## 1.20.0-rc.0

### Minor Changes

- ([#33139](https://github.com/RocketChat/Rocket.Chat/pull/33139)) Added new setting `Allow visitors to finish conversations` that allows admins to decide if omnichannel visitors can close a conversation or not. This doesn't affect agent's capabilities of room closing, neither apps using the livechat bridge to close rooms.
  However, if currently your integration relies on `livechat/room.close` endpoint for closing conversations, it's advised to use the authenticated version `livechat/room.closeByUser` of it before turning off this setting.

### Patch Changes

- <details><summary>Updated dependencies [cd0d50016e, 79c16d315a]:</summary>

  - @rocket.chat/gazzodown@11.0.0-rc.0
  - @rocket.chat/message-parser@0.31.30-rc.0
  </details>

## 1.19.4

### Patch Changes

- <details><summary>Updated dependencies [3cbb9f6252]:</summary>

  - @rocket.chat/message-parser@0.31.30
  - @rocket.chat/gazzodown@10.0.1
  </details>

## 1.19.3

### Patch Changes

- ([#32928](https://github.com/RocketChat/Rocket.Chat/pull/32928)) Fixed issue where `after-registration-triggers` would show up in a page when the user was not yet registered

- <details><summary>Updated dependencies [8ea6517c4e, c11f3722df]:</summary>

  - @rocket.chat/gazzodown@10.0.0
  - @rocket.chat/ui-kit@0.36.1
  </details>

## 1.19.3-rc.6

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@10.0.0-rc.6
  </details>

## 1.19.3-rc.5

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@10.0.0-rc.5
  </details>

## 1.19.3-rc.4

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@10.0.0-rc.4
  </details>

## 1.19.3-rc.3

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@10.0.0-rc.3
  </details>

## 1.19.3-rc.2

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@10.0.0-rc.2
  </details>

## 1.19.3-rc.1

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@10.0.0-rc.1
  </details>

## 1.19.3-rc.0

### Patch Changes

- ([#32928](https://github.com/RocketChat/Rocket.Chat/pull/32928)) Fixed issue where `after-registration-triggers` would show up in a page when the user was not yet registered

- <details><summary>Updated dependencies [8ea6517c4e, c11f3722df]:</summary>

  - @rocket.chat/gazzodown@10.0.0-rc.0
  - @rocket.chat/ui-kit@0.36.1-rc.0
  </details>

## 1.19.2

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@9.0.2
  </details>

## 1.19.1

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@9.0.1
  </details>

## 1.19.0

### Minor Changes

- ([#32498](https://github.com/RocketChat/Rocket.Chat/pull/32498)) Created a `transferChat` Livechat API endpoint for transferring chats programmatically, the endpoint has all the limitations & permissions required that transferring via UI has

### Patch Changes

- ([#32692](https://github.com/RocketChat/Rocket.Chat/pull/32692)) Fixed an issue that caused the widget to set the wrong department when using the setDepartment Livechat api endpoint in conjunction with a Livechat Trigger

- ([#32626](https://github.com/RocketChat/Rocket.Chat/pull/32626)) livechat `setDepartment` livechat api fixes:
  - Changing department didn't reflect on the registration form in real time
  - Changing the department mid conversation didn't transfer the chat
  - Depending on the state of the department, it couldn't be set as default
- <details><summary>Updated dependencies [2d89a0c448]:</summary>

  - @rocket.chat/ui-kit@0.36.0
  - @rocket.chat/gazzodown@9.0.0
  </details>

## 1.19.0-rc.6

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@9.0.0-rc.6
  </details>

## 1.19.0-rc.5

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@9.0.0-rc.5
  </details>

## 1.19.0-rc.4

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@9.0.0-rc.4
  </details>

## 1.19.0-rc.3

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@9.0.0-rc.3
  </details>

## 1.19.0-rc.2

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@9.0.0-rc.2
  </details>

## 1.19.0-rc.1

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@9.0.0-rc.1
  </details>

## 1.19.0-rc.0

### Minor Changes

- ([#32498](https://github.com/RocketChat/Rocket.Chat/pull/32498)) Created a `transferChat` Livechat API endpoint for transferring chats programmatically, the endpoint has all the limitations & permissions required that transferring via UI has

### Patch Changes

- ([#32692](https://github.com/RocketChat/Rocket.Chat/pull/32692)) Fixed an issue that caused the widget to set the wrong department when using the setDepartment Livechat api endpoint in conjunction with a Livechat Trigger

- ([#32626](https://github.com/RocketChat/Rocket.Chat/pull/32626)) livechat `setDepartment` livechat api fixes:
  - Changing department didn't reflect on the registration form in real time
  - Changing the department mid conversation didn't transfer the chat
  - Depending on the state of the department, it couldn't be set as default
- <details><summary>Updated dependencies [2d89a0c448]:</summary>

  - @rocket.chat/ui-kit@0.36.0-rc.0
  - @rocket.chat/gazzodown@9.0.0-rc.0

## 1.18.2

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@8.0.2
  </details>
  </details>

## 1.18.1

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@8.0.1
  </details>

## 1.18.0

### Minor Changes

- ([#31821](https://github.com/RocketChat/Rocket.Chat/pull/31821)) New runtime for apps in the Apps-Engine based on the Deno platform

### Patch Changes

- <details><summary>Updated dependencies [a565999ae0, 59df102d0c, 4f72d62aa7]:</summary>

  - @rocket.chat/ui-kit@0.35.0
  - @rocket.chat/gazzodown@8.0.0
  </details>

## 1.18.0-rc.7

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@8.0.0-rc.7
  </details>

## 1.18.0-rc.6

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@8.0.0-rc.6
  </details>

## 1.18.0-rc.5

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@8.0.0-rc.5
  </details>

## 1.18.0-rc.4

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@8.0.0-rc.4
  </details>

## 1.18.0-rc.3

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@8.0.0-rc.3
  </details>

## 1.18.0-rc.2

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@8.0.0-rc.2
  </details>

## 1.18.0-rc.1

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@8.0.0-rc.1
  </details>

## 1.18.0-rc.0

### Minor Changes

- ([#31821](https://github.com/RocketChat/Rocket.Chat/pull/31821)) New runtime for apps in the Apps-Engine based on the Deno platform

### Patch Changes

- <details><summary>Updated dependencies [a565999ae0, 59df102d0c, 4f72d62aa7]:</summary>

  - @rocket.chat/ui-kit@0.35.0-rc.0
  - @rocket.chat/gazzodown@8.0.0-rc.0

  </details>

## 1.17.3

### Patch Changes

- ([#32683](https://github.com/RocketChat/Rocket.Chat/pull/32683) by [@dionisio-bot](https://github.com/dionisio-bot)) livechat `setDepartment` livechat api fixes:
  - Changing department didn't reflect on the registration form in real time
  - Changing the department mid conversation didn't transfer the chat
  - Depending on the state of the department, it couldn't be set as default
- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@7.0.3
  </details>

## 1.17.2

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@7.0.2
  </details>

## 1.17.1

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@7.0.1
  </details>

## 1.17.0

### Minor Changes

- ([#32233](https://github.com/RocketChat/Rocket.Chat/pull/32233)) Makes the triggers fired by the condition `after-guest-registration` persist on the livechat client, it will persist through reloads and pagination, only reseting when a conversation is closed (no changes were done on the agent side of the conversation)

### Patch Changes

- <details><summary>Updated dependencies [ee5cdfc367]:</summary>

  - @rocket.chat/ui-kit@0.34.0
  - @rocket.chat/gazzodown@7.0.0
  </details>

## 1.17.0-rc.2

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@7.0.0-rc.2
  </details>

## 1.17.0-rc.1

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@7.0.0-rc.1
  </details>

## 1.17.0-rc.0

### Minor Changes

- ([#32233](https://github.com/RocketChat/Rocket.Chat/pull/32233)) Makes the triggers fired by the condition `after-guest-registration` persist on the livechat client, it will persist through reloads and pagination, only reseting when a conversation is closed (no changes were done on the agent side of the conversation)

### Patch Changes

- <details><summary>Updated dependencies [ee5cdfc367]:</summary>

  - @rocket.chat/ui-kit@0.34.0-rc.0
  - @rocket.chat/gazzodown@7.0.0-rc.0
  </details>

## 1.16.0

### Patch Changes

- ([#31765](https://github.com/RocketChat/Rocket.Chat/pull/31765)) Fixes the livechat client ignoring the `livechat_fileuploads_enabled` setting when uploading files

- ([#32069](https://github.com/RocketChat/Rocket.Chat/pull/32069)) Livechat: A registered user loses their messages if 'registerGuest' is called using the same token.

- ([#32135](https://github.com/RocketChat/Rocket.Chat/pull/32135)) Fixes issue causing a desync in different browser windows when a chat is closed and started again

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@6.0.0
  - @rocket.chat/message-parser@0.31.29
  - @rocket.chat/random@1.2.2
  - @rocket.chat/ui-kit@0.33.0
  </details>

## 1.16.0-rc.2

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@6.0.0-rc.2
  </details>

## 1.16.0-rc.1

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@6.0.0-rc.1
  </details>

## 1.16.0-rc.0

### Patch Changes

- ([#31765](https://github.com/RocketChat/Rocket.Chat/pull/31765)) Fixes the livechat client ignoring the `livechat_fileuploads_enabled` setting when uploading files

- ([#32069](https://github.com/RocketChat/Rocket.Chat/pull/32069)) Livechat: A registered user loses their messages if 'registerGuest' is called using the same token.

- ([#32135](https://github.com/RocketChat/Rocket.Chat/pull/32135)) Fixes issue causing a desync in different browser windows when a chat is closed and started again

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@6.0.0-rc.0
  - @rocket.chat/message-parser@0.31.29
  - @rocket.chat/random@1.2.2
  - @rocket.chat/ui-kit@0.33.0

## 1.15.2

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@5.0.2
  </details>

## 1.15.1

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@5.0.1
  </details>

## 1.15.0

### Minor Changes

- ([#31820](https://github.com/RocketChat/Rocket.Chat/pull/31820)) **Added the ability for premium workspaces to hide Rocket.Chat's watermark as well as change the Livechat widget's logo**

  The new settings (named below) can be found in the Omnichannel workspace settings within the livechat section.

  - Hide "powered by Rocket.Chat"
  - Livechat widget logo (svg, png, jpg)

- ([#31751](https://github.com/RocketChat/Rocket.Chat/pull/31751)) Added Livechat setting `Hide system messages` & API method `setHiddenSystemMessages`, to customize system message visibility within the widget.

- ([#31772](https://github.com/RocketChat/Rocket.Chat/pull/31772)) Improved Livechat's theming capabilities

  | Name (`setTheme`, `initialize`) | Workspace setting                      | Default value | Description                                                                                                                                                |
  | ------------------------------- | -------------------------------------- | ------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------- |
  | `position`                      | Livechat widget position on the screen | `right`       | Changes the widget position on the screen. Can be `left` or `right`                                                                                        |
  | `background`                    | Livechat background                    | `N/A`         | Changes the message list background. Accepts the same values as the CSS property [background](https://developer.mozilla.org/en-US/docs/Web/CSS/background) |
  | `guestBubbleBackgroundColor`    | `N/A`                                  | `N/A`         | Changes the guest's message bubble background color                                                                                                        |
  | `agentBubbleBackgroundColor`    | `N/A`                                  | `N/A`         | Changes the agent's message bubble background color                                                                                                        |
  | `hideGuestAvatar`               | `N/A`                                  | `false`       | Hides/shows the guest avatar                                                                                                                               |
  | `hideAgentAvatar`               | `N/A`                                  | `true`        | Hides/shows the agent avatar                                                                                                                               |

- ([#30924](https://github.com/RocketChat/Rocket.Chat/pull/30924)) chore: Refactor & Improve Livechat Widget API
  Refactors and adds better error handling to the widget's API calls
- ([#31268](https://github.com/RocketChat/Rocket.Chat/pull/31268)) Added new Livechat trigger action "Send message (external service)"

### Patch Changes

- ([#31663](https://github.com/RocketChat/Rocket.Chat/pull/31663)) Fixes issue causing the setDepartment Livechat API overriding some triggers conditions

- ([#31718](https://github.com/RocketChat/Rocket.Chat/pull/31718)) Allows the after-guest-registration trigger to run when starting a new chat after finishing a chat when the clear guest data when chat ended setting is set to false

- ([#32069](https://github.com/RocketChat/Rocket.Chat/pull/32069)) Livechat: A registered user loses their messages if 'registerGuest' is called using the same token.

- ([#32031](https://github.com/RocketChat/Rocket.Chat/pull/32031)) Fixes issue where the livechat offline form would render even when disabled

- ([#31752](https://github.com/RocketChat/Rocket.Chat/pull/31752)) fixed livechat UI blinking different colors when the chat is finished

- ([#31792](https://github.com/RocketChat/Rocket.Chat/pull/31792)) Fixes issue of the `setDepartment` Livechat API method not setting the store value properly (is was only setting on the guest object)

- ([#32135](https://github.com/RocketChat/Rocket.Chat/pull/32135)) Fixes issue causing a desync in different browser windows when a chat is closed and started again

- <details><summary>Updated dependencies [5ad65ff3da]:</summary>

  - @rocket.chat/message-parser@0.31.29
  - @rocket.chat/gazzodown@5.0.0
  - @rocket.chat/random@1.2.2
  - @rocket.chat/ui-kit@0.33.0
  </details>

## 1.15.0-rc.4

### Patch Changes

- ([#32135](https://github.com/RocketChat/Rocket.Chat/pull/32135)) Fixes issue causing a desync in different browser windows when a chat is closed and started again

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@5.0.0-rc.4
  </details>

## 1.15.0-rc.3

### Patch Changes

- ([#32069](https://github.com/RocketChat/Rocket.Chat/pull/32069)) Livechat: A registered user loses their messages if 'registerGuest' is called using the same token.

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@5.0.0-rc.3
  </details>

## 1.15.0-rc.2

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@5.0.0-rc.2
  </details>

## 1.15.0-rc.1

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@5.0.0-rc.1
  </details>

## 1.15.0-rc.0

### Minor Changes

- ([#31820](https://github.com/RocketChat/Rocket.Chat/pull/31820)) **Added the ability for premium workspaces to hide Rocket.Chat's watermark as well as change the Livechat widget's logo**

  The new settings (named below) can be found in the Omnichannel workspace settings within the livechat section.

  - Hide "powered by Rocket.Chat"
  - Livechat widget logo (svg, png, jpg)

- ([#31751](https://github.com/RocketChat/Rocket.Chat/pull/31751)) Added Livechat setting `Hide system messages` & API method `setHiddenSystemMessages`, to customize system message visibility within the widget.

- ([#31772](https://github.com/RocketChat/Rocket.Chat/pull/31772)) Improved Livechat's theming capabilities

  | Name (`setTheme`, `initialize`) | Workspace setting                      | Default value | Description                                                                                                                                                |
  | ------------------------------- | -------------------------------------- | ------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------- |
  | `position`                      | Livechat widget position on the screen | `right`       | Changes the widget position on the screen. Can be `left` or `right`                                                                                        |
  | `background`                    | Livechat background                    | `N/A`         | Changes the message list background. Accepts the same values as the CSS property [background](https://developer.mozilla.org/en-US/docs/Web/CSS/background) |
  | `guestBubbleBackgroundColor`    | `N/A`                                  | `N/A`         | Changes the guest's message bubble background color                                                                                                        |
  | `agentBubbleBackgroundColor`    | `N/A`                                  | `N/A`         | Changes the agent's message bubble background color                                                                                                        |
  | `hideGuestAvatar`               | `N/A`                                  | `false`       | Hides/shows the guest avatar                                                                                                                               |
  | `hideAgentAvatar`               | `N/A`                                  | `true`        | Hides/shows the agent avatar                                                                                                                               |

- ([#30924](https://github.com/RocketChat/Rocket.Chat/pull/30924)) chore: Refactor & Improve Livechat Widget API
  Refactors and adds better error handling to the widget's API calls
- ([#31268](https://github.com/RocketChat/Rocket.Chat/pull/31268)) Added new Livechat trigger action "Send message (external service)"

### Patch Changes

- ([#31663](https://github.com/RocketChat/Rocket.Chat/pull/31663)) Fixes issue causing the setDepartment Livechat API overriding some triggers conditions

- ([#31718](https://github.com/RocketChat/Rocket.Chat/pull/31718)) Allows the after-guest-registration trigger to run when starting a new chat after finishing a chat when the clear guest data when chat ended setting is set to false

- ([#32031](https://github.com/RocketChat/Rocket.Chat/pull/32031)) Fixes issue where the livechat offline form would render even when disabled

- ([#31752](https://github.com/RocketChat/Rocket.Chat/pull/31752)) fixed livechat UI blinking different colors when the chat is finished

- ([#31792](https://github.com/RocketChat/Rocket.Chat/pull/31792)) Fixes issue of the `setDepartment` Livechat API method not setting the store value properly (is was only setting on the guest object)

- <details><summary>Updated dependencies [5ad65ff3da]:</summary>

  - @rocket.chat/message-parser@0.31.29-rc.0
  - @rocket.chat/gazzodown@5.0.0-rc.0
  - @rocket.chat/random@1.2.2
  - @rocket.chat/ui-kit@0.33.0
  </details>

## 1.14.19

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@4.0.6
  </details>

## 1.14.18

### Patch Changes

- ([#31792](https://github.com/RocketChat/Rocket.Chat/pull/31792)) Fixes issue of the `setDepartment` Livechat API method not setting the store value properly (is was only setting on the guest object)

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@4.0.5
  </details>

## 1.14.17

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@4.0.4
  </details>

## 1.14.16

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@4.0.3
  </details>

## 1.14.15

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@4.0.2
  </details>

## 1.14.14

### Patch Changes

- ([#31752](https://github.com/RocketChat/Rocket.Chat/pull/31752)) fixed livechat UI blinking different colors when the chat is finished

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@4.0.1
  </details>

## 1.14.13

### Patch Changes

- ([#31138](https://github.com/RocketChat/Rocket.Chat/pull/31138)) feat(uikit): Move `@rocket.chat/ui-kit` package to the main monorepo

- ([#31349](https://github.com/RocketChat/Rocket.Chat/pull/31349) by [@Subhojit-Dey1234](https://github.com/Subhojit-Dey1234)) feat: Implemented InlineCode handling in Bold, Italic and Strike

- ([#31454](https://github.com/RocketChat/Rocket.Chat/pull/31454)) Fixed an issue with translations that caused text containing special characters to be shown escaped on UI

- ([#31302](https://github.com/RocketChat/Rocket.Chat/pull/31302)) Fixed a problem that caused Livechat Widget registration page to ignore the `showOnRegistration` flag for departments, showing all items.

- <details><summary>Updated dependencies [b223cbde14, dbb08ef948]:</summary>

  - @rocket.chat/ui-kit@0.33.0
  - @rocket.chat/gazzodown@4.0.0
  - @rocket.chat/random@1.2.2
  </details>

## 1.14.13-rc.7

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@4.0.0-rc.7
  </details>

## 1.14.13-rc.6

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@4.0.0-rc.6
  </details>

## 1.14.13-rc.5

### Patch Changes

- <details><summary>Updated dependencies []:</summary>

  - @rocket.chat/gazzodown@4.0.0-rc.5
  </details>

## 1.14.13-rc.4

### Patch Changes

- @rocket.chat/gazzodown@4.0.0-rc.4

## 1.14.13-rc.3

### Patch Changes

- @rocket.chat/gazzodown@4.0.0-rc.3

## 1.14.13-rc.2

### Patch Changes

- @rocket.chat/gazzodown@4.0.0-rc.2

## 1.14.13-rc.1

### Patch Changes

- @rocket.chat/gazzodown@4.0.0-rc.1

## 1.14.13-rc.0

### Patch Changes

- b223cbde14: feat(uikit): Move `@rocket.chat/ui-kit` package to the main monorepo
- dbb08ef948: feat: Implemented InlineCode handling in Bold, Italic and Strike
- bc28633c69: Fixed an issue with translations that caused text containing special characters to be shown escaped on UI
- 5d73947a4f: Fixed a problem that caused Livechat Widget registration page to ignore the `showOnRegistration` flag for departments, showing all items.
- Updated dependencies [b223cbde14]
- Updated dependencies [dbb08ef948]
  - @rocket.chat/ui-kit@0.33.0-rc.0
  - @rocket.chat/gazzodown@4.0.0-rc.0
  - @rocket.chat/random@1.2.2-rc.0

## 1.14.12

### Patch Changes

- @rocket.chat/gazzodown@3.0.3

## 1.14.11

### Patch Changes

- @rocket.chat/gazzodown@3.0.2

## 1.14.10

### Patch Changes

- @rocket.chat/gazzodown@3.0.1

## 1.14.9

### Patch Changes

- Updated dependencies [c2f337664e]
  - @rocket.chat/gazzodown@3.0.0

## 1.14.9-rc.12

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.19

## 1.14.9-rc.11

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.18

## 1.14.9-rc.10

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.17

## 1.14.9-rc.9

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.16

## 1.14.9-rc.8

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.15

## 1.14.9-rc.7

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.14

## 1.14.9-rc.6

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.13

## 1.14.9-rc.5

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.12

## 1.14.9-rc.4

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.11

## 1.14.9-rc.3

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.10

## 1.14.9-rc.2

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.9

## 1.14.9-rc.1

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.8

## 1.14.6-rc.7

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.7

## 1.14.6-rc.6

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.6

## 1.14.6-rc.5

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.5

## 1.14.6-rc.4

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.4

## 1.14.6-rc.3

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.3

## 1.14.6-rc.2

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.2

## 1.14.6-rc.1

### Patch Changes

- @rocket.chat/gazzodown@3.0.0-rc.1

## 1.14.6-rc.0

### Patch Changes

- Updated dependencies [c2f337664e]
  - @rocket.chat/gazzodown@3.0.0-rc.0

## 1.14.8

### Patch Changes

- d1c8e7ac13: Fixes reactivity issue with `registerGuest` Widget API Call, as well as other similar endpoint
  - @rocket.chat/gazzodown@2.0.8

## 1.14.7

### Patch Changes

- @rocket.chat/gazzodown@2.0.7

## 1.14.6

### Patch Changes

- @rocket.chat/gazzodown@2.0.6

## 1.14.5

### Patch Changes

- @rocket.chat/gazzodown@2.0.5

## 1.14.4

### Patch Changes

- @rocket.chat/gazzodown@2.0.4

## 1.14.3

### Patch Changes

- @rocket.chat/gazzodown@2.0.3

## 1.14.2

### Patch Changes

- @rocket.chat/gazzodown@2.0.2

## 1.14.1

### Patch Changes

- @rocket.chat/gazzodown@2.0.1

## 1.14.0

### Minor Changes

- 04fe492555: Added new Omnichannel's trigger condition "After starting a chat".

### Patch Changes

- 62a13ed97d: chore: (Livechat) Replace all `dangerouslySetInnerHTML` with `gazzodown`
- 817141dcab: fix: Issue caused by spaces in the `config.url` setting
- b8f3d5014f: Fixed the login page language switcher, now the component has a new look, is reactive and the language selection becomes concrete upon login in. Also changed the default language of the login page to be the browser language.
  - @rocket.chat/gazzodown@2.0.0
  - @rocket.chat/random@1.2.1

## 1.14.0-rc.5

### Patch Changes

- @rocket.chat/gazzodown@2.0.0-rc.5

## 1.14.0-rc.4

### Patch Changes

- @rocket.chat/gazzodown@2.0.0-rc.4

## 1.14.0-rc.3

### Patch Changes

- @rocket.chat/gazzodown@2.0.0-rc.3

## 1.14.0-rc.2

### Patch Changes

- @rocket.chat/gazzodown@2.0.0-rc.2

## 1.14.0-rc.1

### Patch Changes

- @rocket.chat/gazzodown@2.0.0-rc.1

## 1.14.0-rc.0

### Minor Changes

- 04fe492555: Added new Omnichannel's trigger condition "After starting a chat".

### Patch Changes

- 62a13ed97d: chore: (Livechat) Replace all `dangerouslySetInnerHTML` with `gazzodown`
- 817141dcab: fix: Issue caused by spaces in the `config.url` setting
- b8f3d5014f: Fixed the login page language switcher, now the component has a new look, is reactive and the language selection becomes concrete upon login in. Also changed the default language of the login page to be the browser language.
  - @rocket.chat/gazzodown@2.0.0-rc.0
  - @rocket.chat/random@1.2.1

## 1.13.4

### Patch Changes

- e006013e5f: chore: New Livechat SDK Implementation
- c0cb917f76: Fixes Livechat page-url triggers requiring CORS to access the parent url
- 33be8f16b9: Storybook adjustments, TypeScript migration, and minor fixes

## 1.13.4-rc.0

### Patch Changes

- e006013e5f: chore: New Livechat SDK Implementation
- c0cb917f76: Fixes Livechat page-url triggers requiring CORS to access the parent url
- 33be8f16b9: Storybook adjustments, TypeScript migration, and minor fixes
  All notable changes to this project will be documented in this file.
  This project adheres to [Semantic Versioning](http://semver.org/).

## 1.13.3 - 2022-04-20

[FIX] Translations sync with admin config (#713)
[FIX] Broken triggers (#712)
[FIX] setting e-mail validation to RFC regex as the standard (#709)

## 1.13.2 - 2022-04-18

[FIX] Sync import for i18next load (#710)

## 1.13.1 - 2022-04-08

bump version

## 1.13.0 - 2022-04-08

Chore: Update cd.yml (#704)
Chore: Replace a / b with math.div(a, b) on SCSS files (#702)
[IMPROVE] Centralized e-mail validation under a library function #693
[FIX] Fixes broken triggers. #695
[IMPROVE] Add TypeScript (#694)
[IMPROVE] Replace i18n package (#657)
[FIX] Prevent html rendering on messages (#701)

## 1.12.2 - 2022-03-29

[FIX] Revert: LoadConfig after registering guest #696

## 1.12.1 - 2022-03-08

[FIX] Making sure the 'hide agent info' hides the agent info even with department change. (#688)

## 1.12.0 - 2022-01-20

[NEW] Introduce Widget API method to manage Business Units (#677)
[IMPROVE] Update FA translations (#653)

## 1.11.2 - 2022-01-10

[FIX] IME not working properly #674

## 1.11.1 - 2021-12-30

[FIX] Hide Livechat if Omnichannel is disabled #671

## 1.11.0 - 2021-12-09

[NEW] Introduce clearLocalStorageWhenChatEnded setting logic (#666)
[IMPROVE] Change logic to generate token on Live Chat (#667)

## 1.10.0 - 2021-11-22

[NEW] Audio and Video calling in Livechat using WebRTC (#646)
[FIX] LoadConfig after registering guest (#640)
[FIX] Body styles getting overridden (#660)

## 1.9.6 - 2021-10-20

[FIX] 'Hide agent info' not working on system message (#651)
[FIX] Issues on Custom Livechat messages (#648)

## 1.9.5 - 2021-09-14

[IMPROVE] Readme enhancements (#557)
[IMPROVE] Swedish Translations (#573)
[FIX] Escaping HTML on paste/drop Text (#471)
[IMPROVE] Spanish translations (#370)
[IMPROVE] Russian translations (#644)
[IMPROVE] Add cookie to identify widget calls (#645)

## 1.9.4 - 2021-08-19

[FIX] Iframe overlay (#631)
[IMPROVE] German informal translation (#622)
[FIX] Translation error on department (#632)
[IMPROVE] Open links in another tab on Livechat widget (#610)
[IMPROVE] Dutch Translations (#601)

## 1.9.3 - 2021-04-21

[FIX] sound notification on/off (#567)
[FIX] Invalid font size for hiragana and katakana (#559)

## 1.9.2 - 2021-04-13

bump version

## 1.9.1 - 2021-04-12

[CHORE] Circle CI to github actions #577
[CHORE] Remove circle CI #580

## 1.9.0 - 2021-03-22

[FIX] Add sanitizer to prevent XSS attacks
[FIX] Wrong Hebrew word הדועה to הודעה #556
[IMPROVE] add hover effect #566

## 1.8.0 - 2021-02-20

[IMPROVE] Flow of the widget registration form (#425)
[IMPROVE] System messages style (#554)
[FEATURE] New trigger messages style (#553)
[NEW] Display transfer history messages (#328)
[FIX] Registration form is no longer validating mandatory custom fields. (#550)

## 1.7.6 - 2020-11-07

[FIX] Livechat window cannot be restored in popout mode (#529)
[FIX] Visitor's messages are not aligned properly on Mozilla Firefox (#530)

## 1.7.5 - 2020-10-25

[FIX] Add zh.json missing translations (#478)
[FIX] Rendering emojis before transform markdown into HTML. (#522)
[FIX] UIKit ActionsBlock layout for smaller screen devices (#479)
[FIX] Emoji picker not rendering (#519)
[FIX] Scroll issues on Safari (#503)
[FIX] Support Webpack relative output path (#521)

## 1.7.4 - 2020-09-18

- [FIX] Select input field not working issue (#481)
- [FIX] Invisible div on top of page (#496)

## 1.7.3 - 2020-09-09

bump version

## 1.7.2 - 2020-09-09

- [FIX] IE11 Support (#492)

## 1.7.1 - 2020-08-28

- [FIX] UiKit interation using header as autorization (#483)
- [FIX] Transpile widget.js with Babel

## 1.7.0 - 2020-08-21

- [NEW] UiKit support (#474)
- [CHORE] Loki visual tests (#459)
- [IMPROVE] Translate to spanish (#413)
- [NEW] Message character limit feature (#443)
- [IMPROVE] Preact X (#457)
- [NEW] Add Emoji rendering support (#412)

## 1.6.0 - 2020-06-29

- [FIX] Improve the transcript request process. (#419)
- [FIX] Start chat disable with handler validate error (#432)
- [FIX] Loading should be flase when department switched is confirmed (#… …
- [FIX] Widget playing multiple sound notifications(Multiple tabs) (#435)
- [NEW] Translate to japanese
- [NEW] Translate i18n to Czech
- [NEW] Update fr.json
- [NEW] Translate to japanese

## 1.5.0 - 2020-05-20

- [NEW] Support Registration Form custom fields (#407) …
- [NEW] Translated to Hebrew (#348)
- [NEW] Update es.json (#357)
- [NEW] Russian translation (#359)
- [FIX] Dutch translations (#391)
- [IMPROVE] Update ro.json (397)
- [FIX] Dutch translations

## 1.4.0 - 2020-03-19

- [NEW] Add new API method the set the default Agent before chatting (#383)
- [NEW] Keep trigger messages after the conversation starts. (#384)
- [NEW] Widget API Methods (#381)
- [FIX] Livechat guest avatar using name instead of username (#380)

## 1.3.1 - 2020-02-12

- [FIX] Add Cross-tab communication on the same origin (#364)
- [FIX] Corrected German title for finished chat (#363)
- [FIX] Update polish translation (#324)

## 1.3.0 - 2019-12-12

- [NEW] Add Service Offline callback (#341)
- [NEW] Persian translation (#330)
- [NEW] French translation (#323)
- [NEW] Show/Hide Agent information (#279)
- [FIX] Fix date-fns (#340) (#320) (#315) (#314)

## 1.2.5 - 2019-10-16

- [FIX] date-nfs format usage (#315)

## 1.2.4 - 2019-10-16

- [FIX] date-nfs format usage (#314)

## 1.2.3 - 2019-10-15

- [FIX] date-fns usage (#312)

## 1.2.2 - 2019-10-15

- [FIX] API method calls

## 1.2.1 - 2019-10-14

- [CHORE] fix gh-publish (#306)
- [NEW] Add setting to display a custom chat finished text (#305)

## 1.2.0 - 2019-10-14

- [IMPROVE] Preact X (#302)
- Completed italian translation (#301)
- [FIX] Support Webpack relative output path (#292)
- [FIX] Registration Form changes not being detected (#300)

## 1.1.6 - 2019-08-17

- Publish correct package on npm

## 1.1.5 - 2019-08-17

- Publish correct package on npm

## 1.1.4 - 2019-08-13

- Update the SDK dependency to the latest alpha version(29) (#276)

## 1.1.3 - 2019-08-09

- [FIX] package.json files to /build (#273)
- [FIX] Make message markdown links open externally (#272)

## 1.1.2 - 2019-08-08

- [FIX] App.init until sdk.connect returns (#269);

## 1.1.1 - 2019-08-07

- [IMPROVE] German translations (#264)
- [FIX] remove version from publicPath (#266)

## 1.1.0 - 2019-07-24

- [CHORE] Code base maintenance
- [FIX] Sends the navigation history even when there is no room created
- [FIX] Auto reconnect when current connection closes
- [IMPROVE] German translation
- [NEW] Added two new API events
- [RFR] Improve French translation

## 1.0.0 - 2019-03-13

- Release Livechat client as a community feature

## 0.0.1-1 - 2019-03-12

- Initial release
