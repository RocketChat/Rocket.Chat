import { AppObjectRegistry } from '../../AppObjectRegistry.ts';
import { AppAccessorsInstance } from '../../lib/accessors/mod.ts';
export default async function handleOnInstall(params) {
  const app = AppObjectRegistry.get('app');
  if (typeof app?.onInstall !== 'function') {
    throw new Error('App must contain an onInstall function', {
      cause: 'invalid_app'
    });
  }
  if (!Array.isArray(params)) {
    throw new Error('Invalid params', {
      cause: 'invalid_param_type'
    });
  }
  const [context] = params;
  await app.onInstall(context, AppAccessorsInstance.getReader(), AppAccessorsInstance.getHttp(), AppAccessorsInstance.getPersistence(), AppAccessorsInstance.getModifier());
  return true;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZpbGU6Ly8vVXNlcnMvYWJoaW5hdi9yb2NrZXQuY2hhdC9Sb2NrZXQuQ2hhdC9wYWNrYWdlcy9hcHBzLWVuZ2luZS9kZW5vLXJ1bnRpbWUvaGFuZGxlcnMvYXBwL2hhbmRsZU9uSW5zdGFsbC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEFwcCB9IGZyb20gJ0Byb2NrZXQuY2hhdC9hcHBzLWVuZ2luZS9kZWZpbml0aW9uL0FwcC50cyc7XG5cbmltcG9ydCB7IEFwcE9iamVjdFJlZ2lzdHJ5IH0gZnJvbSAnLi4vLi4vQXBwT2JqZWN0UmVnaXN0cnkudHMnO1xuaW1wb3J0IHsgQXBwQWNjZXNzb3JzSW5zdGFuY2UgfSBmcm9tICcuLi8uLi9saWIvYWNjZXNzb3JzL21vZC50cyc7XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZU9uSW5zdGFsbChwYXJhbXM6IHVua25vd24pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCBhcHAgPSBBcHBPYmplY3RSZWdpc3RyeS5nZXQ8QXBwPignYXBwJyk7XG5cbiAgICBpZiAodHlwZW9mIGFwcD8ub25JbnN0YWxsICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQXBwIG11c3QgY29udGFpbiBhbiBvbkluc3RhbGwgZnVuY3Rpb24nLCB7XG4gICAgICAgICAgICBjYXVzZTogJ2ludmFsaWRfYXBwJyxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKCFBcnJheS5pc0FycmF5KHBhcmFtcykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHBhcmFtcycsIHsgY2F1c2U6ICdpbnZhbGlkX3BhcmFtX3R5cGUnIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IFtjb250ZXh0XSA9IHBhcmFtcyBhcyBbUmVjb3JkPHN0cmluZywgdW5rbm93bj5dO1xuXG4gICAgYXdhaXQgYXBwLm9uSW5zdGFsbChcbiAgICAgICAgY29udGV4dCxcbiAgICAgICAgQXBwQWNjZXNzb3JzSW5zdGFuY2UuZ2V0UmVhZGVyKCksXG4gICAgICAgIEFwcEFjY2Vzc29yc0luc3RhbmNlLmdldEh0dHAoKSxcbiAgICAgICAgQXBwQWNjZXNzb3JzSW5zdGFuY2UuZ2V0UGVyc2lzdGVuY2UoKSxcbiAgICAgICAgQXBwQWNjZXNzb3JzSW5zdGFuY2UuZ2V0TW9kaWZpZXIoKSxcbiAgICApO1xuXG4gICAgcmV0dXJuIHRydWU7XG59XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsU0FBUyxpQkFBaUIsUUFBUSw2QkFBNkI7QUFDL0QsU0FBUyxvQkFBb0IsUUFBUSw2QkFBNkI7QUFFbEUsZUFBZSxlQUFlLGdCQUFnQixNQUFlO0VBQ3pELE1BQU0sTUFBTSxrQkFBa0IsR0FBRyxDQUFNO0VBRXZDLElBQUksT0FBTyxLQUFLLGNBQWMsWUFBWTtJQUN0QyxNQUFNLElBQUksTUFBTSwwQ0FBMEM7TUFDdEQsT0FBTztJQUNYO0VBQ0o7RUFFQSxJQUFJLENBQUMsTUFBTSxPQUFPLENBQUMsU0FBUztJQUN4QixNQUFNLElBQUksTUFBTSxrQkFBa0I7TUFBRSxPQUFPO0lBQXFCO0VBQ3BFO0VBRUEsTUFBTSxDQUFDLFFBQVEsR0FBRztFQUVsQixNQUFNLElBQUksU0FBUyxDQUNmLFNBQ0EscUJBQXFCLFNBQVMsSUFDOUIscUJBQXFCLE9BQU8sSUFDNUIscUJBQXFCLGNBQWMsSUFDbkMscUJBQXFCLFdBQVc7RUFHcEMsT0FBTztBQUNYIn0=