import { writeAll } from 'https://deno.land/std@0.216.0/io/write_all.ts';
import { Queue } from './messenger.ts';
export function collectMetrics() {
  return {
    pid: Deno.pid,
    queueSize: Queue.getCurrentSize()
  };
}
const encoder = new TextEncoder();
/**
 * Sends metrics collected from the system via stderr
 */ export async function sendMetrics() {
  const metrics = collectMetrics();
  await writeAll(Deno.stderr, encoder.encode(JSON.stringify(metrics)));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZpbGU6Ly8vVXNlcnMvYWJoaW5hdi9yb2NrZXQuY2hhdC9Sb2NrZXQuQ2hhdC9wYWNrYWdlcy9hcHBzLWVuZ2luZS9kZW5vLXJ1bnRpbWUvbGliL21ldHJpY3NDb2xsZWN0b3IudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgd3JpdGVBbGwgfSBmcm9tICdodHRwczovL2Rlbm8ubGFuZC9zdGRAMC4yMTYuMC9pby93cml0ZV9hbGwudHMnO1xuaW1wb3J0IHsgUXVldWUgfSBmcm9tICcuL21lc3Nlbmdlci50cyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBjb2xsZWN0TWV0cmljcygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBwaWQ6IERlbm8ucGlkLFxuICAgICAgICBxdWV1ZVNpemU6IFF1ZXVlLmdldEN1cnJlbnRTaXplKCksXG4gICAgfVxufTtcblxuY29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuXG4vKipcbiAqIFNlbmRzIG1ldHJpY3MgY29sbGVjdGVkIGZyb20gdGhlIHN5c3RlbSB2aWEgc3RkZXJyXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZW5kTWV0cmljcygpIHtcbiAgICBjb25zdCBtZXRyaWNzID0gY29sbGVjdE1ldHJpY3MoKTtcblxuICAgIGF3YWl0IHdyaXRlQWxsKERlbm8uc3RkZXJyLCBlbmNvZGVyLmVuY29kZShKU09OLnN0cmluZ2lmeShtZXRyaWNzKSkpO1xufVxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFNBQVMsUUFBUSxRQUFRLGdEQUFnRDtBQUN6RSxTQUFTLEtBQUssUUFBUSxpQkFBaUI7QUFFdkMsT0FBTyxTQUFTO0VBQ1osT0FBTztJQUNILEtBQUssS0FBSyxHQUFHO0lBQ2IsV0FBVyxNQUFNLGNBQWM7RUFDbkM7QUFDSjtBQUVBLE1BQU0sVUFBVSxJQUFJO0FBRXBCOztDQUVDLEdBQ0QsT0FBTyxlQUFlO0VBQ2xCLE1BQU0sVUFBVTtFQUVoQixNQUFNLFNBQVMsS0FBSyxNQUFNLEVBQUUsUUFBUSxNQUFNLENBQUMsS0FBSyxTQUFTLENBQUM7QUFDOUQifQ==