{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/packages/blaze/lookup.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"packages/blaze/lookup.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/packages/blaze/lookup.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/packages/blaze/lookup.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/blaze/lookup.js"}},"code":"let has;\nmodule.link(\"lodash.has\", {\n  default(v) {\n    has = v;\n  }\n\n}, 0);\nBlaze._globalHelpers = {}; // Documented as Template.registerHelper.\n// This definition also provides back-compat for `UI.registerHelper`.\n\nBlaze.registerHelper = function (name, func) {\n  Blaze._globalHelpers[name] = func;\n}; // Also documented as Template.deregisterHelper\n\n\nBlaze.deregisterHelper = function (name) {\n  delete Blaze._globalHelpers[name];\n};\n\nvar bindIfIsFunction = function (x, target) {\n  if (typeof x !== 'function') return x;\n  return Blaze._bind(x, target);\n}; // If `x` is a function, binds the value of `this` for that function\n// to the current data context.\n\n\nvar bindDataContext = function (x) {\n  if (typeof x === 'function') {\n    return function () {\n      var data = Blaze.getData();\n      if (data == null) data = {};\n      return x.apply(data, arguments);\n    };\n  }\n\n  return x;\n};\n\nBlaze._OLDSTYLE_HELPER = {};\n\nBlaze._getTemplateHelper = function (template, name, tmplInstanceFunc) {\n  // XXX COMPAT WITH 0.9.3\n  var isKnownOldStyleHelper = false;\n\n  if (template.__helpers.has(name)) {\n    var helper = template.__helpers.get(name);\n\n    if (helper === Blaze._OLDSTYLE_HELPER) {\n      isKnownOldStyleHelper = true;\n    } else if (helper != null) {\n      return wrapHelper(bindDataContext(helper), tmplInstanceFunc);\n    } else {\n      return null;\n    }\n  } // old-style helper\n\n\n  if (name in template) {\n    // Only warn once per helper\n    if (!isKnownOldStyleHelper) {\n      template.__helpers.set(name, Blaze._OLDSTYLE_HELPER);\n\n      if (!template._NOWARN_OLDSTYLE_HELPERS) {\n        Blaze._warn('Assigning helper with `' + template.viewName + '.' + name + ' = ...` is deprecated.  Use `' + template.viewName + '.helpers(...)` instead.');\n      }\n    }\n\n    if (template[name] != null) {\n      return wrapHelper(bindDataContext(template[name]), tmplInstanceFunc);\n    }\n  }\n\n  return null;\n};\n\nvar wrapHelper = function (f, templateFunc) {\n  if (typeof f !== \"function\") {\n    return f;\n  }\n\n  return function () {\n    var self = this;\n    var args = arguments;\n    return Blaze.Template._withTemplateInstanceFunc(templateFunc, function () {\n      return Blaze._wrapCatchingExceptions(f, 'template helper').apply(self, args);\n    });\n  };\n};\n\nBlaze._lexicalBindingLookup = function (view, name) {\n  var currentView = view;\n  var blockHelpersStack = []; // walk up the views stopping at a Spacebars.include or Template view that\n  // doesn't have an InOuterTemplateScope view as a parent\n\n  do {\n    // skip block helpers views\n    // if we found the binding on the scope, return it\n    if (has(currentView._scopeBindings, name)) {\n      var bindingReactiveVar = currentView._scopeBindings[name];\n      return function () {\n        return bindingReactiveVar.get();\n      };\n    }\n  } while (!(currentView.__startsNewLexicalScope && !(currentView.parentView && currentView.parentView.__childDoesntStartNewLexicalScope)) && (currentView = currentView.parentView));\n\n  return null;\n}; // templateInstance argument is provided to be available for possible\n// alternative implementations of this function by 3rd party packages.\n\n\nBlaze._getTemplate = function (name, templateInstance) {\n  if (name in Blaze.Template && Blaze.Template[name] instanceof Blaze.Template) {\n    return Blaze.Template[name];\n  }\n\n  return null;\n};\n\nBlaze._getGlobalHelper = function (name, templateInstance) {\n  if (Blaze._globalHelpers[name] != null) {\n    return wrapHelper(bindDataContext(Blaze._globalHelpers[name]), templateInstance);\n  }\n\n  return null;\n}; // Looks up a name, like \"foo\" or \"..\", as a helper of the\n// current template; the name of a template; a global helper;\n// or a property of the data context.  Called on the View of\n// a template (i.e. a View with a `.template` property,\n// where the helpers are).  Used for the first name in a\n// \"path\" in a template tag, like \"foo\" in `{{foo.bar}}` or\n// \"..\" in `{{frobulate ../blah}}`.\n//\n// Returns a function, a non-function value, or null.  If\n// a function is found, it is bound appropriately.\n//\n// NOTE: This function must not establish any reactive\n// dependencies itself.  If there is any reactivity in the\n// value, lookup should return a function.\n\n\nBlaze.View.prototype.lookup = function (name, _options) {\n  var template = this.template;\n  var lookupTemplate = _options && _options.template;\n  var helper;\n  var binding;\n  var boundTmplInstance;\n  var foundTemplate;\n\n  if (this.templateInstance) {\n    boundTmplInstance = Blaze._bind(this.templateInstance, this);\n  } // 0. looking up the parent data context with the special \"../\" syntax\n\n\n  if (/^\\./.test(name)) {\n    // starts with a dot. must be a series of dots which maps to an\n    // ancestor of the appropriate height.\n    if (!/^(\\.)+$/.test(name)) throw new Error(\"id starting with dot must be a series of dots\");\n    return Blaze._parentData(name.length - 1, true\n    /*_functionWrapped*/\n    );\n  } // 1. look up a helper on the current template\n\n\n  if (template && (helper = Blaze._getTemplateHelper(template, name, boundTmplInstance)) != null) {\n    return helper;\n  } // 2. look up a binding by traversing the lexical view hierarchy inside the\n  // current template\n\n\n  if (template && (binding = Blaze._lexicalBindingLookup(Blaze.currentView, name)) != null) {\n    return binding;\n  } // 3. look up a template by name\n\n\n  if (lookupTemplate && (foundTemplate = Blaze._getTemplate(name, boundTmplInstance)) != null) {\n    return foundTemplate;\n  } // 4. look up a global helper\n\n\n  if ((helper = Blaze._getGlobalHelper(name, boundTmplInstance)) != null) {\n    return helper;\n  } // 5. look up in a data context\n\n\n  return function () {\n    var isCalledAsFunction = arguments.length > 0;\n    var data = Blaze.getData();\n    var x = data && data[name];\n\n    if (!x) {\n      if (lookupTemplate) {\n        throw new Error(\"No such template: \" + name);\n      } else if (isCalledAsFunction) {\n        throw new Error(\"No such function: \" + name);\n      } else if (name.charAt(0) === '@' && (x === null || x === undefined)) {\n        // Throw an error if the user tries to use a `@directive`\n        // that doesn't exist.  We don't implement all directives\n        // from Handlebars, so there's a potential for confusion\n        // if we fail silently.  On the other hand, we want to\n        // throw late in case some app or package wants to provide\n        // a missing directive.\n        throw new Error(\"Unsupported directive: \" + name);\n      }\n    }\n\n    if (!data) {\n      return null;\n    }\n\n    if (typeof x !== 'function') {\n      if (isCalledAsFunction) {\n        throw new Error(\"Can't call non-function: \" + x);\n      }\n\n      return x;\n    }\n\n    return x.apply(data, arguments);\n  };\n}; // Implement Spacebars' {{../..}}.\n// @param height {Number} The number of '..'s\n\n\nBlaze._parentData = function (height, _functionWrapped) {\n  // If height is null or undefined, we default to 1, the first parent.\n  if (height == null) {\n    height = 1;\n  }\n\n  var theWith = Blaze.getView('with');\n\n  for (var i = 0; i < height && theWith; i++) {\n    theWith = Blaze.getView(theWith, 'with');\n  }\n\n  if (!theWith) return null;\n  if (_functionWrapped) return function () {\n    return theWith.dataVar.get();\n  };\n  return theWith.dataVar.get();\n};\n\nBlaze.View.prototype.lookupTemplate = function (name) {\n  return this.lookup(name, {\n    template: true\n  });\n};","map":{"version":3,"sources":["packages/blaze/lookup.js"],"names":["has","module","link","default","v","Blaze","_globalHelpers","registerHelper","name","func","deregisterHelper","bindIfIsFunction","x","target","_bind","bindDataContext","data","getData","apply","arguments","_OLDSTYLE_HELPER","_getTemplateHelper","template","tmplInstanceFunc","isKnownOldStyleHelper","__helpers","helper","get","wrapHelper","set","_NOWARN_OLDSTYLE_HELPERS","_warn","viewName","f","templateFunc","self","args","Template","_withTemplateInstanceFunc","_wrapCatchingExceptions","_lexicalBindingLookup","view","currentView","blockHelpersStack","_scopeBindings","bindingReactiveVar","__startsNewLexicalScope","parentView","__childDoesntStartNewLexicalScope","_getTemplate","templateInstance","_getGlobalHelper","View","prototype","lookup","_options","lookupTemplate","binding","boundTmplInstance","foundTemplate","test","Error","_parentData","length","isCalledAsFunction","charAt","undefined","height","_functionWrapped","theWith","getView","i","dataVar"],"mappings":"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","sourcesContent":["import has from 'lodash.has';\n\nBlaze._globalHelpers = {};\n\n// Documented as Template.registerHelper.\n// This definition also provides back-compat for `UI.registerHelper`.\nBlaze.registerHelper = function (name, func) {\n  Blaze._globalHelpers[name] = func;\n};\n\n// Also documented as Template.deregisterHelper\nBlaze.deregisterHelper = function(name) {\n  delete Blaze._globalHelpers[name];\n};\n\nvar bindIfIsFunction = function (x, target) {\n  if (typeof x !== 'function')\n    return x;\n  return Blaze._bind(x, target);\n};\n\n// If `x` is a function, binds the value of `this` for that function\n// to the current data context.\nvar bindDataContext = function (x) {\n  if (typeof x === 'function') {\n    return function () {\n      var data = Blaze.getData();\n      if (data == null)\n        data = {};\n      return x.apply(data, arguments);\n    };\n  }\n  return x;\n};\n\nBlaze._OLDSTYLE_HELPER = {};\n\nBlaze._getTemplateHelper = function (template, name, tmplInstanceFunc) {\n  // XXX COMPAT WITH 0.9.3\n  var isKnownOldStyleHelper = false;\n\n  if (template.__helpers.has(name)) {\n    var helper = template.__helpers.get(name);\n    if (helper === Blaze._OLDSTYLE_HELPER) {\n      isKnownOldStyleHelper = true;\n    } else if (helper != null) {\n      return wrapHelper(bindDataContext(helper), tmplInstanceFunc);\n    } else {\n      return null;\n    }\n  }\n\n  // old-style helper\n  if (name in template) {\n    // Only warn once per helper\n    if (! isKnownOldStyleHelper) {\n      template.__helpers.set(name, Blaze._OLDSTYLE_HELPER);\n      if (! template._NOWARN_OLDSTYLE_HELPERS) {\n        Blaze._warn('Assigning helper with `' + template.viewName + '.' +\n                    name + ' = ...` is deprecated.  Use `' + template.viewName +\n                    '.helpers(...)` instead.');\n      }\n    }\n    if (template[name] != null) {\n      return wrapHelper(bindDataContext(template[name]), tmplInstanceFunc);\n    }\n  }\n\n  return null;\n};\n\nvar wrapHelper = function (f, templateFunc) {\n  if (typeof f !== \"function\") {\n    return f;\n  }\n\n  return function () {\n    var self = this;\n    var args = arguments;\n\n    return Blaze.Template._withTemplateInstanceFunc(templateFunc, function () {\n      return Blaze._wrapCatchingExceptions(f, 'template helper').apply(self, args);\n    });\n  };\n};\n\nBlaze._lexicalBindingLookup = function (view, name) {\n  var currentView = view;\n  var blockHelpersStack = [];\n\n  // walk up the views stopping at a Spacebars.include or Template view that\n  // doesn't have an InOuterTemplateScope view as a parent\n  do {\n    // skip block helpers views\n    // if we found the binding on the scope, return it\n    if (has(currentView._scopeBindings, name)) {\n      var bindingReactiveVar = currentView._scopeBindings[name];\n      return function () {\n        return bindingReactiveVar.get();\n      };\n    }\n  } while (! (currentView.__startsNewLexicalScope &&\n              ! (currentView.parentView &&\n                 currentView.parentView.__childDoesntStartNewLexicalScope))\n           && (currentView = currentView.parentView));\n\n  return null;\n};\n\n// templateInstance argument is provided to be available for possible\n// alternative implementations of this function by 3rd party packages.\nBlaze._getTemplate = function (name, templateInstance) {\n  if ((name in Blaze.Template) && (Blaze.Template[name] instanceof Blaze.Template)) {\n    return Blaze.Template[name];\n  }\n  return null;\n};\n\nBlaze._getGlobalHelper = function (name, templateInstance) {\n  if (Blaze._globalHelpers[name] != null) {\n    return wrapHelper(bindDataContext(Blaze._globalHelpers[name]), templateInstance);\n  }\n  return null;\n};\n\n// Looks up a name, like \"foo\" or \"..\", as a helper of the\n// current template; the name of a template; a global helper;\n// or a property of the data context.  Called on the View of\n// a template (i.e. a View with a `.template` property,\n// where the helpers are).  Used for the first name in a\n// \"path\" in a template tag, like \"foo\" in `{{foo.bar}}` or\n// \"..\" in `{{frobulate ../blah}}`.\n//\n// Returns a function, a non-function value, or null.  If\n// a function is found, it is bound appropriately.\n//\n// NOTE: This function must not establish any reactive\n// dependencies itself.  If there is any reactivity in the\n// value, lookup should return a function.\nBlaze.View.prototype.lookup = function (name, _options) {\n  var template = this.template;\n  var lookupTemplate = _options && _options.template;\n  var helper;\n  var binding;\n  var boundTmplInstance;\n  var foundTemplate;\n\n  if (this.templateInstance) {\n    boundTmplInstance = Blaze._bind(this.templateInstance, this);\n  }\n\n  // 0. looking up the parent data context with the special \"../\" syntax\n  if (/^\\./.test(name)) {\n    // starts with a dot. must be a series of dots which maps to an\n    // ancestor of the appropriate height.\n    if (!/^(\\.)+$/.test(name))\n      throw new Error(\"id starting with dot must be a series of dots\");\n\n    return Blaze._parentData(name.length - 1, true /*_functionWrapped*/);\n\n  }\n\n  // 1. look up a helper on the current template\n  if (template && ((helper = Blaze._getTemplateHelper(template, name, boundTmplInstance)) != null)) {\n    return helper;\n  }\n\n  // 2. look up a binding by traversing the lexical view hierarchy inside the\n  // current template\n  if (template && (binding = Blaze._lexicalBindingLookup(Blaze.currentView, name)) != null) {\n    return binding;\n  }\n\n  // 3. look up a template by name\n  if (lookupTemplate && ((foundTemplate = Blaze._getTemplate(name, boundTmplInstance)) != null)) {\n    return foundTemplate;\n  }\n\n  // 4. look up a global helper\n  if ((helper = Blaze._getGlobalHelper(name, boundTmplInstance)) != null) {\n    return helper;\n  }\n\n  // 5. look up in a data context\n  return function () {\n    var isCalledAsFunction = (arguments.length > 0);\n    var data = Blaze.getData();\n    var x = data && data[name];\n    if (! x) {\n      if (lookupTemplate) {\n        throw new Error(\"No such template: \" + name);\n      } else if (isCalledAsFunction) {\n        throw new Error(\"No such function: \" + name);\n      } else if (name.charAt(0) === '@' && ((x === null) ||\n                                            (x === undefined))) {\n        // Throw an error if the user tries to use a `@directive`\n        // that doesn't exist.  We don't implement all directives\n        // from Handlebars, so there's a potential for confusion\n        // if we fail silently.  On the other hand, we want to\n        // throw late in case some app or package wants to provide\n        // a missing directive.\n        throw new Error(\"Unsupported directive: \" + name);\n      }\n    }\n    if (! data) {\n      return null;\n    }\n    if (typeof x !== 'function') {\n      if (isCalledAsFunction) {\n        throw new Error(\"Can't call non-function: \" + x);\n      }\n      return x;\n    }\n    return x.apply(data, arguments);\n  };\n};\n\n// Implement Spacebars' {{../..}}.\n// @param height {Number} The number of '..'s\nBlaze._parentData = function (height, _functionWrapped) {\n  // If height is null or undefined, we default to 1, the first parent.\n  if (height == null) {\n    height = 1;\n  }\n  var theWith = Blaze.getView('with');\n  for (var i = 0; (i < height) && theWith; i++) {\n    theWith = Blaze.getView(theWith, 'with');\n  }\n\n  if (! theWith)\n    return null;\n  if (_functionWrapped)\n    return function () { return theWith.dataVar.get(); };\n  return theWith.dataVar.get();\n};\n\n\nBlaze.View.prototype.lookupTemplate = function (name) {\n  return this.lookup(name, {template:true});\n};\n"]},"sourceType":"module","hash":"35125250a495aa693c69848666701ca37aa94c6d"}
