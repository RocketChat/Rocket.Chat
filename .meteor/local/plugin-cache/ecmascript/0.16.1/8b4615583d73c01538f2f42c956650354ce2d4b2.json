{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/home/weslley/Documents/projects/Rocket.Chat/app/apps/server/communication/websockets.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.linux.x86_64"},"sourceFileName":"app/apps/server/communication/websockets.js","filename":"/home/weslley/Documents/projects/Rocket.Chat/app/apps/server/communication/websockets.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/home/weslley/Documents/projects/Rocket.Chat","root":"/home/weslley/Documents/projects/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/home/weslley/Documents/projects/Rocket.Chat/app/apps/server/communication/websockets.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"app/apps/server/communication/websockets.js"}},"code":"module.export({\n  AppEvents: () => AppEvents,\n  AppServerListener: () => AppServerListener,\n  AppServerNotifier: () => AppServerNotifier\n});\nlet AppStatusUtils;\nmodule.link(\"@rocket.chat/apps-engine/definition/AppStatus\", {\n  AppStatusUtils(v) {\n    AppStatusUtils = v;\n  }\n\n}, 0);\nlet SystemLogger;\nmodule.link(\"../../../../server/lib/logger/system\", {\n  SystemLogger(v) {\n    SystemLogger = v;\n  }\n\n}, 1);\nlet notifications;\nmodule.link(\"../../../notifications/server/lib/Notifications\", {\n  default(v) {\n    notifications = v;\n  }\n\n}, 2);\nconst AppEvents = Object.freeze({\n  APP_ADDED: 'app/added',\n  APP_REMOVED: 'app/removed',\n  APP_UPDATED: 'app/updated',\n  APP_STATUS_CHANGE: 'app/statusUpdate',\n  APP_SETTING_UPDATED: 'app/settingUpdated',\n  COMMAND_ADDED: 'command/added',\n  COMMAND_DISABLED: 'command/disabled',\n  COMMAND_UPDATED: 'command/updated',\n  COMMAND_REMOVED: 'command/removed',\n  ACTIONS_CHANGED: 'actions/changed'\n});\n\nclass AppServerListener {\n  constructor(orch, engineStreamer, clientStreamer, received) {\n    this.orch = orch;\n    this.engineStreamer = engineStreamer;\n    this.clientStreamer = clientStreamer;\n    this.received = received;\n    this.engineStreamer.on(AppEvents.APP_STATUS_CHANGE, this.onAppStatusUpdated.bind(this));\n    this.engineStreamer.on(AppEvents.APP_REMOVED, this.onAppRemoved.bind(this));\n    this.engineStreamer.on(AppEvents.APP_UPDATED, this.onAppUpdated.bind(this));\n    this.engineStreamer.on(AppEvents.APP_ADDED, this.onAppAdded.bind(this));\n    this.engineStreamer.on(AppEvents.ACTIONS_CHANGED, this.onActionsChanged.bind(this));\n    this.engineStreamer.on(AppEvents.APP_SETTING_UPDATED, this.onAppSettingUpdated.bind(this));\n    this.engineStreamer.on(AppEvents.COMMAND_ADDED, this.onCommandAdded.bind(this));\n    this.engineStreamer.on(AppEvents.COMMAND_DISABLED, this.onCommandDisabled.bind(this));\n    this.engineStreamer.on(AppEvents.COMMAND_UPDATED, this.onCommandUpdated.bind(this));\n    this.engineStreamer.on(AppEvents.COMMAND_REMOVED, this.onCommandRemoved.bind(this));\n  }\n\n  onAppAdded(appId) {\n    return Promise.asyncApply(() => {\n      Promise.await(this.orch.getManager().loadOne(appId));\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.APP_ADDED, appId);\n    });\n  }\n\n  onAppStatusUpdated(_ref) {\n    return Promise.asyncApply(() => {\n      let {\n        appId,\n        status\n      } = _ref;\n      const app = this.orch.getManager().getOneById(appId);\n\n      if (!app || app.getStatus() === status) {\n        return;\n      }\n\n      this.received.set(\"\".concat(AppEvents.APP_STATUS_CHANGE, \"_\").concat(appId), {\n        appId,\n        status,\n        when: new Date()\n      });\n\n      if (AppStatusUtils.isEnabled(status)) {\n        Promise.await(this.orch.getManager().enable(appId).catch(SystemLogger.error));\n        this.clientStreamer.emitWithoutBroadcast(AppEvents.APP_STATUS_CHANGE, {\n          appId,\n          status\n        });\n      } else if (AppStatusUtils.isDisabled(status)) {\n        Promise.await(this.orch.getManager().disable(appId, status, true).catch(SystemLogger.error));\n        this.clientStreamer.emitWithoutBroadcast(AppEvents.APP_STATUS_CHANGE, {\n          appId,\n          status\n        });\n      }\n    });\n  }\n\n  onAppSettingUpdated(_ref2) {\n    return Promise.asyncApply(() => {\n      let {\n        appId,\n        setting\n      } = _ref2;\n      this.received.set(\"\".concat(AppEvents.APP_SETTING_UPDATED, \"_\").concat(appId, \"_\").concat(setting.id), {\n        appId,\n        setting,\n        when: new Date()\n      });\n      Promise.await(this.orch.getManager().getSettingsManager().updateAppSetting(appId, setting));\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.APP_SETTING_UPDATED, {\n        appId\n      });\n    });\n  }\n\n  onAppUpdated(appId) {\n    return Promise.asyncApply(() => {\n      this.received.set(\"\".concat(AppEvents.APP_UPDATED, \"_\").concat(appId), {\n        appId,\n        when: new Date()\n      });\n      const storageItem = Promise.await(this.orch.getStorage().retrieveOne(appId));\n      const appPackage = Promise.await(this.orch.getAppSourceStorage().fetch(storageItem));\n      Promise.await(this.orch.getManager().updateLocal(storageItem, appPackage));\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.APP_UPDATED, appId);\n    });\n  }\n\n  onAppRemoved(appId) {\n    return Promise.asyncApply(() => {\n      const app = this.orch.getManager().getOneById(appId);\n\n      if (!app) {\n        return;\n      }\n\n      Promise.await(this.orch.getManager().removeLocal(appId));\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.APP_REMOVED, appId);\n    });\n  }\n\n  onCommandAdded(command) {\n    return Promise.asyncApply(() => {\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.COMMAND_ADDED, command);\n    });\n  }\n\n  onCommandDisabled(command) {\n    return Promise.asyncApply(() => {\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.COMMAND_DISABLED, command);\n    });\n  }\n\n  onCommandUpdated(command) {\n    return Promise.asyncApply(() => {\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.COMMAND_UPDATED, command);\n    });\n  }\n\n  onCommandRemoved(command) {\n    return Promise.asyncApply(() => {\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.COMMAND_REMOVED, command);\n    });\n  }\n\n  onActionsChanged() {\n    return Promise.asyncApply(() => {\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.ACTIONS_CHANGED);\n    });\n  }\n\n}\n\nclass AppServerNotifier {\n  constructor(orch) {\n    this.engineStreamer = notifications.streamAppsEngine; // This is used to broadcast to the web clients\n\n    this.clientStreamer = notifications.streamApps;\n    this.received = new Map();\n    this.listener = new AppServerListener(orch, this.engineStreamer, this.clientStreamer, this.received);\n  }\n\n  appAdded(appId) {\n    return Promise.asyncApply(() => {\n      this.engineStreamer.emit(AppEvents.APP_ADDED, appId);\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.APP_ADDED, appId);\n    });\n  }\n\n  appRemoved(appId) {\n    return Promise.asyncApply(() => {\n      this.engineStreamer.emit(AppEvents.APP_REMOVED, appId);\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.APP_REMOVED, appId);\n    });\n  }\n\n  appUpdated(appId) {\n    return Promise.asyncApply(() => {\n      if (this.received.has(\"\".concat(AppEvents.APP_UPDATED, \"_\").concat(appId))) {\n        this.received.delete(\"\".concat(AppEvents.APP_UPDATED, \"_\").concat(appId));\n        return;\n      }\n\n      this.engineStreamer.emit(AppEvents.APP_UPDATED, appId);\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.APP_UPDATED, appId);\n    });\n  }\n\n  appStatusUpdated(appId, status) {\n    return Promise.asyncApply(() => {\n      if (this.received.has(\"\".concat(AppEvents.APP_STATUS_CHANGE, \"_\").concat(appId))) {\n        const details = this.received.get(\"\".concat(AppEvents.APP_STATUS_CHANGE, \"_\").concat(appId));\n\n        if (details.status === status) {\n          this.received.delete(\"\".concat(AppEvents.APP_STATUS_CHANGE, \"_\").concat(appId));\n          return;\n        }\n      }\n\n      this.engineStreamer.emit(AppEvents.APP_STATUS_CHANGE, {\n        appId,\n        status\n      });\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.APP_STATUS_CHANGE, {\n        appId,\n        status\n      });\n    });\n  }\n\n  appSettingsChange(appId, setting) {\n    return Promise.asyncApply(() => {\n      if (this.received.has(\"\".concat(AppEvents.APP_SETTING_UPDATED, \"_\").concat(appId, \"_\").concat(setting.id))) {\n        this.received.delete(\"\".concat(AppEvents.APP_SETTING_UPDATED, \"_\").concat(appId, \"_\").concat(setting.id));\n        return;\n      }\n\n      this.engineStreamer.emit(AppEvents.APP_SETTING_UPDATED, {\n        appId,\n        setting\n      });\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.APP_SETTING_UPDATED, {\n        appId\n      });\n    });\n  }\n\n  commandAdded(command) {\n    return Promise.asyncApply(() => {\n      this.engineStreamer.emit(AppEvents.COMMAND_ADDED, command);\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.COMMAND_ADDED, command);\n    });\n  }\n\n  commandDisabled(command) {\n    return Promise.asyncApply(() => {\n      this.engineStreamer.emit(AppEvents.COMMAND_DISABLED, command);\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.COMMAND_DISABLED, command);\n    });\n  }\n\n  commandUpdated(command) {\n    return Promise.asyncApply(() => {\n      this.engineStreamer.emit(AppEvents.COMMAND_UPDATED, command);\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.COMMAND_UPDATED, command);\n    });\n  }\n\n  commandRemoved(command) {\n    return Promise.asyncApply(() => {\n      this.engineStreamer.emit(AppEvents.COMMAND_REMOVED, command);\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.COMMAND_REMOVED, command);\n    });\n  }\n\n  actionsChanged() {\n    return Promise.asyncApply(() => {\n      this.clientStreamer.emitWithoutBroadcast(AppEvents.ACTIONS_CHANGED);\n    });\n  }\n\n}","map":{"version":3,"sources":["app/apps/server/communication/websockets.js"],"names":["module","export","AppEvents","AppServerListener","AppServerNotifier","AppStatusUtils","link","v","SystemLogger","notifications","default","Object","freeze","APP_ADDED","APP_REMOVED","APP_UPDATED","APP_STATUS_CHANGE","APP_SETTING_UPDATED","COMMAND_ADDED","COMMAND_DISABLED","COMMAND_UPDATED","COMMAND_REMOVED","ACTIONS_CHANGED","constructor","orch","engineStreamer","clientStreamer","received","on","onAppStatusUpdated","bind","onAppRemoved","onAppUpdated","onAppAdded","onActionsChanged","onAppSettingUpdated","onCommandAdded","onCommandDisabled","onCommandUpdated","onCommandRemoved","appId","getManager","loadOne","emitWithoutBroadcast","status","app","getOneById","getStatus","set","when","Date","isEnabled","enable","catch","error","isDisabled","disable","setting","id","getSettingsManager","updateAppSetting","storageItem","getStorage","retrieveOne","appPackage","getAppSourceStorage","fetch","updateLocal","removeLocal","command","streamAppsEngine","streamApps","Map","listener","appAdded","emit","appRemoved","appUpdated","has","delete","appStatusUpdated","details","get","appSettingsChange","commandAdded","commandDisabled","commandUpdated","commandRemoved","actionsChanged"],"mappings":"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","sourcesContent":["import { AppStatusUtils } from '@rocket.chat/apps-engine/definition/AppStatus';\n\nimport { SystemLogger } from '../../../../server/lib/logger/system';\nimport notifications from '../../../notifications/server/lib/Notifications';\n\nexport const AppEvents = Object.freeze({\n\tAPP_ADDED: 'app/added',\n\tAPP_REMOVED: 'app/removed',\n\tAPP_UPDATED: 'app/updated',\n\tAPP_STATUS_CHANGE: 'app/statusUpdate',\n\tAPP_SETTING_UPDATED: 'app/settingUpdated',\n\tCOMMAND_ADDED: 'command/added',\n\tCOMMAND_DISABLED: 'command/disabled',\n\tCOMMAND_UPDATED: 'command/updated',\n\tCOMMAND_REMOVED: 'command/removed',\n\tACTIONS_CHANGED: 'actions/changed',\n});\n\nexport class AppServerListener {\n\tconstructor(orch, engineStreamer, clientStreamer, received) {\n\t\tthis.orch = orch;\n\t\tthis.engineStreamer = engineStreamer;\n\t\tthis.clientStreamer = clientStreamer;\n\t\tthis.received = received;\n\n\t\tthis.engineStreamer.on(AppEvents.APP_STATUS_CHANGE, this.onAppStatusUpdated.bind(this));\n\t\tthis.engineStreamer.on(AppEvents.APP_REMOVED, this.onAppRemoved.bind(this));\n\t\tthis.engineStreamer.on(AppEvents.APP_UPDATED, this.onAppUpdated.bind(this));\n\t\tthis.engineStreamer.on(AppEvents.APP_ADDED, this.onAppAdded.bind(this));\n\t\tthis.engineStreamer.on(AppEvents.ACTIONS_CHANGED, this.onActionsChanged.bind(this));\n\n\t\tthis.engineStreamer.on(AppEvents.APP_SETTING_UPDATED, this.onAppSettingUpdated.bind(this));\n\t\tthis.engineStreamer.on(AppEvents.COMMAND_ADDED, this.onCommandAdded.bind(this));\n\t\tthis.engineStreamer.on(AppEvents.COMMAND_DISABLED, this.onCommandDisabled.bind(this));\n\t\tthis.engineStreamer.on(AppEvents.COMMAND_UPDATED, this.onCommandUpdated.bind(this));\n\t\tthis.engineStreamer.on(AppEvents.COMMAND_REMOVED, this.onCommandRemoved.bind(this));\n\t}\n\n\tasync onAppAdded(appId) {\n\t\tawait this.orch.getManager().loadOne(appId);\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.APP_ADDED, appId);\n\t}\n\n\tasync onAppStatusUpdated({ appId, status }) {\n\t\tconst app = this.orch.getManager().getOneById(appId);\n\n\t\tif (!app || app.getStatus() === status) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.received.set(`${AppEvents.APP_STATUS_CHANGE}_${appId}`, {\n\t\t\tappId,\n\t\t\tstatus,\n\t\t\twhen: new Date(),\n\t\t});\n\n\t\tif (AppStatusUtils.isEnabled(status)) {\n\t\t\tawait this.orch.getManager().enable(appId).catch(SystemLogger.error);\n\t\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.APP_STATUS_CHANGE, { appId, status });\n\t\t} else if (AppStatusUtils.isDisabled(status)) {\n\t\t\tawait this.orch.getManager().disable(appId, status, true).catch(SystemLogger.error);\n\t\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.APP_STATUS_CHANGE, { appId, status });\n\t\t}\n\t}\n\n\tasync onAppSettingUpdated({ appId, setting }) {\n\t\tthis.received.set(`${AppEvents.APP_SETTING_UPDATED}_${appId}_${setting.id}`, {\n\t\t\tappId,\n\t\t\tsetting,\n\t\t\twhen: new Date(),\n\t\t});\n\t\tawait this.orch.getManager().getSettingsManager().updateAppSetting(appId, setting);\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.APP_SETTING_UPDATED, { appId });\n\t}\n\n\tasync onAppUpdated(appId) {\n\t\tthis.received.set(`${AppEvents.APP_UPDATED}_${appId}`, { appId, when: new Date() });\n\n\t\tconst storageItem = await this.orch.getStorage().retrieveOne(appId);\n\n\t\tconst appPackage = await this.orch.getAppSourceStorage().fetch(storageItem);\n\n\t\tawait this.orch.getManager().updateLocal(storageItem, appPackage);\n\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.APP_UPDATED, appId);\n\t}\n\n\tasync onAppRemoved(appId) {\n\t\tconst app = this.orch.getManager().getOneById(appId);\n\n\t\tif (!app) {\n\t\t\treturn;\n\t\t}\n\n\t\tawait this.orch.getManager().removeLocal(appId);\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.APP_REMOVED, appId);\n\t}\n\n\tasync onCommandAdded(command) {\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.COMMAND_ADDED, command);\n\t}\n\n\tasync onCommandDisabled(command) {\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.COMMAND_DISABLED, command);\n\t}\n\n\tasync onCommandUpdated(command) {\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.COMMAND_UPDATED, command);\n\t}\n\n\tasync onCommandRemoved(command) {\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.COMMAND_REMOVED, command);\n\t}\n\n\tasync onActionsChanged() {\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.ACTIONS_CHANGED);\n\t}\n}\n\nexport class AppServerNotifier {\n\tconstructor(orch) {\n\t\tthis.engineStreamer = notifications.streamAppsEngine;\n\n\t\t// This is used to broadcast to the web clients\n\t\tthis.clientStreamer = notifications.streamApps;\n\n\t\tthis.received = new Map();\n\t\tthis.listener = new AppServerListener(orch, this.engineStreamer, this.clientStreamer, this.received);\n\t}\n\n\tasync appAdded(appId) {\n\t\tthis.engineStreamer.emit(AppEvents.APP_ADDED, appId);\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.APP_ADDED, appId);\n\t}\n\n\tasync appRemoved(appId) {\n\t\tthis.engineStreamer.emit(AppEvents.APP_REMOVED, appId);\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.APP_REMOVED, appId);\n\t}\n\n\tasync appUpdated(appId) {\n\t\tif (this.received.has(`${AppEvents.APP_UPDATED}_${appId}`)) {\n\t\t\tthis.received.delete(`${AppEvents.APP_UPDATED}_${appId}`);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.engineStreamer.emit(AppEvents.APP_UPDATED, appId);\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.APP_UPDATED, appId);\n\t}\n\n\tasync appStatusUpdated(appId, status) {\n\t\tif (this.received.has(`${AppEvents.APP_STATUS_CHANGE}_${appId}`)) {\n\t\t\tconst details = this.received.get(`${AppEvents.APP_STATUS_CHANGE}_${appId}`);\n\t\t\tif (details.status === status) {\n\t\t\t\tthis.received.delete(`${AppEvents.APP_STATUS_CHANGE}_${appId}`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.engineStreamer.emit(AppEvents.APP_STATUS_CHANGE, { appId, status });\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.APP_STATUS_CHANGE, { appId, status });\n\t}\n\n\tasync appSettingsChange(appId, setting) {\n\t\tif (this.received.has(`${AppEvents.APP_SETTING_UPDATED}_${appId}_${setting.id}`)) {\n\t\t\tthis.received.delete(`${AppEvents.APP_SETTING_UPDATED}_${appId}_${setting.id}`);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.engineStreamer.emit(AppEvents.APP_SETTING_UPDATED, { appId, setting });\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.APP_SETTING_UPDATED, { appId });\n\t}\n\n\tasync commandAdded(command) {\n\t\tthis.engineStreamer.emit(AppEvents.COMMAND_ADDED, command);\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.COMMAND_ADDED, command);\n\t}\n\n\tasync commandDisabled(command) {\n\t\tthis.engineStreamer.emit(AppEvents.COMMAND_DISABLED, command);\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.COMMAND_DISABLED, command);\n\t}\n\n\tasync commandUpdated(command) {\n\t\tthis.engineStreamer.emit(AppEvents.COMMAND_UPDATED, command);\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.COMMAND_UPDATED, command);\n\t}\n\n\tasync commandRemoved(command) {\n\t\tthis.engineStreamer.emit(AppEvents.COMMAND_REMOVED, command);\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.COMMAND_REMOVED, command);\n\t}\n\n\tasync actionsChanged() {\n\t\tthis.clientStreamer.emitWithoutBroadcast(AppEvents.ACTIONS_CHANGED);\n\t}\n}\n"]},"sourceType":"module","hash":"8b4615583d73c01538f2f42c956650354ce2d4b2"}
