{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/packages/blaze/events.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"packages/blaze/events.js","filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/packages/blaze/events.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","root":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/carlosrodrigues/Desktop/work/rocketchat/Rocket.Chat/packages/blaze/events.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/blaze/events.js"}},"code":"var has;\nmodule.link(\"lodash.has\", {\n  \"default\": function (v) {\n    has = v;\n  }\n}, 0);\nvar EventSupport = Blaze._EventSupport = {};\nvar DOMBackend = Blaze._DOMBackend; // List of events to always delegate, never capture.\n// Since jQuery fakes bubbling for certain events in\n// certain browsers (like `submit`), we don't want to\n// get in its way.\n//\n// We could list all known bubbling\n// events here to avoid creating speculative capturers\n// for them, but it would only be an optimization.\n\nvar eventsToDelegate = EventSupport.eventsToDelegate = {\n  blur: 1,\n  change: 1,\n  click: 1,\n  focus: 1,\n  focusin: 1,\n  focusout: 1,\n  reset: 1,\n  submit: 1\n};\nvar EVENT_MODE = EventSupport.EVENT_MODE = {\n  TBD: 0,\n  BUBBLING: 1,\n  CAPTURING: 2\n};\nvar NEXT_HANDLERREC_ID = 1;\n\nvar HandlerRec = function (elem, type, selector, handler, recipient) {\n  this.elem = elem;\n  this.type = type;\n  this.selector = selector;\n  this.handler = handler;\n  this.recipient = recipient;\n  this.id = NEXT_HANDLERREC_ID++;\n  this.mode = EVENT_MODE.TBD; // It's important that delegatedHandler be a different\n  // instance for each handlerRecord, because its identity\n  // is used to remove it.\n  //\n  // It's also important that the closure have access to\n  // `this` when it is not called with it set.\n\n  this.delegatedHandler = function (h) {\n    return function (evt) {\n      if (!h.selector && evt.currentTarget !== evt.target) // no selector means only fire on target\n        return;\n      return h.handler.apply(h.recipient, arguments);\n    };\n  }(this); // WHY CAPTURE AND DELEGATE: jQuery can't delegate\n  // non-bubbling events, because\n  // event capture doesn't work in IE 8.  However, there\n  // are all sorts of new-fangled non-bubbling events\n  // like \"play\" and \"touchenter\".  We delegate these\n  // events using capture in all browsers except IE 8.\n  // IE 8 doesn't support these events anyway.\n\n\n  var tryCapturing = elem.addEventListener && !has(eventsToDelegate, DOMBackend.Events.parseEventType(type));\n\n  if (tryCapturing) {\n    this.capturingHandler = function (h) {\n      return function (evt) {\n        if (h.mode === EVENT_MODE.TBD) {\n          // must be first time we're called.\n          if (evt.bubbles) {\n            // this type of event bubbles, so don't\n            // get called again.\n            h.mode = EVENT_MODE.BUBBLING;\n            DOMBackend.Events.unbindEventCapturer(h.elem, h.type, h.capturingHandler);\n            return;\n          } else {\n            // this type of event doesn't bubble,\n            // so unbind the delegation, preventing\n            // it from ever firing.\n            h.mode = EVENT_MODE.CAPTURING;\n            DOMBackend.Events.undelegateEvents(h.elem, h.type, h.delegatedHandler);\n          }\n        }\n\n        h.delegatedHandler(evt);\n      };\n    }(this);\n  } else {\n    this.mode = EVENT_MODE.BUBBLING;\n  }\n};\n\nEventSupport.HandlerRec = HandlerRec;\n\nHandlerRec.prototype.bind = function () {\n  // `this.mode` may be EVENT_MODE_TBD, in which case we bind both. in\n  // this case, 'capturingHandler' is in charge of detecting the\n  // correct mode and turning off one or the other handlers.\n  if (this.mode !== EVENT_MODE.BUBBLING) {\n    DOMBackend.Events.bindEventCapturer(this.elem, this.type, this.selector || '*', this.capturingHandler);\n  }\n\n  if (this.mode !== EVENT_MODE.CAPTURING) DOMBackend.Events.delegateEvents(this.elem, this.type, this.selector || '*', this.delegatedHandler);\n};\n\nHandlerRec.prototype.unbind = function () {\n  if (this.mode !== EVENT_MODE.BUBBLING) DOMBackend.Events.unbindEventCapturer(this.elem, this.type, this.capturingHandler);\n  if (this.mode !== EVENT_MODE.CAPTURING) DOMBackend.Events.undelegateEvents(this.elem, this.type, this.delegatedHandler);\n};\n\nEventSupport.listen = function (element, events, selector, handler, recipient, getParentRecipient) {\n  // Prevent this method from being JITed by Safari.  Due to a\n  // presumed JIT bug in Safari -- observed in Version 7.0.6\n  // (9537.78.2) -- this method may crash the Safari render process if\n  // it is JITed.\n  // Repro: https://github.com/dgreensp/public/tree/master/safari-crash\n  try {\n    element = element;\n  } finally {}\n\n  var eventTypes = [];\n  events.replace(/[^ /]+/g, function (e) {\n    eventTypes.push(e);\n  });\n  var newHandlerRecs = [];\n\n  for (var i = 0, N = eventTypes.length; i < N; i++) {\n    var type = eventTypes[i];\n    var eventDict = element.$blaze_events;\n    if (!eventDict) eventDict = element.$blaze_events = {};\n    var info = eventDict[type];\n\n    if (!info) {\n      info = eventDict[type] = {};\n      info.handlers = [];\n    }\n\n    var handlerList = info.handlers;\n    var handlerRec = new HandlerRec(element, type, selector, handler, recipient);\n    newHandlerRecs.push(handlerRec);\n    handlerRec.bind();\n    handlerList.push(handlerRec); // Move handlers of enclosing ranges to end, by unbinding and rebinding\n    // them.  In jQuery (or other DOMBackend) this causes them to fire\n    // later when the backend dispatches event handlers.\n\n    if (getParentRecipient) {\n      for (var r = getParentRecipient(recipient); r; r = getParentRecipient(r)) {\n        // r is an enclosing range (recipient)\n        for (var j = 0, Nj = handlerList.length; j < Nj; j++) {\n          var h = handlerList[j];\n\n          if (h.recipient === r) {\n            h.unbind();\n            h.bind();\n            handlerList.splice(j, 1); // remove handlerList[j]\n\n            handlerList.push(h);\n            j--; // account for removed handler\n\n            Nj--; // don't visit appended handlers\n          }\n        }\n      }\n    }\n  }\n\n  return {\n    // closes over just `element` and `newHandlerRecs`\n    stop: function () {\n      var eventDict = element.$blaze_events;\n      if (!eventDict) return; // newHandlerRecs has only one item unless you specify multiple\n      // event types.  If this code is slow, it's because we have to\n      // iterate over handlerList here.  Clearing a whole handlerList\n      // via stop() methods is O(N^2) in the number of handlers on\n      // an element.\n\n      for (var i = 0; i < newHandlerRecs.length; i++) {\n        var handlerToRemove = newHandlerRecs[i];\n        var info = eventDict[handlerToRemove.type];\n        if (!info) continue;\n        var handlerList = info.handlers;\n\n        for (var j = handlerList.length - 1; j >= 0; j--) {\n          if (handlerList[j] === handlerToRemove) {\n            handlerToRemove.unbind();\n            handlerList.splice(j, 1); // remove handlerList[j]\n          }\n        }\n      }\n\n      newHandlerRecs.length = 0;\n    }\n  };\n};","map":{"version":3,"sources":["packages/blaze/events.js"],"names":["has","module","link","v","EventSupport","Blaze","_EventSupport","DOMBackend","_DOMBackend","eventsToDelegate","blur","change","click","focus","focusin","focusout","reset","submit","EVENT_MODE","TBD","BUBBLING","CAPTURING","NEXT_HANDLERREC_ID","HandlerRec","elem","type","selector","handler","recipient","id","mode","delegatedHandler","h","evt","currentTarget","target","apply","arguments","tryCapturing","addEventListener","Events","parseEventType","capturingHandler","bubbles","unbindEventCapturer","undelegateEvents","prototype","bind","bindEventCapturer","delegateEvents","unbind","listen","element","events","getParentRecipient","eventTypes","replace","e","push","newHandlerRecs","i","N","length","eventDict","$blaze_events","info","handlers","handlerList","handlerRec","r","j","Nj","splice","stop","handlerToRemove"],"mappings":"AAAA,IAAIA,GAAJ;AAAQC,MAAM,CAACC,IAAP,CAAY,YAAZ,EAAyB;AAAC,aAAQ,UAASC,CAAT,EAAW;AAACH,IAAAA,GAAG,GAACG,CAAJ;AAAM;AAA3B,CAAzB,EAAsD,CAAtD;AAER,IAAIC,YAAY,GAAGC,KAAK,CAACC,aAAN,GAAsB,EAAzC;AAEA,IAAIC,UAAU,GAAGF,KAAK,CAACG,WAAvB,C,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIC,gBAAgB,GAAGL,YAAY,CAACK,gBAAb,GAAgC;AACrDC,EAAAA,IAAI,EAAE,CAD+C;AAC5CC,EAAAA,MAAM,EAAE,CADoC;AACjCC,EAAAA,KAAK,EAAE,CAD0B;AACvBC,EAAAA,KAAK,EAAE,CADgB;AACbC,EAAAA,OAAO,EAAE,CADI;AAErDC,EAAAA,QAAQ,EAAE,CAF2C;AAExCC,EAAAA,KAAK,EAAE,CAFiC;AAE9BC,EAAAA,MAAM,EAAE;AAFsB,CAAvD;AAKA,IAAIC,UAAU,GAAGd,YAAY,CAACc,UAAb,GAA0B;AACzCC,EAAAA,GAAG,EAAE,CADoC;AAEzCC,EAAAA,QAAQ,EAAE,CAF+B;AAGzCC,EAAAA,SAAS,EAAE;AAH8B,CAA3C;AAMA,IAAIC,kBAAkB,GAAG,CAAzB;;AAEA,IAAIC,UAAU,GAAG,UAAUC,IAAV,EAAgBC,IAAhB,EAAsBC,QAAtB,EAAgCC,OAAhC,EAAyCC,SAAzC,EAAoD;AACnE,OAAKJ,IAAL,GAAYA,IAAZ;AACA,OAAKC,IAAL,GAAYA,IAAZ;AACA,OAAKC,QAAL,GAAgBA,QAAhB;AACA,OAAKC,OAAL,GAAeA,OAAf;AACA,OAAKC,SAAL,GAAiBA,SAAjB;AACA,OAAKC,EAAL,GAAWP,kBAAkB,EAA7B;AAEA,OAAKQ,IAAL,GAAYZ,UAAU,CAACC,GAAvB,CARmE,CAUnE;AACA;AACA;AACA;AACA;AACA;;AACA,OAAKY,gBAAL,GAAyB,UAAUC,CAAV,EAAa;AACpC,WAAO,UAAUC,GAAV,EAAe;AACpB,UAAK,CAAED,CAAC,CAACN,QAAL,IAAkBO,GAAG,CAACC,aAAJ,KAAsBD,GAAG,CAACE,MAAhD,EACE;AACA;AACF,aAAOH,CAAC,CAACL,OAAF,CAAUS,KAAV,CAAgBJ,CAAC,CAACJ,SAAlB,EAA6BS,SAA7B,CAAP;AACD,KALD;AAMD,GAPuB,CAOrB,IAPqB,CAAxB,CAhBmE,CAyBnE;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,MAAIC,YAAY,GAAGd,IAAI,CAACe,gBAAL,IACZ,CAACvC,GAAG,CAACS,gBAAD,EACIF,UAAU,CAACiC,MAAX,CAAkBC,cAAlB,CAAiChB,IAAjC,CADJ,CADX;;AAIA,MAAIa,YAAJ,EAAkB;AAChB,SAAKI,gBAAL,GAAyB,UAAUV,CAAV,EAAa;AACpC,aAAO,UAAUC,GAAV,EAAe;AACpB,YAAID,CAAC,CAACF,IAAF,KAAWZ,UAAU,CAACC,GAA1B,EAA+B;AAC7B;AACA,cAAIc,GAAG,CAACU,OAAR,EAAiB;AACf;AACA;AACAX,YAAAA,CAAC,CAACF,IAAF,GAASZ,UAAU,CAACE,QAApB;AACAb,YAAAA,UAAU,CAACiC,MAAX,CAAkBI,mBAAlB,CACEZ,CAAC,CAACR,IADJ,EACUQ,CAAC,CAACP,IADZ,EACkBO,CAAC,CAACU,gBADpB;AAEA;AACD,WAPD,MAOO;AACL;AACA;AACA;AACAV,YAAAA,CAAC,CAACF,IAAF,GAASZ,UAAU,CAACG,SAApB;AACAd,YAAAA,UAAU,CAACiC,MAAX,CAAkBK,gBAAlB,CACEb,CAAC,CAACR,IADJ,EACUQ,CAAC,CAACP,IADZ,EACkBO,CAAC,CAACD,gBADpB;AAED;AACF;;AAEDC,QAAAA,CAAC,CAACD,gBAAF,CAAmBE,GAAnB;AACD,OArBD;AAsBD,KAvBuB,CAuBrB,IAvBqB,CAAxB;AAyBD,GA1BD,MA0BO;AACL,SAAKH,IAAL,GAAYZ,UAAU,CAACE,QAAvB;AACD;AACF,CAlED;;AAmEAhB,YAAY,CAACmB,UAAb,GAA0BA,UAA1B;;AAEAA,UAAU,CAACuB,SAAX,CAAqBC,IAArB,GAA4B,YAAY;AACtC;AACA;AACA;AACA,MAAI,KAAKjB,IAAL,KAAcZ,UAAU,CAACE,QAA7B,EAAuC;AACrCb,IAAAA,UAAU,CAACiC,MAAX,CAAkBQ,iBAAlB,CACE,KAAKxB,IADP,EACa,KAAKC,IADlB,EACwB,KAAKC,QAAL,IAAiB,GADzC,EAEE,KAAKgB,gBAFP;AAGD;;AAED,MAAI,KAAKZ,IAAL,KAAcZ,UAAU,CAACG,SAA7B,EACEd,UAAU,CAACiC,MAAX,CAAkBS,cAAlB,CACE,KAAKzB,IADP,EACa,KAAKC,IADlB,EAEE,KAAKC,QAAL,IAAiB,GAFnB,EAEwB,KAAKK,gBAF7B;AAGH,CAdD;;AAgBAR,UAAU,CAACuB,SAAX,CAAqBI,MAArB,GAA8B,YAAY;AACxC,MAAI,KAAKpB,IAAL,KAAcZ,UAAU,CAACE,QAA7B,EACEb,UAAU,CAACiC,MAAX,CAAkBI,mBAAlB,CAAsC,KAAKpB,IAA3C,EAAiD,KAAKC,IAAtD,EACsC,KAAKiB,gBAD3C;AAGF,MAAI,KAAKZ,IAAL,KAAcZ,UAAU,CAACG,SAA7B,EACEd,UAAU,CAACiC,MAAX,CAAkBK,gBAAlB,CAAmC,KAAKrB,IAAxC,EAA8C,KAAKC,IAAnD,EACmC,KAAKM,gBADxC;AAEH,CARD;;AAUA3B,YAAY,CAAC+C,MAAb,GAAsB,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B3B,QAA3B,EAAqCC,OAArC,EAA8CC,SAA9C,EAAyD0B,kBAAzD,EAA6E;AAEjG;AACA;AACA;AACA;AACA;AACA,MAAI;AAAEF,IAAAA,OAAO,GAAGA,OAAV;AAAoB,GAA1B,SAAmC,CAAE;;AAErC,MAAIG,UAAU,GAAG,EAAjB;AACAF,EAAAA,MAAM,CAACG,OAAP,CAAe,SAAf,EAA0B,UAAUC,CAAV,EAAa;AACrCF,IAAAA,UAAU,CAACG,IAAX,CAAgBD,CAAhB;AACD,GAFD;AAIA,MAAIE,cAAc,GAAG,EAArB;;AACA,OAAK,IAAIC,CAAC,GAAG,CAAR,EAAWC,CAAC,GAAGN,UAAU,CAACO,MAA/B,EAAuCF,CAAC,GAAGC,CAA3C,EAA8CD,CAAC,EAA/C,EAAmD;AACjD,QAAInC,IAAI,GAAG8B,UAAU,CAACK,CAAD,CAArB;AAEA,QAAIG,SAAS,GAAGX,OAAO,CAACY,aAAxB;AACA,QAAI,CAAED,SAAN,EACEA,SAAS,GAAIX,OAAO,CAACY,aAAR,GAAwB,EAArC;AAEF,QAAIC,IAAI,GAAGF,SAAS,CAACtC,IAAD,CAApB;;AACA,QAAI,CAAEwC,IAAN,EAAY;AACVA,MAAAA,IAAI,GAAGF,SAAS,CAACtC,IAAD,CAAT,GAAkB,EAAzB;AACAwC,MAAAA,IAAI,CAACC,QAAL,GAAgB,EAAhB;AACD;;AACD,QAAIC,WAAW,GAAGF,IAAI,CAACC,QAAvB;AACA,QAAIE,UAAU,GAAG,IAAI7C,UAAJ,CACf6B,OADe,EACN3B,IADM,EACAC,QADA,EACUC,OADV,EACmBC,SADnB,CAAjB;AAEA+B,IAAAA,cAAc,CAACD,IAAf,CAAoBU,UAApB;AACAA,IAAAA,UAAU,CAACrB,IAAX;AACAoB,IAAAA,WAAW,CAACT,IAAZ,CAAiBU,UAAjB,EAjBiD,CAkBjD;AACA;AACA;;AACA,QAAId,kBAAJ,EAAwB;AACtB,WAAK,IAAIe,CAAC,GAAGf,kBAAkB,CAAC1B,SAAD,CAA/B,EAA4CyC,CAA5C,EACKA,CAAC,GAAGf,kBAAkB,CAACe,CAAD,CAD3B,EACgC;AAC9B;AACA,aAAK,IAAIC,CAAC,GAAG,CAAR,EAAWC,EAAE,GAAGJ,WAAW,CAACL,MAAjC,EACKQ,CAAC,GAAGC,EADT,EACaD,CAAC,EADd,EACkB;AAChB,cAAItC,CAAC,GAAGmC,WAAW,CAACG,CAAD,CAAnB;;AACA,cAAItC,CAAC,CAACJ,SAAF,KAAgByC,CAApB,EAAuB;AACrBrC,YAAAA,CAAC,CAACkB,MAAF;AACAlB,YAAAA,CAAC,CAACe,IAAF;AACAoB,YAAAA,WAAW,CAACK,MAAZ,CAAmBF,CAAnB,EAAsB,CAAtB,EAHqB,CAGK;;AAC1BH,YAAAA,WAAW,CAACT,IAAZ,CAAiB1B,CAAjB;AACAsC,YAAAA,CAAC,GALoB,CAKhB;;AACLC,YAAAA,EAAE,GANmB,CAMf;AACP;AACF;AACF;AACF;AACF;;AAED,SAAO;AACL;AACAE,IAAAA,IAAI,EAAE,YAAY;AAChB,UAAIV,SAAS,GAAGX,OAAO,CAACY,aAAxB;AACA,UAAI,CAAED,SAAN,EACE,OAHc,CAIhB;AACA;AACA;AACA;AACA;;AACA,WAAK,IAAIH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,cAAc,CAACG,MAAnC,EAA2CF,CAAC,EAA5C,EAAgD;AAC9C,YAAIc,eAAe,GAAGf,cAAc,CAACC,CAAD,CAApC;AACA,YAAIK,IAAI,GAAGF,SAAS,CAACW,eAAe,CAACjD,IAAjB,CAApB;AACA,YAAI,CAAEwC,IAAN,EACE;AACF,YAAIE,WAAW,GAAGF,IAAI,CAACC,QAAvB;;AACA,aAAK,IAAII,CAAC,GAAGH,WAAW,CAACL,MAAZ,GAAqB,CAAlC,EAAqCQ,CAAC,IAAI,CAA1C,EAA6CA,CAAC,EAA9C,EAAkD;AAChD,cAAIH,WAAW,CAACG,CAAD,CAAX,KAAmBI,eAAvB,EAAwC;AACtCA,YAAAA,eAAe,CAACxB,MAAhB;AACAiB,YAAAA,WAAW,CAACK,MAAZ,CAAmBF,CAAnB,EAAsB,CAAtB,EAFsC,CAEZ;AAC3B;AACF;AACF;;AACDX,MAAAA,cAAc,CAACG,MAAf,GAAwB,CAAxB;AACD;AAzBI,GAAP;AA2BD,CAnFD","sourcesContent":["import has from 'lodash.has';\n\nvar EventSupport = Blaze._EventSupport = {};\n\nvar DOMBackend = Blaze._DOMBackend;\n\n// List of events to always delegate, never capture.\n// Since jQuery fakes bubbling for certain events in\n// certain browsers (like `submit`), we don't want to\n// get in its way.\n//\n// We could list all known bubbling\n// events here to avoid creating speculative capturers\n// for them, but it would only be an optimization.\nvar eventsToDelegate = EventSupport.eventsToDelegate = {\n  blur: 1, change: 1, click: 1, focus: 1, focusin: 1,\n  focusout: 1, reset: 1, submit: 1\n};\n\nvar EVENT_MODE = EventSupport.EVENT_MODE = {\n  TBD: 0,\n  BUBBLING: 1,\n  CAPTURING: 2\n};\n\nvar NEXT_HANDLERREC_ID = 1;\n\nvar HandlerRec = function (elem, type, selector, handler, recipient) {\n  this.elem = elem;\n  this.type = type;\n  this.selector = selector;\n  this.handler = handler;\n  this.recipient = recipient;\n  this.id = (NEXT_HANDLERREC_ID++);\n\n  this.mode = EVENT_MODE.TBD;\n\n  // It's important that delegatedHandler be a different\n  // instance for each handlerRecord, because its identity\n  // is used to remove it.\n  //\n  // It's also important that the closure have access to\n  // `this` when it is not called with it set.\n  this.delegatedHandler = (function (h) {\n    return function (evt) {\n      if ((! h.selector) && evt.currentTarget !== evt.target)\n        // no selector means only fire on target\n        return;\n      return h.handler.apply(h.recipient, arguments);\n    };\n  })(this);\n\n  // WHY CAPTURE AND DELEGATE: jQuery can't delegate\n  // non-bubbling events, because\n  // event capture doesn't work in IE 8.  However, there\n  // are all sorts of new-fangled non-bubbling events\n  // like \"play\" and \"touchenter\".  We delegate these\n  // events using capture in all browsers except IE 8.\n  // IE 8 doesn't support these events anyway.\n\n  var tryCapturing = elem.addEventListener &&\n        (!has(eventsToDelegate,\n                 DOMBackend.Events.parseEventType(type)));\n\n  if (tryCapturing) {\n    this.capturingHandler = (function (h) {\n      return function (evt) {\n        if (h.mode === EVENT_MODE.TBD) {\n          // must be first time we're called.\n          if (evt.bubbles) {\n            // this type of event bubbles, so don't\n            // get called again.\n            h.mode = EVENT_MODE.BUBBLING;\n            DOMBackend.Events.unbindEventCapturer(\n              h.elem, h.type, h.capturingHandler);\n            return;\n          } else {\n            // this type of event doesn't bubble,\n            // so unbind the delegation, preventing\n            // it from ever firing.\n            h.mode = EVENT_MODE.CAPTURING;\n            DOMBackend.Events.undelegateEvents(\n              h.elem, h.type, h.delegatedHandler);\n          }\n        }\n\n        h.delegatedHandler(evt);\n      };\n    })(this);\n\n  } else {\n    this.mode = EVENT_MODE.BUBBLING;\n  }\n};\nEventSupport.HandlerRec = HandlerRec;\n\nHandlerRec.prototype.bind = function () {\n  // `this.mode` may be EVENT_MODE_TBD, in which case we bind both. in\n  // this case, 'capturingHandler' is in charge of detecting the\n  // correct mode and turning off one or the other handlers.\n  if (this.mode !== EVENT_MODE.BUBBLING) {\n    DOMBackend.Events.bindEventCapturer(\n      this.elem, this.type, this.selector || '*',\n      this.capturingHandler);\n  }\n\n  if (this.mode !== EVENT_MODE.CAPTURING)\n    DOMBackend.Events.delegateEvents(\n      this.elem, this.type,\n      this.selector || '*', this.delegatedHandler);\n};\n\nHandlerRec.prototype.unbind = function () {\n  if (this.mode !== EVENT_MODE.BUBBLING)\n    DOMBackend.Events.unbindEventCapturer(this.elem, this.type,\n                                          this.capturingHandler);\n\n  if (this.mode !== EVENT_MODE.CAPTURING)\n    DOMBackend.Events.undelegateEvents(this.elem, this.type,\n                                       this.delegatedHandler);\n};\n\nEventSupport.listen = function (element, events, selector, handler, recipient, getParentRecipient) {\n\n  // Prevent this method from being JITed by Safari.  Due to a\n  // presumed JIT bug in Safari -- observed in Version 7.0.6\n  // (9537.78.2) -- this method may crash the Safari render process if\n  // it is JITed.\n  // Repro: https://github.com/dgreensp/public/tree/master/safari-crash\n  try { element = element; } finally {}\n\n  var eventTypes = [];\n  events.replace(/[^ /]+/g, function (e) {\n    eventTypes.push(e);\n  });\n\n  var newHandlerRecs = [];\n  for (var i = 0, N = eventTypes.length; i < N; i++) {\n    var type = eventTypes[i];\n\n    var eventDict = element.$blaze_events;\n    if (! eventDict)\n      eventDict = (element.$blaze_events = {});\n\n    var info = eventDict[type];\n    if (! info) {\n      info = eventDict[type] = {};\n      info.handlers = [];\n    }\n    var handlerList = info.handlers;\n    var handlerRec = new HandlerRec(\n      element, type, selector, handler, recipient);\n    newHandlerRecs.push(handlerRec);\n    handlerRec.bind();\n    handlerList.push(handlerRec);\n    // Move handlers of enclosing ranges to end, by unbinding and rebinding\n    // them.  In jQuery (or other DOMBackend) this causes them to fire\n    // later when the backend dispatches event handlers.\n    if (getParentRecipient) {\n      for (var r = getParentRecipient(recipient); r;\n           r = getParentRecipient(r)) {\n        // r is an enclosing range (recipient)\n        for (var j = 0, Nj = handlerList.length;\n             j < Nj; j++) {\n          var h = handlerList[j];\n          if (h.recipient === r) {\n            h.unbind();\n            h.bind();\n            handlerList.splice(j, 1); // remove handlerList[j]\n            handlerList.push(h);\n            j--; // account for removed handler\n            Nj--; // don't visit appended handlers\n          }\n        }\n      }\n    }\n  }\n\n  return {\n    // closes over just `element` and `newHandlerRecs`\n    stop: function () {\n      var eventDict = element.$blaze_events;\n      if (! eventDict)\n        return;\n      // newHandlerRecs has only one item unless you specify multiple\n      // event types.  If this code is slow, it's because we have to\n      // iterate over handlerList here.  Clearing a whole handlerList\n      // via stop() methods is O(N^2) in the number of handlers on\n      // an element.\n      for (var i = 0; i < newHandlerRecs.length; i++) {\n        var handlerToRemove = newHandlerRecs[i];\n        var info = eventDict[handlerToRemove.type];\n        if (! info)\n          continue;\n        var handlerList = info.handlers;\n        for (var j = handlerList.length - 1; j >= 0; j--) {\n          if (handlerList[j] === handlerToRemove) {\n            handlerToRemove.unbind();\n            handlerList.splice(j, 1); // remove handlerList[j]\n          }\n        }\n      }\n      newHandlerRecs.length = 0;\n    }\n  };\n};\n"]},"sourceType":"module","hash":"fcc7228ae67ee4d1978c315d805be8ae18635319"}
