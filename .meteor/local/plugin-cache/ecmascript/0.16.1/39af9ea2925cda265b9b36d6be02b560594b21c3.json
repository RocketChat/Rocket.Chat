{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/home/weslley/Documents/projects/Rocket.Chat/ee/app/livechat-enterprise/server/api/agents.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.linux.x86_64"},"sourceFileName":"ee/app/livechat-enterprise/server/api/agents.js","filename":"/home/weslley/Documents/projects/Rocket.Chat/ee/app/livechat-enterprise/server/api/agents.js","targets":{"android":"95.0.0","chrome":"95.0.0","edge":"95.0.0","firefox":"78.0.0","ie":"10.0.0","ios":"15.0.0","opera":"81.0.0","safari":"15.1.0","samsung":"14.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/home/weslley/Documents/projects/Rocket.Chat","root":"/home/weslley/Documents/projects/Rocket.Chat","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.16.5","helpers":true,"useESModules":false,"corejs":false}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":true,"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_verified":true},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"proposal-logical-assignment-operators","visitor":{"_exploded":{},"_verified":{},"AssignmentExpression":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/home/weslley/Documents/projects/Rocket.Chat/ee/app/livechat-enterprise/server/api/agents.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"ee/app/livechat-enterprise/server/api/agents.js"}},"code":"let Match, check;\nmodule.link(\"meteor/check\", {\n  Match(v) {\n    Match = v;\n  },\n\n  check(v) {\n    check = v;\n  }\n\n}, 0);\nlet API;\nmodule.link(\"../../../../../app/api/server\", {\n  API(v) {\n    API = v;\n  }\n\n}, 1);\nlet hasPermission;\nmodule.link(\"../../../../../app/authorization/server\", {\n  hasPermission(v) {\n    hasPermission = v;\n  }\n\n}, 2);\nlet findAllAverageServiceTime, findAllServiceTime, findAvailableServiceTimeHistory;\nmodule.link(\"../../../../../app/livechat/server/lib/analytics/agents\", {\n  findAllAverageServiceTime(v) {\n    findAllAverageServiceTime = v;\n  },\n\n  findAllServiceTime(v) {\n    findAllServiceTime = v;\n  },\n\n  findAvailableServiceTimeHistory(v) {\n    findAvailableServiceTimeHistory = v;\n  }\n\n}, 3);\nAPI.v1.addRoute('livechat/analytics/agents/average-service-time', {\n  authRequired: true\n}, {\n  get() {\n    if (!hasPermission(this.userId, 'view-livechat-manager')) {\n      return API.v1.unauthorized();\n    }\n\n    const {\n      offset,\n      count\n    } = this.getPaginationItems();\n    let {\n      start,\n      end\n    } = this.requestParams();\n    check(start, String);\n    check(end, String);\n\n    if (isNaN(Date.parse(start))) {\n      return API.v1.failure('The \"start\" query parameter must be a valid date.');\n    }\n\n    start = new Date(start);\n\n    if (isNaN(Date.parse(end))) {\n      return API.v1.failure('The \"end\" query parameter must be a valid date.');\n    }\n\n    end = new Date(end);\n    const {\n      agents,\n      total\n    } = findAllAverageServiceTime({\n      start,\n      end,\n      options: {\n        offset,\n        count\n      }\n    });\n    return API.v1.success({\n      agents,\n      count: agents.length,\n      offset,\n      total\n    });\n  }\n\n});\nAPI.v1.addRoute('livechat/analytics/agents/total-service-time', {\n  authRequired: true\n}, {\n  get() {\n    if (!hasPermission(this.userId, 'view-livechat-manager')) {\n      return API.v1.unauthorized();\n    }\n\n    const {\n      offset,\n      count\n    } = this.getPaginationItems();\n    let {\n      start,\n      end\n    } = this.requestParams();\n    check(start, String);\n    check(end, String);\n\n    if (isNaN(Date.parse(start))) {\n      return API.v1.failure('The \"start\" query parameter must be a valid date.');\n    }\n\n    start = new Date(start);\n\n    if (isNaN(Date.parse(end))) {\n      return API.v1.failure('The \"end\" query parameter must be a valid date.');\n    }\n\n    end = new Date(end);\n    const {\n      agents,\n      total\n    } = findAllServiceTime({\n      start,\n      end,\n      options: {\n        offset,\n        count\n      }\n    });\n    return API.v1.success({\n      agents,\n      count: agents.length,\n      offset,\n      total\n    });\n  }\n\n});\nAPI.v1.addRoute('livechat/analytics/agents/available-for-service-history', {\n  authRequired: true\n}, {\n  get() {\n    if (!hasPermission(this.userId, 'view-livechat-manager')) {\n      return API.v1.unauthorized();\n    }\n\n    const {\n      offset,\n      count\n    } = this.getPaginationItems();\n    let {\n      start,\n      end\n    } = this.requestParams();\n    const {\n      fullReport\n    } = this.requestParams();\n    check(start, String);\n    check(end, String);\n    check(fullReport, Match.Maybe(String));\n\n    if (isNaN(Date.parse(start))) {\n      return API.v1.failure('The \"start\" query parameter must be a valid date.');\n    }\n\n    start = new Date(start);\n\n    if (isNaN(Date.parse(end))) {\n      return API.v1.failure('The \"end\" query parameter must be a valid date.');\n    }\n\n    end = new Date(end);\n    const {\n      agents,\n      total\n    } = findAvailableServiceTimeHistory({\n      start,\n      end,\n      fullReport: fullReport && fullReport === 'true',\n      options: {\n        offset,\n        count\n      }\n    });\n    return API.v1.success({\n      agents,\n      count: agents.length,\n      offset,\n      total\n    });\n  }\n\n});","map":{"version":3,"sources":["ee/app/livechat-enterprise/server/api/agents.js"],"names":["Match","check","module","link","v","API","hasPermission","findAllAverageServiceTime","findAllServiceTime","findAvailableServiceTimeHistory","v1","addRoute","authRequired","get","userId","unauthorized","offset","count","getPaginationItems","start","end","requestParams","String","isNaN","Date","parse","failure","agents","total","options","success","length","fullReport","Maybe"],"mappings":"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","sourcesContent":["import { Match, check } from 'meteor/check';\n\nimport { API } from '../../../../../app/api/server';\nimport { hasPermission } from '../../../../../app/authorization/server';\nimport {\n\tfindAllAverageServiceTime,\n\tfindAllServiceTime,\n\tfindAvailableServiceTimeHistory,\n} from '../../../../../app/livechat/server/lib/analytics/agents';\n\nAPI.v1.addRoute(\n\t'livechat/analytics/agents/average-service-time',\n\t{ authRequired: true },\n\t{\n\t\tget() {\n\t\t\tif (!hasPermission(this.userId, 'view-livechat-manager')) {\n\t\t\t\treturn API.v1.unauthorized();\n\t\t\t}\n\t\t\tconst { offset, count } = this.getPaginationItems();\n\t\t\tlet { start, end } = this.requestParams();\n\n\t\t\tcheck(start, String);\n\t\t\tcheck(end, String);\n\n\t\t\tif (isNaN(Date.parse(start))) {\n\t\t\t\treturn API.v1.failure('The \"start\" query parameter must be a valid date.');\n\t\t\t}\n\t\t\tstart = new Date(start);\n\n\t\t\tif (isNaN(Date.parse(end))) {\n\t\t\t\treturn API.v1.failure('The \"end\" query parameter must be a valid date.');\n\t\t\t}\n\t\t\tend = new Date(end);\n\n\t\t\tconst { agents, total } = findAllAverageServiceTime({\n\t\t\t\tstart,\n\t\t\t\tend,\n\t\t\t\toptions: { offset, count },\n\t\t\t});\n\t\t\treturn API.v1.success({\n\t\t\t\tagents,\n\t\t\t\tcount: agents.length,\n\t\t\t\toffset,\n\t\t\t\ttotal,\n\t\t\t});\n\t\t},\n\t},\n);\n\nAPI.v1.addRoute(\n\t'livechat/analytics/agents/total-service-time',\n\t{ authRequired: true },\n\t{\n\t\tget() {\n\t\t\tif (!hasPermission(this.userId, 'view-livechat-manager')) {\n\t\t\t\treturn API.v1.unauthorized();\n\t\t\t}\n\t\t\tconst { offset, count } = this.getPaginationItems();\n\t\t\tlet { start, end } = this.requestParams();\n\n\t\t\tcheck(start, String);\n\t\t\tcheck(end, String);\n\n\t\t\tif (isNaN(Date.parse(start))) {\n\t\t\t\treturn API.v1.failure('The \"start\" query parameter must be a valid date.');\n\t\t\t}\n\t\t\tstart = new Date(start);\n\n\t\t\tif (isNaN(Date.parse(end))) {\n\t\t\t\treturn API.v1.failure('The \"end\" query parameter must be a valid date.');\n\t\t\t}\n\t\t\tend = new Date(end);\n\n\t\t\tconst { agents, total } = findAllServiceTime({\n\t\t\t\tstart,\n\t\t\t\tend,\n\t\t\t\toptions: { offset, count },\n\t\t\t});\n\t\t\treturn API.v1.success({\n\t\t\t\tagents,\n\t\t\t\tcount: agents.length,\n\t\t\t\toffset,\n\t\t\t\ttotal,\n\t\t\t});\n\t\t},\n\t},\n);\n\nAPI.v1.addRoute(\n\t'livechat/analytics/agents/available-for-service-history',\n\t{ authRequired: true },\n\t{\n\t\tget() {\n\t\t\tif (!hasPermission(this.userId, 'view-livechat-manager')) {\n\t\t\t\treturn API.v1.unauthorized();\n\t\t\t}\n\t\t\tconst { offset, count } = this.getPaginationItems();\n\t\t\tlet { start, end } = this.requestParams();\n\t\t\tconst { fullReport } = this.requestParams();\n\n\t\t\tcheck(start, String);\n\t\t\tcheck(end, String);\n\t\t\tcheck(fullReport, Match.Maybe(String));\n\n\t\t\tif (isNaN(Date.parse(start))) {\n\t\t\t\treturn API.v1.failure('The \"start\" query parameter must be a valid date.');\n\t\t\t}\n\t\t\tstart = new Date(start);\n\n\t\t\tif (isNaN(Date.parse(end))) {\n\t\t\t\treturn API.v1.failure('The \"end\" query parameter must be a valid date.');\n\t\t\t}\n\t\t\tend = new Date(end);\n\n\t\t\tconst { agents, total } = findAvailableServiceTimeHistory({\n\t\t\t\tstart,\n\t\t\t\tend,\n\t\t\t\tfullReport: fullReport && fullReport === 'true',\n\t\t\t\toptions: { offset, count },\n\t\t\t});\n\t\t\treturn API.v1.success({\n\t\t\t\tagents,\n\t\t\t\tcount: agents.length,\n\t\t\t\toffset,\n\t\t\t\ttotal,\n\t\t\t});\n\t\t},\n\t},\n);\n"]},"sourceType":"module","hash":"39af9ea2925cda265b9b36d6be02b560594b21c3"}
