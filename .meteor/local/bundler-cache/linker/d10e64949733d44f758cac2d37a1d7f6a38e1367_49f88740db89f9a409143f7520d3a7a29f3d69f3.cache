[{"type":"js","data":"(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\nvar _ = Package.underscore._;\nvar Tracker = Package.tracker.Tracker;\nvar Deps = Package.tracker.Deps;\nvar ReactiveDict = Package['reactive-dict'].ReactiveDict;\nvar ReactiveVar = Package['reactive-var'].ReactiveVar;\nvar EJSON = Package.ejson.EJSON;\nvar meteorInstall = Package.modules.meteorInstall;\n\n/* Package-scope variables */\nvar Router, Group, Route, FlowRouter, FastRender;\n\nvar require = meteorInstall({\"node_modules\":{\"meteor\":{\"kadira:flow-router\":{\"server\":{\"router.js\":function module(require){\n\n//////////////////////////////////////////////////////////////////////////////////////\n//                                                                                  //\n// packages/kadira_flow-router/server/router.js                                     //\n//                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////\n                                                                                    //\nvar Qs = Npm.require('qs');\n\nRouter = function () {\n  this._routes = [];\n  this._routesMap = {};\n  this.subscriptions = Function.prototype;\n\n  // holds onRoute callbacks\n  this._onRouteCallbacks = [];\n};\n\nRouter.prototype.route = function(pathDef, options) {\n  if (!/^\\/.*/.test(pathDef)) {\n    var message = \"route's path must start with '/'\";\n    throw new Error(message);\n  }\n  \n  options = options || {};\n  var route = new Route(this, pathDef, options);\n  this._routes.push(route);\n\n  if (options.name) {\n    this._routesMap[options.name] = route;\n  }\n\n  this._triggerRouteRegister(route);\n  return route;\n};\n\nRouter.prototype.group = function(options) {\n  return new Group(this, options);\n};\n\nRouter.prototype.path = function(pathDef, fields, queryParams) {\n  if (this._routesMap[pathDef]) {\n    pathDef = this._routesMap[pathDef].path;\n  }\n\n  fields = fields || {};\n  var regExp = /(:[\\w\\(\\)\\\\\\+\\*\\.\\?]+)+/g;\n  var path = pathDef.replace(regExp, function(key) {\n    var firstRegexpChar = key.indexOf(\"(\");\n    // get the content behind : and (\\\\d+/)\n    key = key.substring(1, (firstRegexpChar > 0)? firstRegexpChar: undefined);\n    // remove +?*\n    key = key.replace(/[\\+\\*\\?]+/g, \"\");\n\n    return fields[key] || \"\";\n  });\n\n  path = path.replace(/\\/\\/+/g, \"/\"); // Replace multiple slashes with single slash\n\n  // remove trailing slash\n  // but keep the root slash if it's the only one\n  path = path.match(/^\\/{1}$/) ? path: path.replace(/\\/$/, \"\");\n\n  var strQueryParams = Qs.stringify(queryParams || {});\n  if(strQueryParams) {\n    path += \"?\" + strQueryParams;\n  }\n\n  return path;\n};\n\nRouter.prototype.onRouteRegister = function(cb) {\n  this._onRouteCallbacks.push(cb);\n};\n\nRouter.prototype._triggerRouteRegister = function(currentRoute) {\n  // We should only need to send a safe set of fields on the route\n  // object.\n  // This is not to hide what's inside the route object, but to show \n  // these are the public APIs\n  var routePublicApi = _.pick(currentRoute, 'name', 'pathDef', 'path');\n  var omittingOptionFields = [\n    'triggersEnter', 'triggersExit', 'action', 'subscriptions', 'name'\n  ];\n  routePublicApi.options = _.omit(currentRoute.options, omittingOptionFields);\n\n  _.each(this._onRouteCallbacks, function(cb) {\n    cb(routePublicApi);\n  });\n};\n\n\nRouter.prototype.go = function() {\n  // client only\n};\n\n\nRouter.prototype.current = function() {\n  // client only\n};\n\n\nRouter.prototype.triggers = {\n  enter: function() {\n    // client only\n  },\n  exit: function() {\n    // client only\n  }\n};\n\nRouter.prototype.middleware = function() {\n  // client only\n};\n\n\nRouter.prototype.getState = function() {\n  // client only\n};\n\n\nRouter.prototype.getAllStates = function() {\n  // client only\n};\n\n\nRouter.prototype.setState = function() {\n  // client only\n};\n\n\nRouter.prototype.removeState = function() {\n  // client only\n};\n\n\nRouter.prototype.clearStates = function() {\n  // client only\n};\n\n\nRouter.prototype.ready = function() {\n  // client only\n};\n\n\nRouter.prototype.initialize = function() {\n  // client only\n};\n\nRouter.prototype.wait = function() {\n  // client only\n};\n\n//////////////////////////////////////////////////////////////////////////////////////\n\n},\"group.js\":function module(){\n\n//////////////////////////////////////////////////////////////////////////////////////\n//                                                                                  //\n// packages/kadira_flow-router/server/group.js                                      //\n//                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////\n                                                                                    //\nGroup = function(router, options) {\n  options = options || {};\n  this.prefix = options.prefix || '';\n  this.options = options;\n  this._router = router;\n};\n\nGroup.prototype.route = function(pathDef, options) {\n  pathDef = this.prefix + pathDef;\n  return this._router.route(pathDef, options);\n};\n\nGroup.prototype.group = function(options) {\n  var group = new Group(this._router, options);\n  group.parent = this;\n\n  return group;\n};\n\n//////////////////////////////////////////////////////////////////////////////////////\n\n},\"route.js\":function module(){\n\n//////////////////////////////////////////////////////////////////////////////////////\n//                                                                                  //\n// packages/kadira_flow-router/server/route.js                                      //\n//                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////\n                                                                                    //\nRoute = function(router, pathDef, options) {\n  options = options || {};\n  this.options = options;\n  this.name = options.name;\n  this.pathDef = pathDef;\n\n  // Route.path is deprecated and will be removed in 3.0\n  this.path = pathDef;\n\n  this.action = options.action || Function.prototype;\n  this.subscriptions = options.subscriptions || Function.prototype;\n  this._subsMap = {};\n};\n\n\nRoute.prototype.register = function(name, sub, options) {\n  this._subsMap[name] = sub;\n};\n\n\nRoute.prototype.subscription = function(name) {\n  return this._subsMap[name];\n};\n\n\nRoute.prototype.middleware = function(middleware) {\n \n};\n\n//////////////////////////////////////////////////////////////////////////////////////\n\n},\"_init.js\":function module(){\n\n//////////////////////////////////////////////////////////////////////////////////////\n//                                                                                  //\n// packages/kadira_flow-router/server/_init.js                                      //\n//                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////\n                                                                                    //\n// Export Router Instance\nFlowRouter = new Router();\nFlowRouter.Router = Router;\nFlowRouter.Route = Route;\n\n//////////////////////////////////////////////////////////////////////////////////////\n\n},\"plugins\":{\"fast_render.js\":function module(){\n\n//////////////////////////////////////////////////////////////////////////////////////\n//                                                                                  //\n// packages/kadira_flow-router/server/plugins/fast_render.js                        //\n//                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////\n                                                                                    //\nif(!Package['meteorhacks:fast-render']) {\n  return;\n}\n\nFastRender = Package['meteorhacks:fast-render'].FastRender;\n\n// hack to run after eveything else on startup\nMeteor.startup(function () {\n  Meteor.startup(function () {\n    setupFastRender();\n  });\n});\n\nfunction setupFastRender () {\n  _.each(FlowRouter._routes, function (route) {\n    FastRender.route(route.pathDef, function (routeParams, path) {\n      var self = this;\n\n      // anyone using Meteor.subscribe for something else?\n      var original = Meteor.subscribe;\n      Meteor.subscribe = function () {\n        return _.toArray(arguments);\n      };\n\n      route._subsMap = {};\n      FlowRouter.subscriptions.call(route, path);\n      if(route.subscriptions) {\n        var queryParams = routeParams.query;\n        var params = _.omit(routeParams, 'query');\n        route.subscriptions(params, queryParams);\n      }\n      _.each(route._subsMap, function (args) {\n        self.subscribe.apply(self, args);\n      });\n\n      // restore Meteor.subscribe, ... on server side\n      Meteor.subscribe = original;\n    });\n  });\n}\n\n//////////////////////////////////////////////////////////////////////////////////////\n\n}}},\"lib\":{\"router.js\":function module(){\n\n//////////////////////////////////////////////////////////////////////////////////////\n//                                                                                  //\n// packages/kadira_flow-router/lib/router.js                                        //\n//                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////\n                                                                                    //\nRouter.prototype.url = function() {\n  // We need to remove the leading base path, or \"/\", as it will be inserted\n  // automatically by `Meteor.absoluteUrl` as documented in:\n  // http://docs.meteor.com/#/full/meteor_absoluteurl\n  var completePath = this.path.apply(this, arguments);\n  var basePath = this._basePath || '/';\n  var pathWithoutBase = completePath.replace(new RegExp('^' + basePath), '');\n  return Meteor.absoluteUrl(pathWithoutBase);\n};\n\n//////////////////////////////////////////////////////////////////////////////////////\n\n}}}}}},{\n  \"extensions\": [\n    \".js\",\n    \".json\"\n  ]\n});\n\nrequire(\"/node_modules/meteor/kadira:flow-router/server/router.js\");\nrequire(\"/node_modules/meteor/kadira:flow-router/server/group.js\");\nrequire(\"/node_modules/meteor/kadira:flow-router/server/route.js\");\nrequire(\"/node_modules/meteor/kadira:flow-router/server/_init.js\");\nrequire(\"/node_modules/meteor/kadira:flow-router/server/plugins/fast_render.js\");\nrequire(\"/node_modules/meteor/kadira:flow-router/lib/router.js\");\n\n/* Exports */\nPackage._define(\"kadira:flow-router\", {\n  FlowRouter: FlowRouter\n});\n\n})();\n","servePath":"/packages/kadira_flow-router.js"}]