[{"type":"js","data":"(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\nvar Tracker = Package.tracker.Tracker;\nvar Deps = Package.tracker.Deps;\nvar check = Package.check.check;\nvar Match = Package.check.Match;\nvar ObserveSequence = Package['observe-sequence'].ObserveSequence;\nvar ReactiveVar = Package['reactive-var'].ReactiveVar;\nvar OrderedDict = Package['ordered-dict'].OrderedDict;\nvar ECMAScript = Package.ecmascript.ECMAScript;\nvar HTML = Package.htmljs.HTML;\nvar meteorInstall = Package.modules.meteorInstall;\nvar Promise = Package.promise.Promise;\n\n/* Package-scope variables */\nvar Blaze, UI, Handlebars;\n\nvar require = meteorInstall({\"node_modules\":{\"meteor\":{\"blaze\":{\"preamble.js\":function module(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/blaze/preamble.js                                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n/**\n * @namespace Blaze\n * @summary The namespace for all Blaze-related methods and classes.\n */\nBlaze = {}; // Utility to HTML-escape a string.  Included for legacy reasons.\n// TODO: Should be replaced with _.escape once underscore is upgraded to a newer\n//       version which escapes ` (backtick) as well. Underscore 1.5.2 does not.\n\nBlaze._escape = function () {\n  var escape_map = {\n    \"<\": \"&lt;\",\n    \">\": \"&gt;\",\n    '\"': \"&quot;\",\n    \"'\": \"&#x27;\",\n    \"/\": \"&#x2F;\",\n    \"`\": \"&#x60;\",\n\n    /* IE allows backtick-delimited attributes?? */\n    \"&\": \"&amp;\"\n  };\n\n  var escape_one = function (c) {\n    return escape_map[c];\n  };\n\n  return function (x) {\n    return x.replace(/[&<>\"'`]/g, escape_one);\n  };\n}();\n\nBlaze._warn = function (msg) {\n  msg = 'Warning: ' + msg;\n\n  if (typeof console !== 'undefined' && console.warn) {\n    console.warn(msg);\n  }\n};\n\nvar nativeBind = Function.prototype.bind; // An implementation of _.bind which allows better optimization.\n// See: https://github.com/petkaantonov/bluebird/wiki/Optimization-killers#3-managing-arguments\n\nif (nativeBind) {\n  Blaze._bind = function (func, obj) {\n    if (arguments.length === 2) {\n      return nativeBind.call(func, obj);\n    } // Copy the arguments so this function can be optimized.\n\n\n    var args = new Array(arguments.length);\n\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    return nativeBind.apply(func, args.slice(1));\n  };\n} else {\n  // A slower but backwards compatible version.\n  Blaze._bind = function (objA, objB) {\n    objA.bind(objB);\n  };\n}\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"exceptions.js\":function module(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/blaze/exceptions.js                                                                                        //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nvar debugFunc; // We call into user code in many places, and it's nice to catch exceptions\n// propagated from user code immediately so that the whole system doesn't just\n// break.  Catching exceptions is easy; reporting them is hard.  This helper\n// reports exceptions.\n//\n// Usage:\n//\n// ```\n// try {\n//   // ... someStuff ...\n// } catch (e) {\n//   reportUIException(e);\n// }\n// ```\n//\n// An optional second argument overrides the default message.\n// Set this to `true` to cause `reportException` to throw\n// the next exception rather than reporting it.  This is\n// useful in unit tests that test error messages.\n\nBlaze._throwNextException = false;\n\nBlaze._reportException = function (e, msg) {\n  if (Blaze._throwNextException) {\n    Blaze._throwNextException = false;\n    throw e;\n  }\n\n  if (!debugFunc) // adapted from Tracker\n    debugFunc = function () {\n      return typeof Meteor !== \"undefined\" ? Meteor._debug : typeof console !== \"undefined\" && console.log ? console.log : function () {};\n    }; // In Chrome, `e.stack` is a multiline string that starts with the message\n  // and contains a stack trace.  Furthermore, `console.log` makes it clickable.\n  // `console.log` supplies the space between the two arguments.\n\n  debugFunc()(msg || 'Exception caught in template:', e.stack || e.message || e);\n};\n\nBlaze._wrapCatchingExceptions = function (f, where) {\n  if (typeof f !== 'function') return f;\n  return function () {\n    try {\n      return f.apply(this, arguments);\n    } catch (e) {\n      Blaze._reportException(e, 'Exception in ' + where + ':');\n    }\n  };\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"view.js\":function module(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/blaze/view.js                                                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n/// [new] Blaze.View([name], renderMethod)\n///\n/// Blaze.View is the building block of reactive DOM.  Views have\n/// the following features:\n///\n/// * lifecycle callbacks - Views are created, rendered, and destroyed,\n///   and callbacks can be registered to fire when these things happen.\n///\n/// * parent pointer - A View points to its parentView, which is the\n///   View that caused it to be rendered.  These pointers form a\n///   hierarchy or tree of Views.\n///\n/// * render() method - A View's render() method specifies the DOM\n///   (or HTML) content of the View.  If the method establishes\n///   reactive dependencies, it may be re-run.\n///\n/// * a DOMRange - If a View is rendered to DOM, its position and\n///   extent in the DOM are tracked using a DOMRange object.\n///\n/// When a View is constructed by calling Blaze.View, the View is\n/// not yet considered \"created.\"  It doesn't have a parentView yet,\n/// and no logic has been run to initialize the View.  All real\n/// work is deferred until at least creation time, when the onViewCreated\n/// callbacks are fired, which happens when the View is \"used\" in\n/// some way that requires it to be rendered.\n///\n/// ...more lifecycle stuff\n///\n/// `name` is an optional string tag identifying the View.  The only\n/// time it's used is when looking in the View tree for a View of a\n/// particular name; for example, data contexts are stored on Views\n/// of name \"with\".  Names are also useful when debugging, so in\n/// general it's good for functions that create Views to set the name.\n/// Views associated with templates have names of the form \"Template.foo\".\n\n/**\n * @class\n * @summary Constructor for a View, which represents a reactive region of DOM.\n * @locus Client\n * @param {String} [name] Optional.  A name for this type of View.  See [`view.name`](#view_name).\n * @param {Function} renderFunction A function that returns [*renderable content*](#Renderable-Content).  In this function, `this` is bound to the View.\n */\nBlaze.View = function (name, render) {\n  if (!(this instanceof Blaze.View)) // called without `new`\n    return new Blaze.View(name, render);\n\n  if (typeof name === 'function') {\n    // omitted \"name\" argument\n    render = name;\n    name = '';\n  }\n\n  this.name = name;\n  this._render = render;\n  this._callbacks = {\n    created: null,\n    rendered: null,\n    destroyed: null\n  }; // Setting all properties here is good for readability,\n  // and also may help Chrome optimize the code by keeping\n  // the View object from changing shape too much.\n\n  this.isCreated = false;\n  this._isCreatedForExpansion = false;\n  this.isRendered = false;\n  this._isAttached = false;\n  this.isDestroyed = false;\n  this._isInRender = false;\n  this.parentView = null;\n  this._domrange = null; // This flag is normally set to false except for the cases when view's parent\n  // was generated as part of expanding some syntactic sugar expressions or\n  // methods.\n  // Ex.: Blaze.renderWithData is an equivalent to creating a view with regular\n  // Blaze.render and wrapping it into {{#with data}}{{/with}} view. Since the\n  // users don't know anything about these generated parent views, Blaze needs\n  // this information to be available on views to make smarter decisions. For\n  // example: removing the generated parent view with the view on Blaze.remove.\n\n  this._hasGeneratedParent = false; // Bindings accessible to children views (via view.lookup('name')) within the\n  // closest template view.\n\n  this._scopeBindings = {};\n  this.renderCount = 0;\n};\n\nBlaze.View.prototype._render = function () {\n  return null;\n};\n\nBlaze.View.prototype.onViewCreated = function (cb) {\n  this._callbacks.created = this._callbacks.created || [];\n\n  this._callbacks.created.push(cb);\n};\n\nBlaze.View.prototype._onViewRendered = function (cb) {\n  this._callbacks.rendered = this._callbacks.rendered || [];\n\n  this._callbacks.rendered.push(cb);\n};\n\nBlaze.View.prototype.onViewReady = function (cb) {\n  var self = this;\n\n  var fire = function () {\n    Tracker.afterFlush(function () {\n      if (!self.isDestroyed) {\n        Blaze._withCurrentView(self, function () {\n          cb.call(self);\n        });\n      }\n    });\n  };\n\n  self._onViewRendered(function onViewRendered() {\n    if (self.isDestroyed) return;\n    if (!self._domrange.attached) self._domrange.onAttached(fire);else fire();\n  });\n};\n\nBlaze.View.prototype.onViewDestroyed = function (cb) {\n  this._callbacks.destroyed = this._callbacks.destroyed || [];\n\n  this._callbacks.destroyed.push(cb);\n};\n\nBlaze.View.prototype.removeViewDestroyedListener = function (cb) {\n  var destroyed = this._callbacks.destroyed;\n  if (!destroyed) return;\n  var index = destroyed.lastIndexOf(cb);\n\n  if (index !== -1) {\n    // XXX You'd think the right thing to do would be splice, but _fireCallbacks\n    // gets sad if you remove callbacks while iterating over the list.  Should\n    // change this to use callback-hook or EventEmitter or something else that\n    // properly supports removal.\n    destroyed[index] = null;\n  }\n}; /// View#autorun(func)\n///\n/// Sets up a Tracker autorun that is \"scoped\" to this View in two\n/// important ways: 1) Blaze.currentView is automatically set\n/// on every re-run, and 2) the autorun is stopped when the\n/// View is destroyed.  As with Tracker.autorun, the first run of\n/// the function is immediate, and a Computation object that can\n/// be used to stop the autorun is returned.\n///\n/// View#autorun is meant to be called from View callbacks like\n/// onViewCreated, or from outside the rendering process.  It may not\n/// be called before the onViewCreated callbacks are fired (too early),\n/// or from a render() method (too confusing).\n///\n/// Typically, autoruns that update the state\n/// of the View (as in Blaze.With) should be started from an onViewCreated\n/// callback.  Autoruns that update the DOM should be started\n/// from either onViewCreated (guarded against the absence of\n/// view._domrange), or onViewReady.\n\n\nBlaze.View.prototype.autorun = function (f, _inViewScope, displayName) {\n  var self = this; // The restrictions on when View#autorun can be called are in order\n  // to avoid bad patterns, like creating a Blaze.View and immediately\n  // calling autorun on it.  A freshly created View is not ready to\n  // have logic run on it; it doesn't have a parentView, for example.\n  // It's when the View is materialized or expanded that the onViewCreated\n  // handlers are fired and the View starts up.\n  //\n  // Letting the render() method call `this.autorun()` is problematic\n  // because of re-render.  The best we can do is to stop the old\n  // autorun and start a new one for each render, but that's a pattern\n  // we try to avoid internally because it leads to helpers being\n  // called extra times, in the case where the autorun causes the\n  // view to re-render (and thus the autorun to be torn down and a\n  // new one established).\n  //\n  // We could lift these restrictions in various ways.  One interesting\n  // idea is to allow you to call `view.autorun` after instantiating\n  // `view`, and automatically wrap it in `view.onViewCreated`, deferring\n  // the autorun so that it starts at an appropriate time.  However,\n  // then we can't return the Computation object to the caller, because\n  // it doesn't exist yet.\n\n  if (!self.isCreated) {\n    throw new Error(\"View#autorun must be called from the created callback at the earliest\");\n  }\n\n  if (this._isInRender) {\n    throw new Error(\"Can't call View#autorun from inside render(); try calling it from the created or rendered callback\");\n  }\n\n  var templateInstanceFunc = Blaze.Template._currentTemplateInstanceFunc;\n\n  var func = function viewAutorun(c) {\n    return Blaze._withCurrentView(_inViewScope || self, function () {\n      return Blaze.Template._withTemplateInstanceFunc(templateInstanceFunc, function () {\n        return f.call(self, c);\n      });\n    });\n  }; // Give the autorun function a better name for debugging and profiling.\n  // The `displayName` property is not part of the spec but browsers like Chrome\n  // and Firefox prefer it in debuggers over the name function was declared by.\n\n\n  func.displayName = (self.name || 'anonymous') + ':' + (displayName || 'anonymous');\n  var comp = Tracker.autorun(func);\n\n  var stopComputation = function () {\n    comp.stop();\n  };\n\n  self.onViewDestroyed(stopComputation);\n  comp.onStop(function () {\n    self.removeViewDestroyedListener(stopComputation);\n  });\n  return comp;\n};\n\nBlaze.View.prototype._errorIfShouldntCallSubscribe = function () {\n  var self = this;\n\n  if (!self.isCreated) {\n    throw new Error(\"View#subscribe must be called from the created callback at the earliest\");\n  }\n\n  if (self._isInRender) {\n    throw new Error(\"Can't call View#subscribe from inside render(); try calling it from the created or rendered callback\");\n  }\n\n  if (self.isDestroyed) {\n    throw new Error(\"Can't call View#subscribe from inside the destroyed callback, try calling it inside created or rendered.\");\n  }\n};\n/**\n * Just like Blaze.View#autorun, but with Meteor.subscribe instead of\n * Tracker.autorun. Stop the subscription when the view is destroyed.\n * @return {SubscriptionHandle} A handle to the subscription so that you can\n * see if it is ready, or stop it manually\n */\n\n\nBlaze.View.prototype.subscribe = function (args, options) {\n  var self = this;\n  options = options || {};\n\n  self._errorIfShouldntCallSubscribe();\n\n  var subHandle;\n\n  if (options.connection) {\n    subHandle = options.connection.subscribe.apply(options.connection, args);\n  } else {\n    subHandle = Meteor.subscribe.apply(Meteor, args);\n  }\n\n  self.onViewDestroyed(function () {\n    subHandle.stop();\n  });\n  return subHandle;\n};\n\nBlaze.View.prototype.firstNode = function () {\n  if (!this._isAttached) throw new Error(\"View must be attached before accessing its DOM\");\n  return this._domrange.firstNode();\n};\n\nBlaze.View.prototype.lastNode = function () {\n  if (!this._isAttached) throw new Error(\"View must be attached before accessing its DOM\");\n  return this._domrange.lastNode();\n};\n\nBlaze._fireCallbacks = function (view, which) {\n  Blaze._withCurrentView(view, function () {\n    Tracker.nonreactive(function fireCallbacks() {\n      var cbs = view._callbacks[which];\n\n      for (var i = 0, N = cbs && cbs.length; i < N; i++) cbs[i] && cbs[i].call(view);\n    });\n  });\n};\n\nBlaze._createView = function (view, parentView, forExpansion) {\n  if (view.isCreated) throw new Error(\"Can't render the same View twice\");\n  view.parentView = parentView || null;\n  view.isCreated = true;\n  if (forExpansion) view._isCreatedForExpansion = true;\n\n  Blaze._fireCallbacks(view, 'created');\n};\n\nvar doFirstRender = function (view, initialContent) {\n  var domrange = new Blaze._DOMRange(initialContent);\n  view._domrange = domrange;\n  domrange.view = view;\n  view.isRendered = true;\n\n  Blaze._fireCallbacks(view, 'rendered');\n\n  var teardownHook = null;\n  domrange.onAttached(function attached(range, element) {\n    view._isAttached = true;\n    teardownHook = Blaze._DOMBackend.Teardown.onElementTeardown(element, function teardown() {\n      Blaze._destroyView(view, true\n      /* _skipNodes */\n      );\n    });\n  }); // tear down the teardown hook\n\n  view.onViewDestroyed(function () {\n    teardownHook && teardownHook.stop();\n    teardownHook = null;\n  });\n  return domrange;\n}; // Take an uncreated View `view` and create and render it to DOM,\n// setting up the autorun that updates the View.  Returns a new\n// DOMRange, which has been associated with the View.\n//\n// The private arguments `_workStack` and `_intoArray` are passed in\n// by Blaze._materializeDOM and are only present for recursive calls\n// (when there is some other _materializeView on the stack).  If\n// provided, then we avoid the mutual recursion of calling back into\n// Blaze._materializeDOM so that deep View hierarchies don't blow the\n// stack.  Instead, we push tasks onto workStack for the initial\n// rendering and subsequent setup of the View, and they are done after\n// we return.  When there is a _workStack, we do not return the new\n// DOMRange, but instead push it into _intoArray from a _workStack\n// task.\n\n\nBlaze._materializeView = function (view, parentView, _workStack, _intoArray) {\n  Blaze._createView(view, parentView);\n\n  var domrange;\n  var lastHtmljs; // We don't expect to be called in a Computation, but just in case,\n  // wrap in Tracker.nonreactive.\n\n  Tracker.nonreactive(function () {\n    view.autorun(function doRender(c) {\n      // `view.autorun` sets the current view.\n      view.renderCount++;\n      view._isInRender = true; // Any dependencies that should invalidate this Computation come\n      // from this line:\n\n      var htmljs = view._render();\n\n      view._isInRender = false;\n\n      if (!c.firstRun && !Blaze._isContentEqual(lastHtmljs, htmljs)) {\n        Tracker.nonreactive(function doMaterialize() {\n          // re-render\n          var rangesAndNodes = Blaze._materializeDOM(htmljs, [], view);\n\n          domrange.setMembers(rangesAndNodes);\n\n          Blaze._fireCallbacks(view, 'rendered');\n        });\n      }\n\n      lastHtmljs = htmljs; // Causes any nested views to stop immediately, not when we call\n      // `setMembers` the next time around the autorun.  Otherwise,\n      // helpers in the DOM tree to be replaced might be scheduled\n      // to re-run before we have a chance to stop them.\n\n      Tracker.onInvalidate(function () {\n        if (domrange) {\n          domrange.destroyMembers();\n        }\n      });\n    }, undefined, 'materialize'); // first render.  lastHtmljs is the first htmljs.\n\n    var initialContents;\n\n    if (!_workStack) {\n      initialContents = Blaze._materializeDOM(lastHtmljs, [], view);\n      domrange = doFirstRender(view, initialContents);\n      initialContents = null; // help GC because we close over this scope a lot\n    } else {\n      // We're being called from Blaze._materializeDOM, so to avoid\n      // recursion and save stack space, provide a description of the\n      // work to be done instead of doing it.  Tasks pushed onto\n      // _workStack will be done in LIFO order after we return.\n      // The work will still be done within a Tracker.nonreactive,\n      // because it will be done by some call to Blaze._materializeDOM\n      // (which is always called in a Tracker.nonreactive).\n      initialContents = []; // push this function first so that it happens last\n\n      _workStack.push(function () {\n        domrange = doFirstRender(view, initialContents);\n        initialContents = null; // help GC because of all the closures here\n\n        _intoArray.push(domrange);\n      }); // now push the task that calculates initialContents\n\n\n      _workStack.push(Blaze._bind(Blaze._materializeDOM, null, lastHtmljs, initialContents, view, _workStack));\n    }\n  });\n\n  if (!_workStack) {\n    return domrange;\n  } else {\n    return null;\n  }\n}; // Expands a View to HTMLjs, calling `render` recursively on all\n// Views and evaluating any dynamic attributes.  Calls the `created`\n// callback, but not the `materialized` or `rendered` callbacks.\n// Destroys the view immediately, unless called in a Tracker Computation,\n// in which case the view will be destroyed when the Computation is\n// invalidated.  If called in a Tracker Computation, the result is a\n// reactive string; that is, the Computation will be invalidated\n// if any changes are made to the view or subviews that might affect\n// the HTML.\n\n\nBlaze._expandView = function (view, parentView) {\n  Blaze._createView(view, parentView, true\n  /*forExpansion*/\n  );\n\n  view._isInRender = true;\n\n  var htmljs = Blaze._withCurrentView(view, function () {\n    return view._render();\n  });\n\n  view._isInRender = false;\n\n  var result = Blaze._expand(htmljs, view);\n\n  if (Tracker.active) {\n    Tracker.onInvalidate(function () {\n      Blaze._destroyView(view);\n    });\n  } else {\n    Blaze._destroyView(view);\n  }\n\n  return result;\n}; // Options: `parentView`\n\n\nBlaze._HTMLJSExpander = HTML.TransformingVisitor.extend();\n\nBlaze._HTMLJSExpander.def({\n  visitObject: function (x) {\n    if (x instanceof Blaze.Template) x = x.constructView();\n    if (x instanceof Blaze.View) return Blaze._expandView(x, this.parentView); // this will throw an error; other objects are not allowed!\n\n    return HTML.TransformingVisitor.prototype.visitObject.call(this, x);\n  },\n  visitAttributes: function (attrs) {\n    // expand dynamic attributes\n    if (typeof attrs === 'function') attrs = Blaze._withCurrentView(this.parentView, attrs); // call super (e.g. for case where `attrs` is an array)\n\n    return HTML.TransformingVisitor.prototype.visitAttributes.call(this, attrs);\n  },\n  visitAttribute: function (name, value, tag) {\n    // expand attribute values that are functions.  Any attribute value\n    // that contains Views must be wrapped in a function.\n    if (typeof value === 'function') value = Blaze._withCurrentView(this.parentView, value);\n    return HTML.TransformingVisitor.prototype.visitAttribute.call(this, name, value, tag);\n  }\n}); // Return Blaze.currentView, but only if it is being rendered\n// (i.e. we are in its render() method).\n\n\nvar currentViewIfRendering = function () {\n  var view = Blaze.currentView;\n  return view && view._isInRender ? view : null;\n};\n\nBlaze._expand = function (htmljs, parentView) {\n  parentView = parentView || currentViewIfRendering();\n  return new Blaze._HTMLJSExpander({\n    parentView: parentView\n  }).visit(htmljs);\n};\n\nBlaze._expandAttributes = function (attrs, parentView) {\n  parentView = parentView || currentViewIfRendering();\n  return new Blaze._HTMLJSExpander({\n    parentView: parentView\n  }).visitAttributes(attrs);\n};\n\nBlaze._destroyView = function (view, _skipNodes) {\n  if (view.isDestroyed) return;\n  view.isDestroyed = true;\n\n  Blaze._fireCallbacks(view, 'destroyed'); // Destroy views and elements recursively.  If _skipNodes,\n  // only recurse up to views, not elements, for the case where\n  // the backend (jQuery) is recursing over the elements already.\n\n\n  if (view._domrange) view._domrange.destroyMembers(_skipNodes);\n};\n\nBlaze._destroyNode = function (node) {\n  if (node.nodeType === 1) Blaze._DOMBackend.Teardown.tearDownElement(node);\n}; // Are the HTMLjs entities `a` and `b` the same?  We could be\n// more elaborate here but the point is to catch the most basic\n// cases.\n\n\nBlaze._isContentEqual = function (a, b) {\n  if (a instanceof HTML.Raw) {\n    return b instanceof HTML.Raw && a.value === b.value;\n  } else if (a == null) {\n    return b == null;\n  } else {\n    return a === b && (typeof a === 'number' || typeof a === 'boolean' || typeof a === 'string');\n  }\n};\n/**\n * @summary The View corresponding to the current template helper, event handler, callback, or autorun.  If there isn't one, `null`.\n * @locus Client\n * @type {Blaze.View}\n */\n\n\nBlaze.currentView = null;\n\nBlaze._withCurrentView = function (view, func) {\n  var oldView = Blaze.currentView;\n\n  try {\n    Blaze.currentView = view;\n    return func();\n  } finally {\n    Blaze.currentView = oldView;\n  }\n}; // Blaze.render publicly takes a View or a Template.\n// Privately, it takes any HTMLJS (extended with Views and Templates)\n// except null or undefined, or a function that returns any extended\n// HTMLJS.\n\n\nvar checkRenderContent = function (content) {\n  if (content === null) throw new Error(\"Can't render null\");\n  if (typeof content === 'undefined') throw new Error(\"Can't render undefined\");\n  if (content instanceof Blaze.View || content instanceof Blaze.Template || typeof content === 'function') return;\n\n  try {\n    // Throw if content doesn't look like HTMLJS at the top level\n    // (i.e. verify that this is an HTML.Tag, or an array,\n    // or a primitive, etc.)\n    new HTML.Visitor().visit(content);\n  } catch (e) {\n    // Make error message suitable for public API\n    throw new Error(\"Expected Template or View\");\n  }\n}; // For Blaze.render and Blaze.toHTML, take content and\n// wrap it in a View, unless it's a single View or\n// Template already.\n\n\nvar contentAsView = function (content) {\n  checkRenderContent(content);\n\n  if (content instanceof Blaze.Template) {\n    return content.constructView();\n  } else if (content instanceof Blaze.View) {\n    return content;\n  } else {\n    var func = content;\n\n    if (typeof func !== 'function') {\n      func = function () {\n        return content;\n      };\n    }\n\n    return Blaze.View('render', func);\n  }\n}; // For Blaze.renderWithData and Blaze.toHTMLWithData, wrap content\n// in a function, if necessary, so it can be a content arg to\n// a Blaze.With.\n\n\nvar contentAsFunc = function (content) {\n  checkRenderContent(content);\n\n  if (typeof content !== 'function') {\n    return function () {\n      return content;\n    };\n  } else {\n    return content;\n  }\n};\n\nBlaze.__rootViews = [];\n/**\n * @summary Renders a template or View to DOM nodes and inserts it into the DOM, returning a rendered [View](#Blaze-View) which can be passed to [`Blaze.remove`](#Blaze-remove).\n * @locus Client\n * @param {Template|Blaze.View} templateOrView The template (e.g. `Template.myTemplate`) or View object to render.  If a template, a View object is [constructed](#template_constructview).  If a View, it must be an unrendered View, which becomes a rendered View and is returned.\n * @param {DOMNode} parentNode The node that will be the parent of the rendered template.  It must be an Element node.\n * @param {DOMNode} [nextNode] Optional. If provided, must be a child of <em>parentNode</em>; the template will be inserted before this node. If not provided, the template will be inserted as the last child of parentNode.\n * @param {Blaze.View} [parentView] Optional. If provided, it will be set as the rendered View's [`parentView`](#view_parentview).\n */\n\nBlaze.render = function (content, parentElement, nextNode, parentView) {\n  if (!parentElement) {\n    Blaze._warn(\"Blaze.render without a parent element is deprecated. \" + \"You must specify where to insert the rendered content.\");\n  }\n\n  if (nextNode instanceof Blaze.View) {\n    // handle omitted nextNode\n    parentView = nextNode;\n    nextNode = null;\n  } // parentElement must be a DOM node. in particular, can't be the\n  // result of a call to `$`. Can't check if `parentElement instanceof\n  // Node` since 'Node' is undefined in IE8.\n\n\n  if (parentElement && typeof parentElement.nodeType !== 'number') throw new Error(\"'parentElement' must be a DOM node\");\n  if (nextNode && typeof nextNode.nodeType !== 'number') // 'nextNode' is optional\n    throw new Error(\"'nextNode' must be a DOM node\");\n  parentView = parentView || currentViewIfRendering();\n  var view = contentAsView(content); // TODO: this is only needed in development\n\n  if (!parentView) {\n    view.onViewCreated(function () {\n      Blaze.__rootViews.push(view);\n    });\n    view.onViewDestroyed(function () {\n      var index = Blaze.__rootViews.indexOf(view);\n\n      if (index > -1) {\n        Blaze.__rootViews.splice(index, 1);\n      }\n    });\n  }\n\n  Blaze._materializeView(view, parentView);\n\n  if (parentElement) {\n    view._domrange.attach(parentElement, nextNode);\n  }\n\n  return view;\n};\n\nBlaze.insert = function (view, parentElement, nextNode) {\n  Blaze._warn(\"Blaze.insert has been deprecated.  Specify where to insert the \" + \"rendered content in the call to Blaze.render.\");\n\n  if (!(view && view._domrange instanceof Blaze._DOMRange)) throw new Error(\"Expected template rendered with Blaze.render\");\n\n  view._domrange.attach(parentElement, nextNode);\n};\n/**\n * @summary Renders a template or View to DOM nodes with a data context.  Otherwise identical to `Blaze.render`.\n * @locus Client\n * @param {Template|Blaze.View} templateOrView The template (e.g. `Template.myTemplate`) or View object to render.\n * @param {Object|Function} data The data context to use, or a function returning a data context.  If a function is provided, it will be reactively re-run.\n * @param {DOMNode} parentNode The node that will be the parent of the rendered template.  It must be an Element node.\n * @param {DOMNode} [nextNode] Optional. If provided, must be a child of <em>parentNode</em>; the template will be inserted before this node. If not provided, the template will be inserted as the last child of parentNode.\n * @param {Blaze.View} [parentView] Optional. If provided, it will be set as the rendered View's [`parentView`](#view_parentview).\n */\n\n\nBlaze.renderWithData = function (content, data, parentElement, nextNode, parentView) {\n  // We defer the handling of optional arguments to Blaze.render.  At this point,\n  // `nextNode` may actually be `parentView`.\n  return Blaze.render(Blaze._TemplateWith(data, contentAsFunc(content)), parentElement, nextNode, parentView);\n};\n/**\n * @summary Removes a rendered View from the DOM, stopping all reactive updates and event listeners on it. Also destroys the Blaze.Template instance associated with the view.\n * @locus Client\n * @param {Blaze.View} renderedView The return value from `Blaze.render` or `Blaze.renderWithData`, or the `view` property of a Blaze.Template instance. Calling `Blaze.remove(Template.instance().view)` from within a template event handler will destroy the view as well as that template and trigger the template's `onDestroyed` handlers.\n */\n\n\nBlaze.remove = function (view) {\n  if (!(view && view._domrange instanceof Blaze._DOMRange)) throw new Error(\"Expected template rendered with Blaze.render\");\n\n  while (view) {\n    if (!view.isDestroyed) {\n      var range = view._domrange;\n      if (range.attached && !range.parentRange) range.detach();\n      range.destroy();\n    }\n\n    view = view._hasGeneratedParent && view.parentView;\n  }\n};\n/**\n * @summary Renders a template or View to a string of HTML.\n * @locus Client\n * @param {Template|Blaze.View} templateOrView The template (e.g. `Template.myTemplate`) or View object from which to generate HTML.\n */\n\n\nBlaze.toHTML = function (content, parentView) {\n  parentView = parentView || currentViewIfRendering();\n  return HTML.toHTML(Blaze._expandView(contentAsView(content), parentView));\n};\n/**\n * @summary Renders a template or View to HTML with a data context.  Otherwise identical to `Blaze.toHTML`.\n * @locus Client\n * @param {Template|Blaze.View} templateOrView The template (e.g. `Template.myTemplate`) or View object from which to generate HTML.\n * @param {Object|Function} data The data context to use, or a function returning a data context.\n */\n\n\nBlaze.toHTMLWithData = function (content, data, parentView) {\n  parentView = parentView || currentViewIfRendering();\n  return HTML.toHTML(Blaze._expandView(Blaze._TemplateWith(data, contentAsFunc(content)), parentView));\n};\n\nBlaze._toText = function (htmljs, parentView, textMode) {\n  if (typeof htmljs === 'function') throw new Error(\"Blaze._toText doesn't take a function, just HTMLjs\");\n\n  if (parentView != null && !(parentView instanceof Blaze.View)) {\n    // omitted parentView argument\n    textMode = parentView;\n    parentView = null;\n  }\n\n  parentView = parentView || currentViewIfRendering();\n  if (!textMode) throw new Error(\"textMode required\");\n  if (!(textMode === HTML.TEXTMODE.STRING || textMode === HTML.TEXTMODE.RCDATA || textMode === HTML.TEXTMODE.ATTRIBUTE)) throw new Error(\"Unknown textMode: \" + textMode);\n  return HTML.toText(Blaze._expand(htmljs, parentView), textMode);\n};\n/**\n * @summary Returns the current data context, or the data context that was used when rendering a particular DOM element or View from a Meteor template.\n * @locus Client\n * @param {DOMElement|Blaze.View} [elementOrView] Optional.  An element that was rendered by a Meteor, or a View.\n */\n\n\nBlaze.getData = function (elementOrView) {\n  var theWith;\n\n  if (!elementOrView) {\n    theWith = Blaze.getView('with');\n  } else if (elementOrView instanceof Blaze.View) {\n    var view = elementOrView;\n    theWith = view.name === 'with' ? view : Blaze.getView(view, 'with');\n  } else if (typeof elementOrView.nodeType === 'number') {\n    if (elementOrView.nodeType !== 1) throw new Error(\"Expected DOM element\");\n    theWith = Blaze.getView(elementOrView, 'with');\n  } else {\n    throw new Error(\"Expected DOM element or View\");\n  }\n\n  return theWith ? theWith.dataVar.get() : null;\n}; // For back-compat\n\n\nBlaze.getElementData = function (element) {\n  Blaze._warn(\"Blaze.getElementData has been deprecated.  Use \" + \"Blaze.getData(element) instead.\");\n\n  if (element.nodeType !== 1) throw new Error(\"Expected DOM element\");\n  return Blaze.getData(element);\n}; // Both arguments are optional.\n\n/**\n * @summary Gets either the current View, or the View enclosing the given DOM element.\n * @locus Client\n * @param {DOMElement} [element] Optional.  If specified, the View enclosing `element` is returned.\n */\n\n\nBlaze.getView = function (elementOrView, _viewName) {\n  var viewName = _viewName;\n\n  if (typeof elementOrView === 'string') {\n    // omitted elementOrView; viewName present\n    viewName = elementOrView;\n    elementOrView = null;\n  } // We could eventually shorten the code by folding the logic\n  // from the other methods into this method.\n\n\n  if (!elementOrView) {\n    return Blaze._getCurrentView(viewName);\n  } else if (elementOrView instanceof Blaze.View) {\n    return Blaze._getParentView(elementOrView, viewName);\n  } else if (typeof elementOrView.nodeType === 'number') {\n    return Blaze._getElementView(elementOrView, viewName);\n  } else {\n    throw new Error(\"Expected DOM element or View\");\n  }\n}; // Gets the current view or its nearest ancestor of name\n// `name`.\n\n\nBlaze._getCurrentView = function (name) {\n  var view = Blaze.currentView; // Better to fail in cases where it doesn't make sense\n  // to use Blaze._getCurrentView().  There will be a current\n  // view anywhere it does.  You can check Blaze.currentView\n  // if you want to know whether there is one or not.\n\n  if (!view) throw new Error(\"There is no current view\");\n\n  if (name) {\n    while (view && view.name !== name) view = view.parentView;\n\n    return view || null;\n  } else {\n    // Blaze._getCurrentView() with no arguments just returns\n    // Blaze.currentView.\n    return view;\n  }\n};\n\nBlaze._getParentView = function (view, name) {\n  var v = view.parentView;\n\n  if (name) {\n    while (v && v.name !== name) v = v.parentView;\n  }\n\n  return v || null;\n};\n\nBlaze._getElementView = function (elem, name) {\n  var range = Blaze._DOMRange.forElement(elem);\n\n  var view = null;\n\n  while (range && !view) {\n    view = range.view || null;\n\n    if (!view) {\n      if (range.parentRange) range = range.parentRange;else range = Blaze._DOMRange.forElement(range.parentElement);\n    }\n  }\n\n  if (name) {\n    while (view && view.name !== name) view = view.parentView;\n\n    return view || null;\n  } else {\n    return view;\n  }\n};\n\nBlaze._addEventMap = function (view, eventMap, thisInHandler) {\n  thisInHandler = thisInHandler || null;\n  var handles = [];\n  if (!view._domrange) throw new Error(\"View must have a DOMRange\");\n\n  view._domrange.onAttached(function attached_eventMaps(range, element) {\n    Object.keys(eventMap).forEach(function (spec) {\n      let handler = eventMap[spec];\n      var clauses = spec.split(/,\\s+/); // iterate over clauses of spec, e.g. ['click .foo', 'click .bar']\n\n      clauses.forEach(function (clause) {\n        var parts = clause.split(/\\s+/);\n        if (parts.length === 0) return;\n        var newEvents = parts.shift();\n        var selector = parts.join(' ');\n        handles.push(Blaze._EventSupport.listen(element, newEvents, selector, function (evt) {\n          if (!range.containsElement(evt.currentTarget)) return null;\n          var handlerThis = thisInHandler || this;\n          var handlerArgs = arguments;\n          return Blaze._withCurrentView(view, function () {\n            return handler.apply(handlerThis, handlerArgs);\n          });\n        }, range, function (r) {\n          return r.parentRange;\n        }));\n      });\n    });\n  });\n\n  view.onViewDestroyed(function () {\n    handles.forEach(function (h) {\n      h.stop();\n    });\n    handles.length = 0;\n  });\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"builtins.js\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/blaze/builtins.js                                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet has;\nmodule.link(\"lodash.has\", {\n  default(v) {\n    has = v;\n  }\n\n}, 0);\nlet isObject;\nmodule.link(\"lodash.isobject\", {\n  default(v) {\n    isObject = v;\n  }\n\n}, 1);\n\nBlaze._calculateCondition = function (cond) {\n  if (HTML.isArray(cond) && cond.length === 0) cond = false;\n  return !!cond;\n};\n/**\n * @summary Constructs a View that renders content with a data context.\n * @locus Client\n * @param {Object|Function} data An object to use as the data context, or a function returning such an object.  If a function is provided, it will be reactively re-run.\n * @param {Function} contentFunc A Function that returns [*renderable content*](#Renderable-Content).\n */\n\n\nBlaze.With = function (data, contentFunc) {\n  var view = Blaze.View('with', contentFunc);\n  view.dataVar = new ReactiveVar();\n  view.onViewCreated(function () {\n    if (typeof data === 'function') {\n      // `data` is a reactive function\n      view.autorun(function () {\n        view.dataVar.set(data());\n      }, view.parentView, 'setData');\n    } else {\n      view.dataVar.set(data);\n    }\n  });\n  return view;\n};\n/**\n * Attaches bindings to the instantiated view.\n * @param {Object} bindings A dictionary of bindings, each binding name\n * corresponds to a value or a function that will be reactively re-run.\n * @param {View} view The target.\n */\n\n\nBlaze._attachBindingsToView = function (bindings, view) {\n  view.onViewCreated(function () {\n    Object.entries(bindings).forEach(function (_ref) {\n      let [name, binding] = _ref;\n      view._scopeBindings[name] = new ReactiveVar();\n\n      if (typeof binding === 'function') {\n        view.autorun(function () {\n          view._scopeBindings[name].set(binding());\n        }, view.parentView);\n      } else {\n        view._scopeBindings[name].set(binding);\n      }\n    });\n  });\n};\n/**\n * @summary Constructs a View setting the local lexical scope in the block.\n * @param {Function} bindings Dictionary mapping names of bindings to\n * values or computations to reactively re-run.\n * @param {Function} contentFunc A Function that returns [*renderable content*](#Renderable-Content).\n */\n\n\nBlaze.Let = function (bindings, contentFunc) {\n  var view = Blaze.View('let', contentFunc);\n\n  Blaze._attachBindingsToView(bindings, view);\n\n  return view;\n};\n/**\n * @summary Constructs a View that renders content conditionally.\n * @locus Client\n * @param {Function} conditionFunc A function to reactively re-run.  Whether the result is truthy or falsy determines whether `contentFunc` or `elseFunc` is shown.  An empty array is considered falsy.\n * @param {Function} contentFunc A Function that returns [*renderable content*](#Renderable-Content).\n * @param {Function} [elseFunc] Optional.  A Function that returns [*renderable content*](#Renderable-Content).  If no `elseFunc` is supplied, no content is shown in the \"else\" case.\n */\n\n\nBlaze.If = function (conditionFunc, contentFunc, elseFunc, _not) {\n  var conditionVar = new ReactiveVar();\n  var view = Blaze.View(_not ? 'unless' : 'if', function () {\n    return conditionVar.get() ? contentFunc() : elseFunc ? elseFunc() : null;\n  });\n  view.__conditionVar = conditionVar;\n  view.onViewCreated(function () {\n    this.autorun(function () {\n      var cond = Blaze._calculateCondition(conditionFunc());\n\n      conditionVar.set(_not ? !cond : cond);\n    }, this.parentView, 'condition');\n  });\n  return view;\n};\n/**\n * @summary An inverted [`Blaze.If`](#Blaze-If).\n * @locus Client\n * @param {Function} conditionFunc A function to reactively re-run.  If the result is falsy, `contentFunc` is shown, otherwise `elseFunc` is shown.  An empty array is considered falsy.\n * @param {Function} contentFunc A Function that returns [*renderable content*](#Renderable-Content).\n * @param {Function} [elseFunc] Optional.  A Function that returns [*renderable content*](#Renderable-Content).  If no `elseFunc` is supplied, no content is shown in the \"else\" case.\n */\n\n\nBlaze.Unless = function (conditionFunc, contentFunc, elseFunc) {\n  return Blaze.If(conditionFunc, contentFunc, elseFunc, true\n  /*_not*/\n  );\n};\n/**\n * @summary Constructs a View that renders `contentFunc` for each item in a sequence.\n * @locus Client\n * @param {Function} argFunc A function to reactively re-run. The function can\n * return one of two options:\n *\n * 1. An object with two fields: '_variable' and '_sequence'. Each iterates over\n *   '_sequence', it may be a Cursor, an array, null, or undefined. Inside the\n *   Each body you will be able to get the current item from the sequence using\n *   the name specified in the '_variable' field.\n *\n * 2. Just a sequence (Cursor, array, null, or undefined) not wrapped into an\n *   object. Inside the Each body, the current item will be set as the data\n *   context.\n * @param {Function} contentFunc A Function that returns  [*renderable\n * content*](#Renderable-Content).\n * @param {Function} [elseFunc] A Function that returns [*renderable\n * content*](#Renderable-Content) to display in the case when there are no items\n * in the sequence.\n */\n\n\nBlaze.Each = function (argFunc, contentFunc, elseFunc) {\n  var eachView = Blaze.View('each', function () {\n    var subviews = this.initialSubviews;\n    this.initialSubviews = null;\n\n    if (this._isCreatedForExpansion) {\n      this.expandedValueDep = new Tracker.Dependency();\n      this.expandedValueDep.depend();\n    }\n\n    return subviews;\n  });\n  eachView.initialSubviews = [];\n  eachView.numItems = 0;\n  eachView.inElseMode = false;\n  eachView.stopHandle = null;\n  eachView.contentFunc = contentFunc;\n  eachView.elseFunc = elseFunc;\n  eachView.argVar = new ReactiveVar();\n  eachView.variableName = null; // update the @index value in the scope of all subviews in the range\n\n  var updateIndices = function (from, to) {\n    if (to === undefined) {\n      to = eachView.numItems - 1;\n    }\n\n    for (var i = from; i <= to; i++) {\n      var view = eachView._domrange.members[i].view;\n\n      view._scopeBindings['@index'].set(i);\n    }\n  };\n\n  eachView.onViewCreated(function () {\n    // We evaluate argFunc in an autorun to make sure\n    // Blaze.currentView is always set when it runs (rather than\n    // passing argFunc straight to ObserveSequence).\n    eachView.autorun(function () {\n      // argFunc can return either a sequence as is or a wrapper object with a\n      // _sequence and _variable fields set.\n      var arg = argFunc();\n\n      if (isObject(arg) && has(arg, '_sequence')) {\n        eachView.variableName = arg._variable || null;\n        arg = arg._sequence;\n      }\n\n      eachView.argVar.set(arg);\n    }, eachView.parentView, 'collection');\n    eachView.stopHandle = ObserveSequence.observe(function () {\n      return eachView.argVar.get();\n    }, {\n      addedAt: function (id, item, index) {\n        Tracker.nonreactive(function () {\n          var newItemView;\n\n          if (eachView.variableName) {\n            // new-style #each (as in {{#each item in items}})\n            // doesn't create a new data context\n            newItemView = Blaze.View('item', eachView.contentFunc);\n          } else {\n            newItemView = Blaze.With(item, eachView.contentFunc);\n          }\n\n          eachView.numItems++;\n          var bindings = {};\n          bindings['@index'] = index;\n\n          if (eachView.variableName) {\n            bindings[eachView.variableName] = item;\n          }\n\n          Blaze._attachBindingsToView(bindings, newItemView);\n\n          if (eachView.expandedValueDep) {\n            eachView.expandedValueDep.changed();\n          } else if (eachView._domrange) {\n            if (eachView.inElseMode) {\n              eachView._domrange.removeMember(0);\n\n              eachView.inElseMode = false;\n            }\n\n            var range = Blaze._materializeView(newItemView, eachView);\n\n            eachView._domrange.addMember(range, index);\n\n            updateIndices(index);\n          } else {\n            eachView.initialSubviews.splice(index, 0, newItemView);\n          }\n        });\n      },\n      removedAt: function (id, item, index) {\n        Tracker.nonreactive(function () {\n          eachView.numItems--;\n\n          if (eachView.expandedValueDep) {\n            eachView.expandedValueDep.changed();\n          } else if (eachView._domrange) {\n            eachView._domrange.removeMember(index);\n\n            updateIndices(index);\n\n            if (eachView.elseFunc && eachView.numItems === 0) {\n              eachView.inElseMode = true;\n\n              eachView._domrange.addMember(Blaze._materializeView(Blaze.View('each_else', eachView.elseFunc), eachView), 0);\n            }\n          } else {\n            eachView.initialSubviews.splice(index, 1);\n          }\n        });\n      },\n      changedAt: function (id, newItem, oldItem, index) {\n        Tracker.nonreactive(function () {\n          if (eachView.expandedValueDep) {\n            eachView.expandedValueDep.changed();\n          } else {\n            var itemView;\n\n            if (eachView._domrange) {\n              itemView = eachView._domrange.getMember(index).view;\n            } else {\n              itemView = eachView.initialSubviews[index];\n            }\n\n            if (eachView.variableName) {\n              itemView._scopeBindings[eachView.variableName].set(newItem);\n            } else {\n              itemView.dataVar.set(newItem);\n            }\n          }\n        });\n      },\n      movedTo: function (id, item, fromIndex, toIndex) {\n        Tracker.nonreactive(function () {\n          if (eachView.expandedValueDep) {\n            eachView.expandedValueDep.changed();\n          } else if (eachView._domrange) {\n            eachView._domrange.moveMember(fromIndex, toIndex);\n\n            updateIndices(Math.min(fromIndex, toIndex), Math.max(fromIndex, toIndex));\n          } else {\n            var subviews = eachView.initialSubviews;\n            var itemView = subviews[fromIndex];\n            subviews.splice(fromIndex, 1);\n            subviews.splice(toIndex, 0, itemView);\n          }\n        });\n      }\n    });\n\n    if (eachView.elseFunc && eachView.numItems === 0) {\n      eachView.inElseMode = true;\n      eachView.initialSubviews[0] = Blaze.View('each_else', eachView.elseFunc);\n    }\n  });\n  eachView.onViewDestroyed(function () {\n    if (eachView.stopHandle) eachView.stopHandle.stop();\n  });\n  return eachView;\n};\n\nBlaze._TemplateWith = function (arg, contentFunc) {\n  var w;\n  var argFunc = arg;\n\n  if (typeof arg !== 'function') {\n    argFunc = function () {\n      return arg;\n    };\n  } // This is a little messy.  When we compile `{{> Template.contentBlock}}`, we\n  // wrap it in Blaze._InOuterTemplateScope in order to skip the intermediate\n  // parent Views in the current template.  However, when there's an argument\n  // (`{{> Template.contentBlock arg}}`), the argument needs to be evaluated\n  // in the original scope.  There's no good order to nest\n  // Blaze._InOuterTemplateScope and Spacebars.TemplateWith to achieve this,\n  // so we wrap argFunc to run it in the \"original parentView\" of the\n  // Blaze._InOuterTemplateScope.\n  //\n  // To make this better, reconsider _InOuterTemplateScope as a primitive.\n  // Longer term, evaluate expressions in the proper lexical scope.\n\n\n  var wrappedArgFunc = function () {\n    var viewToEvaluateArg = null;\n\n    if (w.parentView && w.parentView.name === 'InOuterTemplateScope') {\n      viewToEvaluateArg = w.parentView.originalParentView;\n    }\n\n    if (viewToEvaluateArg) {\n      return Blaze._withCurrentView(viewToEvaluateArg, argFunc);\n    } else {\n      return argFunc();\n    }\n  };\n\n  var wrappedContentFunc = function () {\n    var content = contentFunc.call(this); // Since we are generating the Blaze._TemplateWith view for the\n    // user, set the flag on the child view.  If `content` is a template,\n    // construct the View so that we can set the flag.\n\n    if (content instanceof Blaze.Template) {\n      content = content.constructView();\n    }\n\n    if (content instanceof Blaze.View) {\n      content._hasGeneratedParent = true;\n    }\n\n    return content;\n  };\n\n  w = Blaze.With(wrappedArgFunc, wrappedContentFunc);\n  w.__isTemplateWith = true;\n  return w;\n};\n\nBlaze._InOuterTemplateScope = function (templateView, contentFunc) {\n  var view = Blaze.View('InOuterTemplateScope', contentFunc);\n  var parentView = templateView.parentView; // Hack so that if you call `{{> foo bar}}` and it expands into\n  // `{{#with bar}}{{> foo}}{{/with}}`, and then `foo` is a template\n  // that inserts `{{> Template.contentBlock}}`, the data context for\n  // `Template.contentBlock` is not `bar` but the one enclosing that.\n\n  if (parentView.__isTemplateWith) parentView = parentView.parentView;\n  view.onViewCreated(function () {\n    this.originalParentView = this.parentView;\n    this.parentView = parentView;\n    this.__childDoesntStartNewLexicalScope = true;\n  });\n  return view;\n}; // XXX COMPAT WITH 0.9.0\n\n\nBlaze.InOuterTemplateScope = Blaze._InOuterTemplateScope;\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"lookup.js\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/blaze/lookup.js                                                                                            //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet has;\nmodule.link(\"lodash.has\", {\n  default(v) {\n    has = v;\n  }\n\n}, 0);\nBlaze._globalHelpers = {}; // Documented as Template.registerHelper.\n// This definition also provides back-compat for `UI.registerHelper`.\n\nBlaze.registerHelper = function (name, func) {\n  Blaze._globalHelpers[name] = func;\n}; // Also documented as Template.deregisterHelper\n\n\nBlaze.deregisterHelper = function (name) {\n  delete Blaze._globalHelpers[name];\n};\n\nvar bindIfIsFunction = function (x, target) {\n  if (typeof x !== 'function') return x;\n  return Blaze._bind(x, target);\n}; // If `x` is a function, binds the value of `this` for that function\n// to the current data context.\n\n\nvar bindDataContext = function (x) {\n  if (typeof x === 'function') {\n    return function () {\n      var data = Blaze.getData();\n      if (data == null) data = {};\n      return x.apply(data, arguments);\n    };\n  }\n\n  return x;\n};\n\nBlaze._OLDSTYLE_HELPER = {};\n\nBlaze._getTemplateHelper = function (template, name, tmplInstanceFunc) {\n  // XXX COMPAT WITH 0.9.3\n  var isKnownOldStyleHelper = false;\n\n  if (template.__helpers.has(name)) {\n    var helper = template.__helpers.get(name);\n\n    if (helper === Blaze._OLDSTYLE_HELPER) {\n      isKnownOldStyleHelper = true;\n    } else if (helper != null) {\n      return wrapHelper(bindDataContext(helper), tmplInstanceFunc);\n    } else {\n      return null;\n    }\n  } // old-style helper\n\n\n  if (name in template) {\n    // Only warn once per helper\n    if (!isKnownOldStyleHelper) {\n      template.__helpers.set(name, Blaze._OLDSTYLE_HELPER);\n\n      if (!template._NOWARN_OLDSTYLE_HELPERS) {\n        Blaze._warn('Assigning helper with `' + template.viewName + '.' + name + ' = ...` is deprecated.  Use `' + template.viewName + '.helpers(...)` instead.');\n      }\n    }\n\n    if (template[name] != null) {\n      return wrapHelper(bindDataContext(template[name]), tmplInstanceFunc);\n    }\n  }\n\n  return null;\n};\n\nvar wrapHelper = function (f, templateFunc) {\n  if (typeof f !== \"function\") {\n    return f;\n  }\n\n  return function () {\n    var self = this;\n    var args = arguments;\n    return Blaze.Template._withTemplateInstanceFunc(templateFunc, function () {\n      return Blaze._wrapCatchingExceptions(f, 'template helper').apply(self, args);\n    });\n  };\n};\n\nBlaze._lexicalBindingLookup = function (view, name) {\n  var currentView = view;\n  var blockHelpersStack = []; // walk up the views stopping at a Spacebars.include or Template view that\n  // doesn't have an InOuterTemplateScope view as a parent\n\n  do {\n    // skip block helpers views\n    // if we found the binding on the scope, return it\n    if (has(currentView._scopeBindings, name)) {\n      var bindingReactiveVar = currentView._scopeBindings[name];\n      return function () {\n        return bindingReactiveVar.get();\n      };\n    }\n  } while (!(currentView.__startsNewLexicalScope && !(currentView.parentView && currentView.parentView.__childDoesntStartNewLexicalScope)) && (currentView = currentView.parentView));\n\n  return null;\n}; // templateInstance argument is provided to be available for possible\n// alternative implementations of this function by 3rd party packages.\n\n\nBlaze._getTemplate = function (name, templateInstance) {\n  if (name in Blaze.Template && Blaze.Template[name] instanceof Blaze.Template) {\n    return Blaze.Template[name];\n  }\n\n  return null;\n};\n\nBlaze._getGlobalHelper = function (name, templateInstance) {\n  if (Blaze._globalHelpers[name] != null) {\n    return wrapHelper(bindDataContext(Blaze._globalHelpers[name]), templateInstance);\n  }\n\n  return null;\n}; // Looks up a name, like \"foo\" or \"..\", as a helper of the\n// current template; the name of a template; a global helper;\n// or a property of the data context.  Called on the View of\n// a template (i.e. a View with a `.template` property,\n// where the helpers are).  Used for the first name in a\n// \"path\" in a template tag, like \"foo\" in `{{foo.bar}}` or\n// \"..\" in `{{frobulate ../blah}}`.\n//\n// Returns a function, a non-function value, or null.  If\n// a function is found, it is bound appropriately.\n//\n// NOTE: This function must not establish any reactive\n// dependencies itself.  If there is any reactivity in the\n// value, lookup should return a function.\n\n\nBlaze.View.prototype.lookup = function (name, _options) {\n  var template = this.template;\n  var lookupTemplate = _options && _options.template;\n  var helper;\n  var binding;\n  var boundTmplInstance;\n  var foundTemplate;\n\n  if (this.templateInstance) {\n    boundTmplInstance = Blaze._bind(this.templateInstance, this);\n  } // 0. looking up the parent data context with the special \"../\" syntax\n\n\n  if (/^\\./.test(name)) {\n    // starts with a dot. must be a series of dots which maps to an\n    // ancestor of the appropriate height.\n    if (!/^(\\.)+$/.test(name)) throw new Error(\"id starting with dot must be a series of dots\");\n    return Blaze._parentData(name.length - 1, true\n    /*_functionWrapped*/\n    );\n  } // 1. look up a helper on the current template\n\n\n  if (template && (helper = Blaze._getTemplateHelper(template, name, boundTmplInstance)) != null) {\n    return helper;\n  } // 2. look up a binding by traversing the lexical view hierarchy inside the\n  // current template\n\n\n  if (template && (binding = Blaze._lexicalBindingLookup(Blaze.currentView, name)) != null) {\n    return binding;\n  } // 3. look up a template by name\n\n\n  if (lookupTemplate && (foundTemplate = Blaze._getTemplate(name, boundTmplInstance)) != null) {\n    return foundTemplate;\n  } // 4. look up a global helper\n\n\n  if ((helper = Blaze._getGlobalHelper(name, boundTmplInstance)) != null) {\n    return helper;\n  } // 5. look up in a data context\n\n\n  return function () {\n    var isCalledAsFunction = arguments.length > 0;\n    var data = Blaze.getData();\n    var x = data && data[name];\n\n    if (!x) {\n      if (lookupTemplate) {\n        throw new Error(\"No such template: \" + name);\n      } else if (isCalledAsFunction) {\n        throw new Error(\"No such function: \" + name);\n      } else if (name.charAt(0) === '@' && (x === null || x === undefined)) {\n        // Throw an error if the user tries to use a `@directive`\n        // that doesn't exist.  We don't implement all directives\n        // from Handlebars, so there's a potential for confusion\n        // if we fail silently.  On the other hand, we want to\n        // throw late in case some app or package wants to provide\n        // a missing directive.\n        throw new Error(\"Unsupported directive: \" + name);\n      }\n    }\n\n    if (!data) {\n      return null;\n    }\n\n    if (typeof x !== 'function') {\n      if (isCalledAsFunction) {\n        throw new Error(\"Can't call non-function: \" + x);\n      }\n\n      return x;\n    }\n\n    return x.apply(data, arguments);\n  };\n}; // Implement Spacebars' {{../..}}.\n// @param height {Number} The number of '..'s\n\n\nBlaze._parentData = function (height, _functionWrapped) {\n  // If height is null or undefined, we default to 1, the first parent.\n  if (height == null) {\n    height = 1;\n  }\n\n  var theWith = Blaze.getView('with');\n\n  for (var i = 0; i < height && theWith; i++) {\n    theWith = Blaze.getView(theWith, 'with');\n  }\n\n  if (!theWith) return null;\n  if (_functionWrapped) return function () {\n    return theWith.dataVar.get();\n  };\n  return theWith.dataVar.get();\n};\n\nBlaze.View.prototype.lookupTemplate = function (name) {\n  return this.lookup(name, {\n    template: true\n  });\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.js\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/blaze/template.js                                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet isObject;\nmodule.link(\"lodash.isobject\", {\n  default(v) {\n    isObject = v;\n  }\n\n}, 0);\nlet isFunction;\nmodule.link(\"lodash.isfunction\", {\n  default(v) {\n    isFunction = v;\n  }\n\n}, 1);\nlet has;\nmodule.link(\"lodash.has\", {\n  default(v) {\n    has = v;\n  }\n\n}, 2);\nlet isEmpty;\nmodule.link(\"lodash.isempty\", {\n  default(v) {\n    isEmpty = v;\n  }\n\n}, 3);\n\n// [new] Blaze.Template([viewName], renderFunction)\n//\n// `Blaze.Template` is the class of templates, like `Template.foo` in\n// Meteor, which is `instanceof Template`.\n//\n// `viewKind` is a string that looks like \"Template.foo\" for templates\n// defined by the compiler.\n\n/**\n * @class\n * @summary Constructor for a Template, which is used to construct Views with particular name and content.\n * @locus Client\n * @param {String} [viewName] Optional.  A name for Views constructed by this Template.  See [`view.name`](#view_name).\n * @param {Function} renderFunction A function that returns [*renderable content*](#Renderable-Content).  This function is used as the `renderFunction` for Views constructed by this Template.\n */\nBlaze.Template = function (viewName, renderFunction) {\n  if (!(this instanceof Blaze.Template)) // called without `new`\n    return new Blaze.Template(viewName, renderFunction);\n\n  if (typeof viewName === 'function') {\n    // omitted \"viewName\" argument\n    renderFunction = viewName;\n    viewName = '';\n  }\n\n  if (typeof viewName !== 'string') throw new Error(\"viewName must be a String (or omitted)\");\n  if (typeof renderFunction !== 'function') throw new Error(\"renderFunction must be a function\");\n  this.viewName = viewName;\n  this.renderFunction = renderFunction;\n  this.__helpers = new HelperMap();\n  this.__eventMaps = [];\n  this._callbacks = {\n    created: [],\n    rendered: [],\n    destroyed: []\n  };\n};\n\nvar Template = Blaze.Template;\n\nvar HelperMap = function () {};\n\nHelperMap.prototype.get = function (name) {\n  return this[' ' + name];\n};\n\nHelperMap.prototype.set = function (name, helper) {\n  this[' ' + name] = helper;\n};\n\nHelperMap.prototype.has = function (name) {\n  return typeof this[' ' + name] !== 'undefined';\n};\n/**\n * @summary Returns true if `value` is a template object like `Template.myTemplate`.\n * @locus Client\n * @param {Any} value The value to test.\n */\n\n\nBlaze.isTemplate = function (t) {\n  return t instanceof Blaze.Template;\n};\n/**\n * @name  onCreated\n * @instance\n * @memberOf Template\n * @summary Register a function to be called when an instance of this template is created.\n * @param {Function} callback A function to be added as a callback.\n * @locus Client\n * @importFromPackage templating\n */\n\n\nTemplate.prototype.onCreated = function (cb) {\n  this._callbacks.created.push(cb);\n};\n/**\n * @name  onRendered\n * @instance\n * @memberOf Template\n * @summary Register a function to be called when an instance of this template is inserted into the DOM.\n * @param {Function} callback A function to be added as a callback.\n * @locus Client\n * @importFromPackage templating\n */\n\n\nTemplate.prototype.onRendered = function (cb) {\n  this._callbacks.rendered.push(cb);\n};\n/**\n * @name  onDestroyed\n * @instance\n * @memberOf Template\n * @summary Register a function to be called when an instance of this template is removed from the DOM and destroyed.\n * @param {Function} callback A function to be added as a callback.\n * @locus Client\n * @importFromPackage templating\n */\n\n\nTemplate.prototype.onDestroyed = function (cb) {\n  this._callbacks.destroyed.push(cb);\n};\n\nTemplate.prototype._getCallbacks = function (which) {\n  var self = this;\n  var callbacks = self[which] ? [self[which]] : []; // Fire all callbacks added with the new API (Template.onRendered())\n  // as well as the old-style callback (e.g. Template.rendered) for\n  // backwards-compatibility.\n\n  callbacks = callbacks.concat(self._callbacks[which]);\n  return callbacks;\n};\n\nvar fireCallbacks = function (callbacks, template) {\n  Template._withTemplateInstanceFunc(function () {\n    return template;\n  }, function () {\n    for (var i = 0, N = callbacks.length; i < N; i++) {\n      callbacks[i].call(template);\n    }\n  });\n};\n\nTemplate.prototype.constructView = function (contentFunc, elseFunc) {\n  var self = this;\n  var view = Blaze.View(self.viewName, self.renderFunction);\n  view.template = self;\n  view.templateContentBlock = contentFunc ? new Template('(contentBlock)', contentFunc) : null;\n  view.templateElseBlock = elseFunc ? new Template('(elseBlock)', elseFunc) : null;\n\n  if (self.__eventMaps || typeof self.events === 'object') {\n    view._onViewRendered(function () {\n      if (view.renderCount !== 1) return;\n\n      if (!self.__eventMaps.length && typeof self.events === \"object\") {\n        // Provide limited back-compat support for `.events = {...}`\n        // syntax.  Pass `template.events` to the original `.events(...)`\n        // function.  This code must run only once per template, in\n        // order to not bind the handlers more than once, which is\n        // ensured by the fact that we only do this when `__eventMaps`\n        // is falsy, and we cause it to be set now.\n        Template.prototype.events.call(self, self.events);\n      }\n\n      self.__eventMaps.forEach(function (m) {\n        Blaze._addEventMap(view, m, view);\n      });\n    });\n  }\n\n  view._templateInstance = new Blaze.TemplateInstance(view);\n\n  view.templateInstance = function () {\n    // Update data, firstNode, and lastNode, and return the TemplateInstance\n    // object.\n    var inst = view._templateInstance;\n    /**\n     * @instance\n     * @memberOf Blaze.TemplateInstance\n     * @name  data\n     * @summary The data context of this instance's latest invocation.\n     * @locus Client\n     */\n\n    inst.data = Blaze.getData(view);\n\n    if (view._domrange && !view.isDestroyed) {\n      inst.firstNode = view._domrange.firstNode();\n      inst.lastNode = view._domrange.lastNode();\n    } else {\n      // on 'created' or 'destroyed' callbacks we don't have a DomRange\n      inst.firstNode = null;\n      inst.lastNode = null;\n    }\n\n    return inst;\n  };\n  /**\n   * @name  created\n   * @instance\n   * @memberOf Template\n   * @summary Provide a callback when an instance of a template is created.\n   * @locus Client\n   * @deprecated in 1.1\n   */\n  // To avoid situations when new callbacks are added in between view\n  // instantiation and event being fired, decide on all callbacks to fire\n  // immediately and then fire them on the event.\n\n\n  var createdCallbacks = self._getCallbacks('created');\n\n  view.onViewCreated(function () {\n    fireCallbacks(createdCallbacks, view.templateInstance());\n  });\n  /**\n   * @name  rendered\n   * @instance\n   * @memberOf Template\n   * @summary Provide a callback when an instance of a template is rendered.\n   * @locus Client\n   * @deprecated in 1.1\n   */\n\n  var renderedCallbacks = self._getCallbacks('rendered');\n\n  view.onViewReady(function () {\n    fireCallbacks(renderedCallbacks, view.templateInstance());\n  });\n  /**\n   * @name  destroyed\n   * @instance\n   * @memberOf Template\n   * @summary Provide a callback when an instance of a template is destroyed.\n   * @locus Client\n   * @deprecated in 1.1\n   */\n\n  var destroyedCallbacks = self._getCallbacks('destroyed');\n\n  view.onViewDestroyed(function () {\n    fireCallbacks(destroyedCallbacks, view.templateInstance());\n  });\n  return view;\n};\n/**\n * @class\n * @summary The class for template instances\n * @param {Blaze.View} view\n * @instanceName template\n */\n\n\nBlaze.TemplateInstance = function (view) {\n  if (!(this instanceof Blaze.TemplateInstance)) // called without `new`\n    return new Blaze.TemplateInstance(view);\n  if (!(view instanceof Blaze.View)) throw new Error(\"View required\");\n  view._templateInstance = this;\n  /**\n   * @name view\n   * @memberOf Blaze.TemplateInstance\n   * @instance\n   * @summary The [View](../api/blaze.html#Blaze-View) object for this invocation of the template.\n   * @locus Client\n   * @type {Blaze.View}\n   */\n\n  this.view = view;\n  this.data = null;\n  /**\n   * @name firstNode\n   * @memberOf Blaze.TemplateInstance\n   * @instance\n   * @summary The first top-level DOM node in this template instance.\n   * @locus Client\n   * @type {DOMNode}\n   */\n\n  this.firstNode = null;\n  /**\n   * @name lastNode\n   * @memberOf Blaze.TemplateInstance\n   * @instance\n   * @summary The last top-level DOM node in this template instance.\n   * @locus Client\n   * @type {DOMNode}\n   */\n\n  this.lastNode = null; // This dependency is used to identify state transitions in\n  // _subscriptionHandles which could cause the result of\n  // TemplateInstance#subscriptionsReady to change. Basically this is triggered\n  // whenever a new subscription handle is added or when a subscription handle\n  // is removed and they are not ready.\n\n  this._allSubsReadyDep = new Tracker.Dependency();\n  this._allSubsReady = false;\n  this._subscriptionHandles = {};\n};\n/**\n * @summary Find all elements matching `selector` in this template instance, and return them as a JQuery object.\n * @locus Client\n * @param {String} selector The CSS selector to match, scoped to the template contents.\n * @returns {DOMNode[]}\n */\n\n\nBlaze.TemplateInstance.prototype.$ = function (selector) {\n  var view = this.view;\n  if (!view._domrange) throw new Error(\"Can't use $ on template instance with no DOM\");\n  return view._domrange.$(selector);\n};\n/**\n * @summary Find all elements matching `selector` in this template instance.\n * @locus Client\n * @param {String} selector The CSS selector to match, scoped to the template contents.\n * @returns {DOMElement[]}\n */\n\n\nBlaze.TemplateInstance.prototype.findAll = function (selector) {\n  return Array.prototype.slice.call(this.$(selector));\n};\n/**\n * @summary Find one element matching `selector` in this template instance.\n * @locus Client\n * @param {String} selector The CSS selector to match, scoped to the template contents.\n * @returns {DOMElement}\n */\n\n\nBlaze.TemplateInstance.prototype.find = function (selector) {\n  var result = this.$(selector);\n  return result[0] || null;\n};\n/**\n * @summary A version of [Tracker.autorun](https://docs.meteor.com/api/tracker.html#Tracker-autorun) that is stopped when the template is destroyed.\n * @locus Client\n * @param {Function} runFunc The function to run. It receives one argument: a Tracker.Computation object.\n */\n\n\nBlaze.TemplateInstance.prototype.autorun = function (f) {\n  return this.view.autorun(f);\n};\n/**\n * @summary A version of [Meteor.subscribe](https://docs.meteor.com/api/pubsub.html#Meteor-subscribe) that is stopped\n * when the template is destroyed.\n * @return {SubscriptionHandle} The subscription handle to the newly made\n * subscription. Call `handle.stop()` to manually stop the subscription, or\n * `handle.ready()` to find out if this particular subscription has loaded all\n * of its inital data.\n * @locus Client\n * @param {String} name Name of the subscription.  Matches the name of the\n * server's `publish()` call.\n * @param {Any} [arg1,arg2...] Optional arguments passed to publisher function\n * on server.\n * @param {Function|Object} [options] If a function is passed instead of an\n * object, it is interpreted as an `onReady` callback.\n * @param {Function} [options.onReady] Passed to [`Meteor.subscribe`](https://docs.meteor.com/api/pubsub.html#Meteor-subscribe).\n * @param {Function} [options.onStop] Passed to [`Meteor.subscribe`](https://docs.meteor.com/api/pubsub.html#Meteor-subscribe).\n * @param {DDP.Connection} [options.connection] The connection on which to make the\n * subscription.\n */\n\n\nBlaze.TemplateInstance.prototype.subscribe = function () {\n  var self = this;\n  var subHandles = self._subscriptionHandles; // Duplicate logic from Meteor.subscribe\n\n  var options = {};\n\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  if (args.length) {\n    var lastParam = args[args.length - 1]; // Match pattern to check if the last arg is an options argument\n\n    var lastParamOptionsPattern = {\n      onReady: Match.Optional(Function),\n      // XXX COMPAT WITH 1.0.3.1 onError used to exist, but now we use\n      // onStop with an error callback instead.\n      onError: Match.Optional(Function),\n      onStop: Match.Optional(Function),\n      connection: Match.Optional(Match.Any)\n    };\n\n    if (isFunction(lastParam)) {\n      options.onReady = args.pop();\n    } else if (lastParam && !isEmpty(lastParam) && Match.test(lastParam, lastParamOptionsPattern)) {\n      options = args.pop();\n    }\n  }\n\n  var subHandle;\n  var oldStopped = options.onStop;\n\n  options.onStop = function (error) {\n    // When the subscription is stopped, remove it from the set of tracked\n    // subscriptions to avoid this list growing without bound\n    delete subHandles[subHandle.subscriptionId]; // Removing a subscription can only change the result of subscriptionsReady\n    // if we are not ready (that subscription could be the one blocking us being\n    // ready).\n\n    if (!self._allSubsReady) {\n      self._allSubsReadyDep.changed();\n    }\n\n    if (oldStopped) {\n      oldStopped(error);\n    }\n  };\n\n  var connection = options.connection;\n  const {\n    onReady,\n    onError,\n    onStop\n  } = options;\n  var callbacks = {\n    onReady,\n    onError,\n    onStop\n  }; // The callbacks are passed as the last item in the arguments array passed to\n  // View#subscribe\n\n  args.push(callbacks); // View#subscribe takes the connection as one of the options in the last\n  // argument\n\n  subHandle = self.view.subscribe.call(self.view, args, {\n    connection: connection\n  });\n\n  if (!has(subHandles, subHandle.subscriptionId)) {\n    subHandles[subHandle.subscriptionId] = subHandle; // Adding a new subscription will always cause us to transition from ready\n    // to not ready, but if we are already not ready then this can't make us\n    // ready.\n\n    if (self._allSubsReady) {\n      self._allSubsReadyDep.changed();\n    }\n  }\n\n  return subHandle;\n};\n/**\n * @summary A reactive function that returns true when all of the subscriptions\n * called with [this.subscribe](#TemplateInstance-subscribe) are ready.\n * @return {Boolean} True if all subscriptions on this template instance are\n * ready.\n */\n\n\nBlaze.TemplateInstance.prototype.subscriptionsReady = function () {\n  this._allSubsReadyDep.depend();\n\n  this._allSubsReady = Object.values(this._subscriptionHandles).every(handle => {\n    return handle.ready();\n  });\n  return this._allSubsReady;\n};\n/**\n * @summary Specify template helpers available to this template.\n * @locus Client\n * @param {Object} helpers Dictionary of helper functions by name.\n * @importFromPackage templating\n */\n\n\nTemplate.prototype.helpers = function (dict) {\n  if (!isObject(dict)) {\n    throw new Error(\"Helpers dictionary has to be an object\");\n  }\n\n  for (var k in dict) this.__helpers.set(k, dict[k]);\n};\n\nvar canUseGetters = function () {\n  if (Object.defineProperty) {\n    var obj = {};\n\n    try {\n      Object.defineProperty(obj, \"self\", {\n        get: function () {\n          return obj;\n        }\n      });\n    } catch (e) {\n      return false;\n    }\n\n    return obj.self === obj;\n  }\n\n  return false;\n}();\n\nif (canUseGetters) {\n  // Like Blaze.currentView but for the template instance. A function\n  // rather than a value so that not all helpers are implicitly dependent\n  // on the current template instance's `data` property, which would make\n  // them dependent on the data context of the template inclusion.\n  var currentTemplateInstanceFunc = null; // If getters are supported, define this property with a getter function\n  // to make it effectively read-only, and to work around this bizarre JSC\n  // bug: https://github.com/meteor/meteor/issues/9926\n\n  Object.defineProperty(Template, \"_currentTemplateInstanceFunc\", {\n    get: function () {\n      return currentTemplateInstanceFunc;\n    }\n  });\n\n  Template._withTemplateInstanceFunc = function (templateInstanceFunc, func) {\n    if (typeof func !== 'function') {\n      throw new Error(\"Expected function, got: \" + func);\n    }\n\n    var oldTmplInstanceFunc = currentTemplateInstanceFunc;\n\n    try {\n      currentTemplateInstanceFunc = templateInstanceFunc;\n      return func();\n    } finally {\n      currentTemplateInstanceFunc = oldTmplInstanceFunc;\n    }\n  };\n} else {\n  // If getters are not supported, just use a normal property.\n  Template._currentTemplateInstanceFunc = null;\n\n  Template._withTemplateInstanceFunc = function (templateInstanceFunc, func) {\n    if (typeof func !== 'function') {\n      throw new Error(\"Expected function, got: \" + func);\n    }\n\n    var oldTmplInstanceFunc = Template._currentTemplateInstanceFunc;\n\n    try {\n      Template._currentTemplateInstanceFunc = templateInstanceFunc;\n      return func();\n    } finally {\n      Template._currentTemplateInstanceFunc = oldTmplInstanceFunc;\n    }\n  };\n}\n/**\n * @summary Specify event handlers for this template.\n * @locus Client\n * @param {EventMap} eventMap Event handlers to associate with this template.\n * @importFromPackage templating\n */\n\n\nTemplate.prototype.events = function (eventMap) {\n  if (!isObject(eventMap)) {\n    throw new Error(\"Event map has to be an object\");\n  }\n\n  var template = this;\n  var eventMap2 = {};\n\n  for (var k in eventMap) {\n    eventMap2[k] = function (k, v) {\n      return function (event\n      /*, ...*/\n      ) {\n        var view = this; // passed by EventAugmenter\n\n        var data = Blaze.getData(event.currentTarget);\n        if (data == null) data = {};\n        var args = Array.prototype.slice.call(arguments);\n\n        var tmplInstanceFunc = Blaze._bind(view.templateInstance, view);\n\n        args.splice(1, 0, tmplInstanceFunc());\n        return Template._withTemplateInstanceFunc(tmplInstanceFunc, function () {\n          return v.apply(data, args);\n        });\n      };\n    }(k, eventMap[k]);\n  }\n\n  template.__eventMaps.push(eventMap2);\n};\n/**\n * @function\n * @name instance\n * @memberOf Template\n * @summary The [template instance](#Template-instances) corresponding to the current template helper, event handler, callback, or autorun.  If there isn't one, `null`.\n * @locus Client\n * @returns {Blaze.TemplateInstance}\n * @importFromPackage templating\n */\n\n\nTemplate.instance = function () {\n  return Template._currentTemplateInstanceFunc && Template._currentTemplateInstanceFunc();\n}; // Note: Template.currentData() is documented to take zero arguments,\n// while Blaze.getData takes up to one.\n\n/**\n * @summary\n *\n * - Inside an `onCreated`, `onRendered`, or `onDestroyed` callback, returns\n * the data context of the template.\n * - Inside an event handler, returns the data context of the template on which\n * this event handler was defined.\n * - Inside a helper, returns the data context of the DOM node where the helper\n * was used.\n *\n * Establishes a reactive dependency on the result.\n * @locus Client\n * @function\n * @importFromPackage templating\n */\n\n\nTemplate.currentData = Blaze.getData;\n/**\n * @summary Accesses other data contexts that enclose the current data context.\n * @locus Client\n * @function\n * @param {Integer} [numLevels] The number of levels beyond the current data context to look. Defaults to 1.\n * @importFromPackage templating\n */\n\nTemplate.parentData = Blaze._parentData;\n/**\n * @summary Defines a [helper function](#Template-helpers) which can be used from all templates.\n * @locus Client\n * @function\n * @param {String} name The name of the helper function you are defining.\n * @param {Function} function The helper function itself.\n * @importFromPackage templating\n */\n\nTemplate.registerHelper = Blaze.registerHelper;\n/**\n * @summary Removes a global [helper function](#Template-helpers).\n * @locus Client\n * @function\n * @param {String} name The name of the helper function you are defining.\n * @importFromPackage templating\n */\n\nTemplate.deregisterHelper = Blaze.deregisterHelper;\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"backcompat.js\":function module(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/blaze/backcompat.js                                                                                        //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nUI = Blaze;\nBlaze.ReactiveVar = ReactiveVar;\nUI._templateInstance = Blaze.Template.instance;\nHandlebars = {};\nHandlebars.registerHelper = Blaze.registerHelper;\nHandlebars._escape = Blaze._escape; // Return these from {{...}} helpers to achieve the same as returning\n// strings from {{{...}}} helpers\n\nHandlebars.SafeString = function (string) {\n  this.string = string;\n};\n\nHandlebars.SafeString.prototype.toString = function () {\n  return this.string.toString();\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"node_modules\":{\"lodash.has\":{\"package.json\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// node_modules/meteor/blaze/node_modules/lodash.has/package.json                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.exports = {\n  \"name\": \"lodash.has\",\n  \"version\": \"4.5.2\"\n};\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// node_modules/meteor/blaze/node_modules/lodash.has/index.js                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.useNode();\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"lodash.isobject\":{\"package.json\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// node_modules/meteor/blaze/node_modules/lodash.isobject/package.json                                                 //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.exports = {\n  \"name\": \"lodash.isobject\",\n  \"version\": \"3.0.2\"\n};\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// node_modules/meteor/blaze/node_modules/lodash.isobject/index.js                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.useNode();\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"lodash.isfunction\":{\"package.json\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// node_modules/meteor/blaze/node_modules/lodash.isfunction/package.json                                               //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.exports = {\n  \"name\": \"lodash.isfunction\",\n  \"version\": \"3.0.9\"\n};\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// node_modules/meteor/blaze/node_modules/lodash.isfunction/index.js                                                   //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.useNode();\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"lodash.isempty\":{\"package.json\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// node_modules/meteor/blaze/node_modules/lodash.isempty/package.json                                                  //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.exports = {\n  \"name\": \"lodash.isempty\",\n  \"version\": \"4.4.0\"\n};\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function module(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// node_modules/meteor/blaze/node_modules/lodash.isempty/index.js                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.useNode();\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}}}}}},{\n  \"extensions\": [\n    \".js\",\n    \".json\"\n  ]\n});\n\nrequire(\"/node_modules/meteor/blaze/preamble.js\");\nrequire(\"/node_modules/meteor/blaze/exceptions.js\");\nrequire(\"/node_modules/meteor/blaze/view.js\");\nrequire(\"/node_modules/meteor/blaze/builtins.js\");\nrequire(\"/node_modules/meteor/blaze/lookup.js\");\nrequire(\"/node_modules/meteor/blaze/template.js\");\nrequire(\"/node_modules/meteor/blaze/backcompat.js\");\n\n/* Exports */\nPackage._define(\"blaze\", {\n  Blaze: Blaze,\n  UI: UI,\n  Handlebars: Handlebars\n});\n\n})();\n","servePath":"/packages/blaze.js","sourceMap":{"version":3,"sources":["packages/blaze/preamble.js","packages/blaze/exceptions.js","packages/blaze/view.js","packages/blaze/builtins.js","packages/blaze/lookup.js","packages/blaze/template.js","packages/blaze/backcompat.js"],"names":["Blaze","_escape","escape_map","escape_one","c","x","replace","_warn","msg","console","warn","nativeBind","Function","prototype","bind","_bind","func","obj","arguments","length","call","args","Array","i","apply","slice","objA","objB","debugFunc","_throwNextException","_reportException","e","Meteor","_debug","log","stack","message","_wrapCatchingExceptions","f","where","View","name","render","_render","_callbacks","created","rendered","destroyed","isCreated","_isCreatedForExpansion","isRendered","_isAttached","isDestroyed","_isInRender","parentView","_domrange","_hasGeneratedParent","_scopeBindings","renderCount","onViewCreated","cb","push","_onViewRendered","onViewReady","self","fire","Tracker","afterFlush","_withCurrentView","onViewRendered","attached","onAttached","onViewDestroyed","removeViewDestroyedListener","index","lastIndexOf","autorun","_inViewScope","displayName","Error","templateInstanceFunc","Template","_currentTemplateInstanceFunc","viewAutorun","_withTemplateInstanceFunc","comp","stopComputation","stop","onStop","_errorIfShouldntCallSubscribe","subscribe","options","subHandle","connection","firstNode","lastNode","_fireCallbacks","view","which","nonreactive","fireCallbacks","cbs","N","_createView","forExpansion","doFirstRender","initialContent","domrange","_DOMRange","teardownHook","range","element","_DOMBackend","Teardown","onElementTeardown","teardown","_destroyView","_materializeView","_workStack","_intoArray","lastHtmljs","doRender","htmljs","firstRun","_isContentEqual","doMaterialize","rangesAndNodes","_materializeDOM","setMembers","onInvalidate","destroyMembers","undefined","initialContents","_expandView","result","_expand","active","_HTMLJSExpander","HTML","TransformingVisitor","extend","def","visitObject","constructView","visitAttributes","attrs","visitAttribute","value","tag","currentViewIfRendering","currentView","visit","_expandAttributes","_skipNodes","_destroyNode","node","nodeType","tearDownElement","a","b","Raw","oldView","checkRenderContent","content","Visitor","contentAsView","contentAsFunc","__rootViews","parentElement","nextNode","indexOf","splice","attach","insert","renderWithData","data","_TemplateWith","remove","parentRange","detach","destroy","toHTML","toHTMLWithData","_toText","textMode","TEXTMODE","STRING","RCDATA","ATTRIBUTE","toText","getData","elementOrView","theWith","getView","dataVar","get","getElementData","_viewName","viewName","_getCurrentView","_getParentView","_getElementView","v","elem","forElement","_addEventMap","eventMap","thisInHandler","handles","attached_eventMaps","Object","keys","forEach","spec","handler","clauses","split","clause","parts","newEvents","shift","selector","join","_EventSupport","listen","evt","containsElement","currentTarget","handlerThis","handlerArgs","r","h","has","module","link","default","isObject","_calculateCondition","cond","isArray","With","contentFunc","ReactiveVar","set","_attachBindingsToView","bindings","entries","binding","Let","If","conditionFunc","elseFunc","_not","conditionVar","__conditionVar","Unless","Each","argFunc","eachView","subviews","initialSubviews","expandedValueDep","Dependency","depend","numItems","inElseMode","stopHandle","argVar","variableName","updateIndices","from","to","members","arg","_variable","_sequence","ObserveSequence","observe","addedAt","id","item","newItemView","changed","removeMember","addMember","removedAt","changedAt","newItem","oldItem","itemView","getMember","movedTo","fromIndex","toIndex","moveMember","Math","min","max","w","wrappedArgFunc","viewToEvaluateArg","originalParentView","wrappedContentFunc","__isTemplateWith","_InOuterTemplateScope","templateView","__childDoesntStartNewLexicalScope","InOuterTemplateScope","_globalHelpers","registerHelper","deregisterHelper","bindIfIsFunction","target","bindDataContext","_OLDSTYLE_HELPER","_getTemplateHelper","template","tmplInstanceFunc","isKnownOldStyleHelper","__helpers","helper","wrapHelper","_NOWARN_OLDSTYLE_HELPERS","templateFunc","_lexicalBindingLookup","blockHelpersStack","bindingReactiveVar","__startsNewLexicalScope","_getTemplate","templateInstance","_getGlobalHelper","lookup","_options","lookupTemplate","boundTmplInstance","foundTemplate","test","_parentData","isCalledAsFunction","charAt","height","_functionWrapped","isFunction","isEmpty","renderFunction","HelperMap","__eventMaps","isTemplate","t","onCreated","onRendered","onDestroyed","_getCallbacks","callbacks","concat","templateContentBlock","templateElseBlock","events","m","_templateInstance","TemplateInstance","inst","createdCallbacks","renderedCallbacks","destroyedCallbacks","_allSubsReadyDep","_allSubsReady","_subscriptionHandles","$","findAll","find","subHandles","lastParam","lastParamOptionsPattern","onReady","Match","Optional","onError","Any","pop","oldStopped","error","subscriptionId","subscriptionsReady","values","every","handle","ready","helpers","dict","k","canUseGetters","defineProperty","currentTemplateInstanceFunc","oldTmplInstanceFunc","eventMap2","event","instance","currentData","parentData","UI","Handlebars","SafeString","string","toString"],"mappings":"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","file":"/packages/blaze.js","sourcesContent":["/**\n * @namespace Blaze\n * @summary The namespace for all Blaze-related methods and classes.\n */\nBlaze = {};\n\n// Utility to HTML-escape a string.  Included for legacy reasons.\n// TODO: Should be replaced with _.escape once underscore is upgraded to a newer\n//       version which escapes ` (backtick) as well. Underscore 1.5.2 does not.\nBlaze._escape = (function() {\n  var escape_map = {\n    \"<\": \"&lt;\",\n    \">\": \"&gt;\",\n    '\"': \"&quot;\",\n    \"'\": \"&#x27;\",\n    \"/\": \"&#x2F;\",\n    \"`\": \"&#x60;\", /* IE allows backtick-delimited attributes?? */\n    \"&\": \"&amp;\"\n  };\n  var escape_one = function(c) {\n    return escape_map[c];\n  };\n\n  return function (x) {\n    return x.replace(/[&<>\"'`]/g, escape_one);\n  };\n})();\n\nBlaze._warn = function (msg) {\n  msg = 'Warning: ' + msg;\n\n  if ((typeof console !== 'undefined') && console.warn) {\n    console.warn(msg);\n  }\n};\n\nvar nativeBind = Function.prototype.bind;\n\n// An implementation of _.bind which allows better optimization.\n// See: https://github.com/petkaantonov/bluebird/wiki/Optimization-killers#3-managing-arguments\nif (nativeBind) {\n  Blaze._bind = function (func, obj) {\n    if (arguments.length === 2) {\n      return nativeBind.call(func, obj);\n    }\n\n    // Copy the arguments so this function can be optimized.\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    return nativeBind.apply(func, args.slice(1));\n  };\n}\nelse {\n  // A slower but backwards compatible version.\n  Blaze._bind = function(objA, objB) {\n    objA.bind(objB);\n  };\n}\n","var debugFunc;\n\n// We call into user code in many places, and it's nice to catch exceptions\n// propagated from user code immediately so that the whole system doesn't just\n// break.  Catching exceptions is easy; reporting them is hard.  This helper\n// reports exceptions.\n//\n// Usage:\n//\n// ```\n// try {\n//   // ... someStuff ...\n// } catch (e) {\n//   reportUIException(e);\n// }\n// ```\n//\n// An optional second argument overrides the default message.\n\n// Set this to `true` to cause `reportException` to throw\n// the next exception rather than reporting it.  This is\n// useful in unit tests that test error messages.\nBlaze._throwNextException = false;\n\nBlaze._reportException = function (e, msg) {\n  if (Blaze._throwNextException) {\n    Blaze._throwNextException = false;\n    throw e;\n  }\n\n  if (! debugFunc)\n    // adapted from Tracker\n    debugFunc = function () {\n      return (typeof Meteor !== \"undefined\" ? Meteor._debug :\n              ((typeof console !== \"undefined\") && console.log ? console.log :\n               function () {}));\n    };\n\n  // In Chrome, `e.stack` is a multiline string that starts with the message\n  // and contains a stack trace.  Furthermore, `console.log` makes it clickable.\n  // `console.log` supplies the space between the two arguments.\n  debugFunc()(msg || 'Exception caught in template:', e.stack || e.message || e);\n};\n\nBlaze._wrapCatchingExceptions = function (f, where) {\n  if (typeof f !== 'function')\n    return f;\n\n  return function () {\n    try {\n      return f.apply(this, arguments);\n    } catch (e) {\n      Blaze._reportException(e, 'Exception in ' + where + ':');\n    }\n  };\n};\n","/// [new] Blaze.View([name], renderMethod)\n///\n/// Blaze.View is the building block of reactive DOM.  Views have\n/// the following features:\n///\n/// * lifecycle callbacks - Views are created, rendered, and destroyed,\n///   and callbacks can be registered to fire when these things happen.\n///\n/// * parent pointer - A View points to its parentView, which is the\n///   View that caused it to be rendered.  These pointers form a\n///   hierarchy or tree of Views.\n///\n/// * render() method - A View's render() method specifies the DOM\n///   (or HTML) content of the View.  If the method establishes\n///   reactive dependencies, it may be re-run.\n///\n/// * a DOMRange - If a View is rendered to DOM, its position and\n///   extent in the DOM are tracked using a DOMRange object.\n///\n/// When a View is constructed by calling Blaze.View, the View is\n/// not yet considered \"created.\"  It doesn't have a parentView yet,\n/// and no logic has been run to initialize the View.  All real\n/// work is deferred until at least creation time, when the onViewCreated\n/// callbacks are fired, which happens when the View is \"used\" in\n/// some way that requires it to be rendered.\n///\n/// ...more lifecycle stuff\n///\n/// `name` is an optional string tag identifying the View.  The only\n/// time it's used is when looking in the View tree for a View of a\n/// particular name; for example, data contexts are stored on Views\n/// of name \"with\".  Names are also useful when debugging, so in\n/// general it's good for functions that create Views to set the name.\n/// Views associated with templates have names of the form \"Template.foo\".\n\n/**\n * @class\n * @summary Constructor for a View, which represents a reactive region of DOM.\n * @locus Client\n * @param {String} [name] Optional.  A name for this type of View.  See [`view.name`](#view_name).\n * @param {Function} renderFunction A function that returns [*renderable content*](#Renderable-Content).  In this function, `this` is bound to the View.\n */\nBlaze.View = function (name, render) {\n  if (! (this instanceof Blaze.View))\n    // called without `new`\n    return new Blaze.View(name, render);\n\n  if (typeof name === 'function') {\n    // omitted \"name\" argument\n    render = name;\n    name = '';\n  }\n  this.name = name;\n  this._render = render;\n\n  this._callbacks = {\n    created: null,\n    rendered: null,\n    destroyed: null\n  };\n\n  // Setting all properties here is good for readability,\n  // and also may help Chrome optimize the code by keeping\n  // the View object from changing shape too much.\n  this.isCreated = false;\n  this._isCreatedForExpansion = false;\n  this.isRendered = false;\n  this._isAttached = false;\n  this.isDestroyed = false;\n  this._isInRender = false;\n  this.parentView = null;\n  this._domrange = null;\n  // This flag is normally set to false except for the cases when view's parent\n  // was generated as part of expanding some syntactic sugar expressions or\n  // methods.\n  // Ex.: Blaze.renderWithData is an equivalent to creating a view with regular\n  // Blaze.render and wrapping it into {{#with data}}{{/with}} view. Since the\n  // users don't know anything about these generated parent views, Blaze needs\n  // this information to be available on views to make smarter decisions. For\n  // example: removing the generated parent view with the view on Blaze.remove.\n  this._hasGeneratedParent = false;\n  // Bindings accessible to children views (via view.lookup('name')) within the\n  // closest template view.\n  this._scopeBindings = {};\n\n  this.renderCount = 0;\n};\n\nBlaze.View.prototype._render = function () { return null; };\n\nBlaze.View.prototype.onViewCreated = function (cb) {\n  this._callbacks.created = this._callbacks.created || [];\n  this._callbacks.created.push(cb);\n};\n\nBlaze.View.prototype._onViewRendered = function (cb) {\n  this._callbacks.rendered = this._callbacks.rendered || [];\n  this._callbacks.rendered.push(cb);\n};\n\nBlaze.View.prototype.onViewReady = function (cb) {\n  var self = this;\n  var fire = function () {\n    Tracker.afterFlush(function () {\n      if (! self.isDestroyed) {\n        Blaze._withCurrentView(self, function () {\n          cb.call(self);\n        });\n      }\n    });\n  };\n  self._onViewRendered(function onViewRendered() {\n    if (self.isDestroyed)\n      return;\n    if (! self._domrange.attached)\n      self._domrange.onAttached(fire);\n    else\n      fire();\n  });\n};\n\nBlaze.View.prototype.onViewDestroyed = function (cb) {\n  this._callbacks.destroyed = this._callbacks.destroyed || [];\n  this._callbacks.destroyed.push(cb);\n};\nBlaze.View.prototype.removeViewDestroyedListener = function (cb) {\n  var destroyed = this._callbacks.destroyed;\n  if (! destroyed)\n    return;\n  var index = destroyed.lastIndexOf(cb);\n  if (index !== -1) {\n    // XXX You'd think the right thing to do would be splice, but _fireCallbacks\n    // gets sad if you remove callbacks while iterating over the list.  Should\n    // change this to use callback-hook or EventEmitter or something else that\n    // properly supports removal.\n    destroyed[index] = null;\n  }\n};\n\n/// View#autorun(func)\n///\n/// Sets up a Tracker autorun that is \"scoped\" to this View in two\n/// important ways: 1) Blaze.currentView is automatically set\n/// on every re-run, and 2) the autorun is stopped when the\n/// View is destroyed.  As with Tracker.autorun, the first run of\n/// the function is immediate, and a Computation object that can\n/// be used to stop the autorun is returned.\n///\n/// View#autorun is meant to be called from View callbacks like\n/// onViewCreated, or from outside the rendering process.  It may not\n/// be called before the onViewCreated callbacks are fired (too early),\n/// or from a render() method (too confusing).\n///\n/// Typically, autoruns that update the state\n/// of the View (as in Blaze.With) should be started from an onViewCreated\n/// callback.  Autoruns that update the DOM should be started\n/// from either onViewCreated (guarded against the absence of\n/// view._domrange), or onViewReady.\nBlaze.View.prototype.autorun = function (f, _inViewScope, displayName) {\n  var self = this;\n\n  // The restrictions on when View#autorun can be called are in order\n  // to avoid bad patterns, like creating a Blaze.View and immediately\n  // calling autorun on it.  A freshly created View is not ready to\n  // have logic run on it; it doesn't have a parentView, for example.\n  // It's when the View is materialized or expanded that the onViewCreated\n  // handlers are fired and the View starts up.\n  //\n  // Letting the render() method call `this.autorun()` is problematic\n  // because of re-render.  The best we can do is to stop the old\n  // autorun and start a new one for each render, but that's a pattern\n  // we try to avoid internally because it leads to helpers being\n  // called extra times, in the case where the autorun causes the\n  // view to re-render (and thus the autorun to be torn down and a\n  // new one established).\n  //\n  // We could lift these restrictions in various ways.  One interesting\n  // idea is to allow you to call `view.autorun` after instantiating\n  // `view`, and automatically wrap it in `view.onViewCreated`, deferring\n  // the autorun so that it starts at an appropriate time.  However,\n  // then we can't return the Computation object to the caller, because\n  // it doesn't exist yet.\n  if (! self.isCreated) {\n    throw new Error(\"View#autorun must be called from the created callback at the earliest\");\n  }\n  if (this._isInRender) {\n    throw new Error(\"Can't call View#autorun from inside render(); try calling it from the created or rendered callback\");\n  }\n\n  var templateInstanceFunc = Blaze.Template._currentTemplateInstanceFunc;\n\n  var func = function viewAutorun(c) {\n    return Blaze._withCurrentView(_inViewScope || self, function () {\n      return Blaze.Template._withTemplateInstanceFunc(\n        templateInstanceFunc, function () {\n          return f.call(self, c);\n        });\n    });\n  };\n\n  // Give the autorun function a better name for debugging and profiling.\n  // The `displayName` property is not part of the spec but browsers like Chrome\n  // and Firefox prefer it in debuggers over the name function was declared by.\n  func.displayName =\n    (self.name || 'anonymous') + ':' + (displayName || 'anonymous');\n  var comp = Tracker.autorun(func);\n\n  var stopComputation = function () { comp.stop(); };\n  self.onViewDestroyed(stopComputation);\n  comp.onStop(function () {\n    self.removeViewDestroyedListener(stopComputation);\n  });\n\n  return comp;\n};\n\nBlaze.View.prototype._errorIfShouldntCallSubscribe = function () {\n  var self = this;\n\n  if (! self.isCreated) {\n    throw new Error(\"View#subscribe must be called from the created callback at the earliest\");\n  }\n  if (self._isInRender) {\n    throw new Error(\"Can't call View#subscribe from inside render(); try calling it from the created or rendered callback\");\n  }\n  if (self.isDestroyed) {\n    throw new Error(\"Can't call View#subscribe from inside the destroyed callback, try calling it inside created or rendered.\");\n  }\n};\n\n/**\n * Just like Blaze.View#autorun, but with Meteor.subscribe instead of\n * Tracker.autorun. Stop the subscription when the view is destroyed.\n * @return {SubscriptionHandle} A handle to the subscription so that you can\n * see if it is ready, or stop it manually\n */\nBlaze.View.prototype.subscribe = function (args, options) {\n  var self = this;\n  options = options || {};\n\n  self._errorIfShouldntCallSubscribe();\n\n  var subHandle;\n  if (options.connection) {\n    subHandle = options.connection.subscribe.apply(options.connection, args);\n  } else {\n    subHandle = Meteor.subscribe.apply(Meteor, args);\n  }\n\n  self.onViewDestroyed(function () {\n    subHandle.stop();\n  });\n\n  return subHandle;\n};\n\nBlaze.View.prototype.firstNode = function () {\n  if (! this._isAttached)\n    throw new Error(\"View must be attached before accessing its DOM\");\n\n  return this._domrange.firstNode();\n};\n\nBlaze.View.prototype.lastNode = function () {\n  if (! this._isAttached)\n    throw new Error(\"View must be attached before accessing its DOM\");\n\n  return this._domrange.lastNode();\n};\n\nBlaze._fireCallbacks = function (view, which) {\n  Blaze._withCurrentView(view, function () {\n    Tracker.nonreactive(function fireCallbacks() {\n      var cbs = view._callbacks[which];\n      for (var i = 0, N = (cbs && cbs.length); i < N; i++)\n        cbs[i] && cbs[i].call(view);\n    });\n  });\n};\n\nBlaze._createView = function (view, parentView, forExpansion) {\n  if (view.isCreated)\n    throw new Error(\"Can't render the same View twice\");\n\n  view.parentView = (parentView || null);\n  view.isCreated = true;\n  if (forExpansion)\n    view._isCreatedForExpansion = true;\n\n  Blaze._fireCallbacks(view, 'created');\n};\n\nvar doFirstRender = function (view, initialContent) {\n  var domrange = new Blaze._DOMRange(initialContent);\n  view._domrange = domrange;\n  domrange.view = view;\n  view.isRendered = true;\n  Blaze._fireCallbacks(view, 'rendered');\n\n  var teardownHook = null;\n\n  domrange.onAttached(function attached(range, element) {\n    view._isAttached = true;\n\n    teardownHook = Blaze._DOMBackend.Teardown.onElementTeardown(\n      element, function teardown() {\n        Blaze._destroyView(view, true /* _skipNodes */);\n      });\n  });\n\n  // tear down the teardown hook\n  view.onViewDestroyed(function () {\n    teardownHook && teardownHook.stop();\n    teardownHook = null;\n  });\n\n  return domrange;\n};\n\n// Take an uncreated View `view` and create and render it to DOM,\n// setting up the autorun that updates the View.  Returns a new\n// DOMRange, which has been associated with the View.\n//\n// The private arguments `_workStack` and `_intoArray` are passed in\n// by Blaze._materializeDOM and are only present for recursive calls\n// (when there is some other _materializeView on the stack).  If\n// provided, then we avoid the mutual recursion of calling back into\n// Blaze._materializeDOM so that deep View hierarchies don't blow the\n// stack.  Instead, we push tasks onto workStack for the initial\n// rendering and subsequent setup of the View, and they are done after\n// we return.  When there is a _workStack, we do not return the new\n// DOMRange, but instead push it into _intoArray from a _workStack\n// task.\nBlaze._materializeView = function (view, parentView, _workStack, _intoArray) {\n  Blaze._createView(view, parentView);\n\n  var domrange;\n  var lastHtmljs;\n  // We don't expect to be called in a Computation, but just in case,\n  // wrap in Tracker.nonreactive.\n  Tracker.nonreactive(function () {\n    view.autorun(function doRender(c) {\n      // `view.autorun` sets the current view.\n      view.renderCount++;\n      view._isInRender = true;\n      // Any dependencies that should invalidate this Computation come\n      // from this line:\n      var htmljs = view._render();\n      view._isInRender = false;\n\n      if (! c.firstRun && ! Blaze._isContentEqual(lastHtmljs, htmljs)) {\n        Tracker.nonreactive(function doMaterialize() {\n          // re-render\n          var rangesAndNodes = Blaze._materializeDOM(htmljs, [], view);\n          domrange.setMembers(rangesAndNodes);\n          Blaze._fireCallbacks(view, 'rendered');\n        });\n      }\n      lastHtmljs = htmljs;\n\n      // Causes any nested views to stop immediately, not when we call\n      // `setMembers` the next time around the autorun.  Otherwise,\n      // helpers in the DOM tree to be replaced might be scheduled\n      // to re-run before we have a chance to stop them.\n      Tracker.onInvalidate(function () {\n        if (domrange) {\n          domrange.destroyMembers();\n        }\n      });\n    }, undefined, 'materialize');\n\n    // first render.  lastHtmljs is the first htmljs.\n    var initialContents;\n    if (! _workStack) {\n      initialContents = Blaze._materializeDOM(lastHtmljs, [], view);\n      domrange = doFirstRender(view, initialContents);\n      initialContents = null; // help GC because we close over this scope a lot\n    } else {\n      // We're being called from Blaze._materializeDOM, so to avoid\n      // recursion and save stack space, provide a description of the\n      // work to be done instead of doing it.  Tasks pushed onto\n      // _workStack will be done in LIFO order after we return.\n      // The work will still be done within a Tracker.nonreactive,\n      // because it will be done by some call to Blaze._materializeDOM\n      // (which is always called in a Tracker.nonreactive).\n      initialContents = [];\n      // push this function first so that it happens last\n      _workStack.push(function () {\n        domrange = doFirstRender(view, initialContents);\n        initialContents = null; // help GC because of all the closures here\n        _intoArray.push(domrange);\n      });\n      // now push the task that calculates initialContents\n      _workStack.push(Blaze._bind(Blaze._materializeDOM, null,\n                             lastHtmljs, initialContents, view, _workStack));\n    }\n  });\n\n  if (! _workStack) {\n    return domrange;\n  } else {\n    return null;\n  }\n};\n\n// Expands a View to HTMLjs, calling `render` recursively on all\n// Views and evaluating any dynamic attributes.  Calls the `created`\n// callback, but not the `materialized` or `rendered` callbacks.\n// Destroys the view immediately, unless called in a Tracker Computation,\n// in which case the view will be destroyed when the Computation is\n// invalidated.  If called in a Tracker Computation, the result is a\n// reactive string; that is, the Computation will be invalidated\n// if any changes are made to the view or subviews that might affect\n// the HTML.\nBlaze._expandView = function (view, parentView) {\n  Blaze._createView(view, parentView, true /*forExpansion*/);\n\n  view._isInRender = true;\n  var htmljs = Blaze._withCurrentView(view, function () {\n    return view._render();\n  });\n  view._isInRender = false;\n\n  var result = Blaze._expand(htmljs, view);\n\n  if (Tracker.active) {\n    Tracker.onInvalidate(function () {\n      Blaze._destroyView(view);\n    });\n  } else {\n    Blaze._destroyView(view);\n  }\n\n  return result;\n};\n\n// Options: `parentView`\nBlaze._HTMLJSExpander = HTML.TransformingVisitor.extend();\nBlaze._HTMLJSExpander.def({\n  visitObject: function (x) {\n    if (x instanceof Blaze.Template)\n      x = x.constructView();\n    if (x instanceof Blaze.View)\n      return Blaze._expandView(x, this.parentView);\n\n    // this will throw an error; other objects are not allowed!\n    return HTML.TransformingVisitor.prototype.visitObject.call(this, x);\n  },\n  visitAttributes: function (attrs) {\n    // expand dynamic attributes\n    if (typeof attrs === 'function')\n      attrs = Blaze._withCurrentView(this.parentView, attrs);\n\n    // call super (e.g. for case where `attrs` is an array)\n    return HTML.TransformingVisitor.prototype.visitAttributes.call(this, attrs);\n  },\n  visitAttribute: function (name, value, tag) {\n    // expand attribute values that are functions.  Any attribute value\n    // that contains Views must be wrapped in a function.\n    if (typeof value === 'function')\n      value = Blaze._withCurrentView(this.parentView, value);\n\n    return HTML.TransformingVisitor.prototype.visitAttribute.call(\n      this, name, value, tag);\n  }\n});\n\n// Return Blaze.currentView, but only if it is being rendered\n// (i.e. we are in its render() method).\nvar currentViewIfRendering = function () {\n  var view = Blaze.currentView;\n  return (view && view._isInRender) ? view : null;\n};\n\nBlaze._expand = function (htmljs, parentView) {\n  parentView = parentView || currentViewIfRendering();\n  return (new Blaze._HTMLJSExpander(\n    {parentView: parentView})).visit(htmljs);\n};\n\nBlaze._expandAttributes = function (attrs, parentView) {\n  parentView = parentView || currentViewIfRendering();\n  return (new Blaze._HTMLJSExpander(\n    {parentView: parentView})).visitAttributes(attrs);\n};\n\nBlaze._destroyView = function (view, _skipNodes) {\n  if (view.isDestroyed)\n    return;\n  view.isDestroyed = true;\n\n  Blaze._fireCallbacks(view, 'destroyed');\n\n  // Destroy views and elements recursively.  If _skipNodes,\n  // only recurse up to views, not elements, for the case where\n  // the backend (jQuery) is recursing over the elements already.\n\n  if (view._domrange)\n    view._domrange.destroyMembers(_skipNodes);\n};\n\nBlaze._destroyNode = function (node) {\n  if (node.nodeType === 1)\n    Blaze._DOMBackend.Teardown.tearDownElement(node);\n};\n\n// Are the HTMLjs entities `a` and `b` the same?  We could be\n// more elaborate here but the point is to catch the most basic\n// cases.\nBlaze._isContentEqual = function (a, b) {\n  if (a instanceof HTML.Raw) {\n    return (b instanceof HTML.Raw) && (a.value === b.value);\n  } else if (a == null) {\n    return (b == null);\n  } else {\n    return (a === b) &&\n      ((typeof a === 'number') || (typeof a === 'boolean') ||\n       (typeof a === 'string'));\n  }\n};\n\n/**\n * @summary The View corresponding to the current template helper, event handler, callback, or autorun.  If there isn't one, `null`.\n * @locus Client\n * @type {Blaze.View}\n */\nBlaze.currentView = null;\n\nBlaze._withCurrentView = function (view, func) {\n  var oldView = Blaze.currentView;\n  try {\n    Blaze.currentView = view;\n    return func();\n  } finally {\n    Blaze.currentView = oldView;\n  }\n};\n\n// Blaze.render publicly takes a View or a Template.\n// Privately, it takes any HTMLJS (extended with Views and Templates)\n// except null or undefined, or a function that returns any extended\n// HTMLJS.\nvar checkRenderContent = function (content) {\n  if (content === null)\n    throw new Error(\"Can't render null\");\n  if (typeof content === 'undefined')\n    throw new Error(\"Can't render undefined\");\n\n  if ((content instanceof Blaze.View) ||\n      (content instanceof Blaze.Template) ||\n      (typeof content === 'function'))\n    return;\n\n  try {\n    // Throw if content doesn't look like HTMLJS at the top level\n    // (i.e. verify that this is an HTML.Tag, or an array,\n    // or a primitive, etc.)\n    (new HTML.Visitor).visit(content);\n  } catch (e) {\n    // Make error message suitable for public API\n    throw new Error(\"Expected Template or View\");\n  }\n};\n\n// For Blaze.render and Blaze.toHTML, take content and\n// wrap it in a View, unless it's a single View or\n// Template already.\nvar contentAsView = function (content) {\n  checkRenderContent(content);\n\n  if (content instanceof Blaze.Template) {\n    return content.constructView();\n  } else if (content instanceof Blaze.View) {\n    return content;\n  } else {\n    var func = content;\n    if (typeof func !== 'function') {\n      func = function () {\n        return content;\n      };\n    }\n    return Blaze.View('render', func);\n  }\n};\n\n// For Blaze.renderWithData and Blaze.toHTMLWithData, wrap content\n// in a function, if necessary, so it can be a content arg to\n// a Blaze.With.\nvar contentAsFunc = function (content) {\n  checkRenderContent(content);\n\n  if (typeof content !== 'function') {\n    return function () {\n      return content;\n    };\n  } else {\n    return content;\n  }\n};\n\nBlaze.__rootViews = [];\n\n/**\n * @summary Renders a template or View to DOM nodes and inserts it into the DOM, returning a rendered [View](#Blaze-View) which can be passed to [`Blaze.remove`](#Blaze-remove).\n * @locus Client\n * @param {Template|Blaze.View} templateOrView The template (e.g. `Template.myTemplate`) or View object to render.  If a template, a View object is [constructed](#template_constructview).  If a View, it must be an unrendered View, which becomes a rendered View and is returned.\n * @param {DOMNode} parentNode The node that will be the parent of the rendered template.  It must be an Element node.\n * @param {DOMNode} [nextNode] Optional. If provided, must be a child of <em>parentNode</em>; the template will be inserted before this node. If not provided, the template will be inserted as the last child of parentNode.\n * @param {Blaze.View} [parentView] Optional. If provided, it will be set as the rendered View's [`parentView`](#view_parentview).\n */\nBlaze.render = function (content, parentElement, nextNode, parentView) {\n  if (! parentElement) {\n    Blaze._warn(\"Blaze.render without a parent element is deprecated. \" +\n                \"You must specify where to insert the rendered content.\");\n  }\n\n  if (nextNode instanceof Blaze.View) {\n    // handle omitted nextNode\n    parentView = nextNode;\n    nextNode = null;\n  }\n\n  // parentElement must be a DOM node. in particular, can't be the\n  // result of a call to `$`. Can't check if `parentElement instanceof\n  // Node` since 'Node' is undefined in IE8.\n  if (parentElement && typeof parentElement.nodeType !== 'number')\n    throw new Error(\"'parentElement' must be a DOM node\");\n  if (nextNode && typeof nextNode.nodeType !== 'number') // 'nextNode' is optional\n    throw new Error(\"'nextNode' must be a DOM node\");\n\n  parentView = parentView || currentViewIfRendering();\n\n  var view = contentAsView(content);\n\n  // TODO: this is only needed in development\n  if (!parentView) {\n    view.onViewCreated(function () {\n      Blaze.__rootViews.push(view);\n    });\n\n    view.onViewDestroyed(function () {\n      var index = Blaze.__rootViews.indexOf(view);\n      if (index > -1) {\n        Blaze.__rootViews.splice(index, 1);\n      }\n    });\n  }\n\n  Blaze._materializeView(view, parentView);\n  if (parentElement) {\n    view._domrange.attach(parentElement, nextNode);\n  }\n\n  return view;\n};\n\nBlaze.insert = function (view, parentElement, nextNode) {\n  Blaze._warn(\"Blaze.insert has been deprecated.  Specify where to insert the \" +\n              \"rendered content in the call to Blaze.render.\");\n\n  if (! (view && (view._domrange instanceof Blaze._DOMRange)))\n    throw new Error(\"Expected template rendered with Blaze.render\");\n\n  view._domrange.attach(parentElement, nextNode);\n};\n\n/**\n * @summary Renders a template or View to DOM nodes with a data context.  Otherwise identical to `Blaze.render`.\n * @locus Client\n * @param {Template|Blaze.View} templateOrView The template (e.g. `Template.myTemplate`) or View object to render.\n * @param {Object|Function} data The data context to use, or a function returning a data context.  If a function is provided, it will be reactively re-run.\n * @param {DOMNode} parentNode The node that will be the parent of the rendered template.  It must be an Element node.\n * @param {DOMNode} [nextNode] Optional. If provided, must be a child of <em>parentNode</em>; the template will be inserted before this node. If not provided, the template will be inserted as the last child of parentNode.\n * @param {Blaze.View} [parentView] Optional. If provided, it will be set as the rendered View's [`parentView`](#view_parentview).\n */\nBlaze.renderWithData = function (content, data, parentElement, nextNode, parentView) {\n  // We defer the handling of optional arguments to Blaze.render.  At this point,\n  // `nextNode` may actually be `parentView`.\n  return Blaze.render(Blaze._TemplateWith(data, contentAsFunc(content)),\n                          parentElement, nextNode, parentView);\n};\n\n/**\n * @summary Removes a rendered View from the DOM, stopping all reactive updates and event listeners on it. Also destroys the Blaze.Template instance associated with the view.\n * @locus Client\n * @param {Blaze.View} renderedView The return value from `Blaze.render` or `Blaze.renderWithData`, or the `view` property of a Blaze.Template instance. Calling `Blaze.remove(Template.instance().view)` from within a template event handler will destroy the view as well as that template and trigger the template's `onDestroyed` handlers.\n */\nBlaze.remove = function (view) {\n  if (! (view && (view._domrange instanceof Blaze._DOMRange)))\n    throw new Error(\"Expected template rendered with Blaze.render\");\n\n  while (view) {\n    if (! view.isDestroyed) {\n      var range = view._domrange;\n      if (range.attached && ! range.parentRange)\n        range.detach();\n      range.destroy();\n    }\n\n    view = view._hasGeneratedParent && view.parentView;\n  }\n};\n\n/**\n * @summary Renders a template or View to a string of HTML.\n * @locus Client\n * @param {Template|Blaze.View} templateOrView The template (e.g. `Template.myTemplate`) or View object from which to generate HTML.\n */\nBlaze.toHTML = function (content, parentView) {\n  parentView = parentView || currentViewIfRendering();\n\n  return HTML.toHTML(Blaze._expandView(contentAsView(content), parentView));\n};\n\n/**\n * @summary Renders a template or View to HTML with a data context.  Otherwise identical to `Blaze.toHTML`.\n * @locus Client\n * @param {Template|Blaze.View} templateOrView The template (e.g. `Template.myTemplate`) or View object from which to generate HTML.\n * @param {Object|Function} data The data context to use, or a function returning a data context.\n */\nBlaze.toHTMLWithData = function (content, data, parentView) {\n  parentView = parentView || currentViewIfRendering();\n\n  return HTML.toHTML(Blaze._expandView(Blaze._TemplateWith(\n    data, contentAsFunc(content)), parentView));\n};\n\nBlaze._toText = function (htmljs, parentView, textMode) {\n  if (typeof htmljs === 'function')\n    throw new Error(\"Blaze._toText doesn't take a function, just HTMLjs\");\n\n  if ((parentView != null) && ! (parentView instanceof Blaze.View)) {\n    // omitted parentView argument\n    textMode = parentView;\n    parentView = null;\n  }\n  parentView = parentView || currentViewIfRendering();\n\n  if (! textMode)\n    throw new Error(\"textMode required\");\n  if (! (textMode === HTML.TEXTMODE.STRING ||\n         textMode === HTML.TEXTMODE.RCDATA ||\n         textMode === HTML.TEXTMODE.ATTRIBUTE))\n    throw new Error(\"Unknown textMode: \" + textMode);\n\n  return HTML.toText(Blaze._expand(htmljs, parentView), textMode);\n};\n\n/**\n * @summary Returns the current data context, or the data context that was used when rendering a particular DOM element or View from a Meteor template.\n * @locus Client\n * @param {DOMElement|Blaze.View} [elementOrView] Optional.  An element that was rendered by a Meteor, or a View.\n */\nBlaze.getData = function (elementOrView) {\n  var theWith;\n\n  if (! elementOrView) {\n    theWith = Blaze.getView('with');\n  } else if (elementOrView instanceof Blaze.View) {\n    var view = elementOrView;\n    theWith = (view.name === 'with' ? view :\n               Blaze.getView(view, 'with'));\n  } else if (typeof elementOrView.nodeType === 'number') {\n    if (elementOrView.nodeType !== 1)\n      throw new Error(\"Expected DOM element\");\n    theWith = Blaze.getView(elementOrView, 'with');\n  } else {\n    throw new Error(\"Expected DOM element or View\");\n  }\n\n  return theWith ? theWith.dataVar.get() : null;\n};\n\n// For back-compat\nBlaze.getElementData = function (element) {\n  Blaze._warn(\"Blaze.getElementData has been deprecated.  Use \" +\n              \"Blaze.getData(element) instead.\");\n\n  if (element.nodeType !== 1)\n    throw new Error(\"Expected DOM element\");\n\n  return Blaze.getData(element);\n};\n\n// Both arguments are optional.\n\n/**\n * @summary Gets either the current View, or the View enclosing the given DOM element.\n * @locus Client\n * @param {DOMElement} [element] Optional.  If specified, the View enclosing `element` is returned.\n */\nBlaze.getView = function (elementOrView, _viewName) {\n  var viewName = _viewName;\n\n  if ((typeof elementOrView) === 'string') {\n    // omitted elementOrView; viewName present\n    viewName = elementOrView;\n    elementOrView = null;\n  }\n\n  // We could eventually shorten the code by folding the logic\n  // from the other methods into this method.\n  if (! elementOrView) {\n    return Blaze._getCurrentView(viewName);\n  } else if (elementOrView instanceof Blaze.View) {\n    return Blaze._getParentView(elementOrView, viewName);\n  } else if (typeof elementOrView.nodeType === 'number') {\n    return Blaze._getElementView(elementOrView, viewName);\n  } else {\n    throw new Error(\"Expected DOM element or View\");\n  }\n};\n\n// Gets the current view or its nearest ancestor of name\n// `name`.\nBlaze._getCurrentView = function (name) {\n  var view = Blaze.currentView;\n  // Better to fail in cases where it doesn't make sense\n  // to use Blaze._getCurrentView().  There will be a current\n  // view anywhere it does.  You can check Blaze.currentView\n  // if you want to know whether there is one or not.\n  if (! view)\n    throw new Error(\"There is no current view\");\n\n  if (name) {\n    while (view && view.name !== name)\n      view = view.parentView;\n    return view || null;\n  } else {\n    // Blaze._getCurrentView() with no arguments just returns\n    // Blaze.currentView.\n    return view;\n  }\n};\n\nBlaze._getParentView = function (view, name) {\n  var v = view.parentView;\n\n  if (name) {\n    while (v && v.name !== name)\n      v = v.parentView;\n  }\n\n  return v || null;\n};\n\nBlaze._getElementView = function (elem, name) {\n  var range = Blaze._DOMRange.forElement(elem);\n  var view = null;\n  while (range && ! view) {\n    view = (range.view || null);\n    if (! view) {\n      if (range.parentRange)\n        range = range.parentRange;\n      else\n        range = Blaze._DOMRange.forElement(range.parentElement);\n    }\n  }\n\n  if (name) {\n    while (view && view.name !== name)\n      view = view.parentView;\n    return view || null;\n  } else {\n    return view;\n  }\n};\n\nBlaze._addEventMap = function (view, eventMap, thisInHandler) {\n  thisInHandler = (thisInHandler || null);\n  var handles = [];\n\n  if (! view._domrange)\n    throw new Error(\"View must have a DOMRange\");\n\n  view._domrange.onAttached(function attached_eventMaps(range, element) {\n    Object.keys(eventMap).forEach(function (spec) {\n      let handler = eventMap[spec];\n      var clauses = spec.split(/,\\s+/);\n      // iterate over clauses of spec, e.g. ['click .foo', 'click .bar']\n      clauses.forEach(function (clause) {\n        var parts = clause.split(/\\s+/);\n        if (parts.length === 0)\n          return;\n\n        var newEvents = parts.shift();\n        var selector = parts.join(' ');\n        handles.push(Blaze._EventSupport.listen(\n          element, newEvents, selector,\n          function (evt) {\n            if (! range.containsElement(evt.currentTarget))\n              return null;\n            var handlerThis = thisInHandler || this;\n            var handlerArgs = arguments;\n            return Blaze._withCurrentView(view, function () {\n              return handler.apply(handlerThis, handlerArgs);\n            });\n          },\n          range, function (r) {\n            return r.parentRange;\n          }));\n      });\n    });\n  });\n\n  view.onViewDestroyed(function () {\n    handles.forEach(function (h) {\n      h.stop();\n    });\n    handles.length = 0;\n  });\n};\n","import has from 'lodash.has';\nimport isObject from 'lodash.isobject';\n\nBlaze._calculateCondition = function (cond) {\n  if (HTML.isArray(cond) && cond.length === 0)\n    cond = false;\n  return !! cond;\n};\n\n/**\n * @summary Constructs a View that renders content with a data context.\n * @locus Client\n * @param {Object|Function} data An object to use as the data context, or a function returning such an object.  If a function is provided, it will be reactively re-run.\n * @param {Function} contentFunc A Function that returns [*renderable content*](#Renderable-Content).\n */\nBlaze.With = function (data, contentFunc) {\n  var view = Blaze.View('with', contentFunc);\n\n  view.dataVar = new ReactiveVar;\n\n  view.onViewCreated(function () {\n    if (typeof data === 'function') {\n      // `data` is a reactive function\n      view.autorun(function () {\n        view.dataVar.set(data());\n      }, view.parentView, 'setData');\n    } else {\n      view.dataVar.set(data);\n    }\n  });\n\n  return view;\n};\n\n/**\n * Attaches bindings to the instantiated view.\n * @param {Object} bindings A dictionary of bindings, each binding name\n * corresponds to a value or a function that will be reactively re-run.\n * @param {View} view The target.\n */\nBlaze._attachBindingsToView = function (bindings, view) {\n  view.onViewCreated(function () {\n    Object.entries(bindings).forEach(function ([name, binding]) {\n      view._scopeBindings[name] = new ReactiveVar();\n      if (typeof binding === 'function') {\n        view.autorun(function () {\n          view._scopeBindings[name].set(binding());\n        }, view.parentView);\n      } else {\n        view._scopeBindings[name].set(binding);\n      }\n    });\n  });\n};\n\n/**\n * @summary Constructs a View setting the local lexical scope in the block.\n * @param {Function} bindings Dictionary mapping names of bindings to\n * values or computations to reactively re-run.\n * @param {Function} contentFunc A Function that returns [*renderable content*](#Renderable-Content).\n */\nBlaze.Let = function (bindings, contentFunc) {\n  var view = Blaze.View('let', contentFunc);\n  Blaze._attachBindingsToView(bindings, view);\n\n  return view;\n};\n\n/**\n * @summary Constructs a View that renders content conditionally.\n * @locus Client\n * @param {Function} conditionFunc A function to reactively re-run.  Whether the result is truthy or falsy determines whether `contentFunc` or `elseFunc` is shown.  An empty array is considered falsy.\n * @param {Function} contentFunc A Function that returns [*renderable content*](#Renderable-Content).\n * @param {Function} [elseFunc] Optional.  A Function that returns [*renderable content*](#Renderable-Content).  If no `elseFunc` is supplied, no content is shown in the \"else\" case.\n */\nBlaze.If = function (conditionFunc, contentFunc, elseFunc, _not) {\n  var conditionVar = new ReactiveVar;\n\n  var view = Blaze.View(_not ? 'unless' : 'if', function () {\n    return conditionVar.get() ? contentFunc() :\n      (elseFunc ? elseFunc() : null);\n  });\n  view.__conditionVar = conditionVar;\n  view.onViewCreated(function () {\n    this.autorun(function () {\n      var cond = Blaze._calculateCondition(conditionFunc());\n      conditionVar.set(_not ? (! cond) : cond);\n    }, this.parentView, 'condition');\n  });\n\n  return view;\n};\n\n/**\n * @summary An inverted [`Blaze.If`](#Blaze-If).\n * @locus Client\n * @param {Function} conditionFunc A function to reactively re-run.  If the result is falsy, `contentFunc` is shown, otherwise `elseFunc` is shown.  An empty array is considered falsy.\n * @param {Function} contentFunc A Function that returns [*renderable content*](#Renderable-Content).\n * @param {Function} [elseFunc] Optional.  A Function that returns [*renderable content*](#Renderable-Content).  If no `elseFunc` is supplied, no content is shown in the \"else\" case.\n */\nBlaze.Unless = function (conditionFunc, contentFunc, elseFunc) {\n  return Blaze.If(conditionFunc, contentFunc, elseFunc, true /*_not*/);\n};\n\n/**\n * @summary Constructs a View that renders `contentFunc` for each item in a sequence.\n * @locus Client\n * @param {Function} argFunc A function to reactively re-run. The function can\n * return one of two options:\n *\n * 1. An object with two fields: '_variable' and '_sequence'. Each iterates over\n *   '_sequence', it may be a Cursor, an array, null, or undefined. Inside the\n *   Each body you will be able to get the current item from the sequence using\n *   the name specified in the '_variable' field.\n *\n * 2. Just a sequence (Cursor, array, null, or undefined) not wrapped into an\n *   object. Inside the Each body, the current item will be set as the data\n *   context.\n * @param {Function} contentFunc A Function that returns  [*renderable\n * content*](#Renderable-Content).\n * @param {Function} [elseFunc] A Function that returns [*renderable\n * content*](#Renderable-Content) to display in the case when there are no items\n * in the sequence.\n */\nBlaze.Each = function (argFunc, contentFunc, elseFunc) {\n  var eachView = Blaze.View('each', function () {\n    var subviews = this.initialSubviews;\n    this.initialSubviews = null;\n    if (this._isCreatedForExpansion) {\n      this.expandedValueDep = new Tracker.Dependency;\n      this.expandedValueDep.depend();\n    }\n    return subviews;\n  });\n  eachView.initialSubviews = [];\n  eachView.numItems = 0;\n  eachView.inElseMode = false;\n  eachView.stopHandle = null;\n  eachView.contentFunc = contentFunc;\n  eachView.elseFunc = elseFunc;\n  eachView.argVar = new ReactiveVar;\n  eachView.variableName = null;\n\n  // update the @index value in the scope of all subviews in the range\n  var updateIndices = function (from, to) {\n    if (to === undefined) {\n      to = eachView.numItems - 1;\n    }\n\n    for (var i = from; i <= to; i++) {\n      var view = eachView._domrange.members[i].view;\n      view._scopeBindings['@index'].set(i);\n    }\n  };\n\n  eachView.onViewCreated(function () {\n    // We evaluate argFunc in an autorun to make sure\n    // Blaze.currentView is always set when it runs (rather than\n    // passing argFunc straight to ObserveSequence).\n    eachView.autorun(function () {\n      // argFunc can return either a sequence as is or a wrapper object with a\n      // _sequence and _variable fields set.\n      var arg = argFunc();\n      if (isObject(arg) && has(arg, '_sequence')) {\n        eachView.variableName = arg._variable || null;\n        arg = arg._sequence;\n      }\n\n      eachView.argVar.set(arg);\n    }, eachView.parentView, 'collection');\n\n    eachView.stopHandle = ObserveSequence.observe(function () {\n      return eachView.argVar.get();\n    }, {\n      addedAt: function (id, item, index) {\n        Tracker.nonreactive(function () {\n          var newItemView;\n          if (eachView.variableName) {\n            // new-style #each (as in {{#each item in items}})\n            // doesn't create a new data context\n            newItemView = Blaze.View('item', eachView.contentFunc);\n          } else {\n            newItemView = Blaze.With(item, eachView.contentFunc);\n          }\n\n          eachView.numItems++;\n\n          var bindings = {};\n          bindings['@index'] = index;\n          if (eachView.variableName) {\n            bindings[eachView.variableName] = item;\n          }\n          Blaze._attachBindingsToView(bindings, newItemView);\n\n          if (eachView.expandedValueDep) {\n            eachView.expandedValueDep.changed();\n          } else if (eachView._domrange) {\n            if (eachView.inElseMode) {\n              eachView._domrange.removeMember(0);\n              eachView.inElseMode = false;\n            }\n\n            var range = Blaze._materializeView(newItemView, eachView);\n            eachView._domrange.addMember(range, index);\n            updateIndices(index);\n          } else {\n            eachView.initialSubviews.splice(index, 0, newItemView);\n          }\n        });\n      },\n      removedAt: function (id, item, index) {\n        Tracker.nonreactive(function () {\n          eachView.numItems--;\n          if (eachView.expandedValueDep) {\n            eachView.expandedValueDep.changed();\n          } else if (eachView._domrange) {\n            eachView._domrange.removeMember(index);\n            updateIndices(index);\n            if (eachView.elseFunc && eachView.numItems === 0) {\n              eachView.inElseMode = true;\n              eachView._domrange.addMember(\n                Blaze._materializeView(\n                  Blaze.View('each_else',eachView.elseFunc),\n                  eachView), 0);\n            }\n          } else {\n            eachView.initialSubviews.splice(index, 1);\n          }\n        });\n      },\n      changedAt: function (id, newItem, oldItem, index) {\n        Tracker.nonreactive(function () {\n          if (eachView.expandedValueDep) {\n            eachView.expandedValueDep.changed();\n          } else {\n            var itemView;\n            if (eachView._domrange) {\n              itemView = eachView._domrange.getMember(index).view;\n            } else {\n              itemView = eachView.initialSubviews[index];\n            }\n            if (eachView.variableName) {\n              itemView._scopeBindings[eachView.variableName].set(newItem);\n            } else {\n              itemView.dataVar.set(newItem);\n            }\n          }\n        });\n      },\n      movedTo: function (id, item, fromIndex, toIndex) {\n        Tracker.nonreactive(function () {\n          if (eachView.expandedValueDep) {\n            eachView.expandedValueDep.changed();\n          } else if (eachView._domrange) {\n            eachView._domrange.moveMember(fromIndex, toIndex);\n            updateIndices(\n              Math.min(fromIndex, toIndex), Math.max(fromIndex, toIndex));\n          } else {\n            var subviews = eachView.initialSubviews;\n            var itemView = subviews[fromIndex];\n            subviews.splice(fromIndex, 1);\n            subviews.splice(toIndex, 0, itemView);\n          }\n        });\n      }\n    });\n\n    if (eachView.elseFunc && eachView.numItems === 0) {\n      eachView.inElseMode = true;\n      eachView.initialSubviews[0] =\n        Blaze.View('each_else', eachView.elseFunc);\n    }\n  });\n\n  eachView.onViewDestroyed(function () {\n    if (eachView.stopHandle)\n      eachView.stopHandle.stop();\n  });\n\n  return eachView;\n};\n\nBlaze._TemplateWith = function (arg, contentFunc) {\n  var w;\n\n  var argFunc = arg;\n  if (typeof arg !== 'function') {\n    argFunc = function () {\n      return arg;\n    };\n  }\n\n  // This is a little messy.  When we compile `{{> Template.contentBlock}}`, we\n  // wrap it in Blaze._InOuterTemplateScope in order to skip the intermediate\n  // parent Views in the current template.  However, when there's an argument\n  // (`{{> Template.contentBlock arg}}`), the argument needs to be evaluated\n  // in the original scope.  There's no good order to nest\n  // Blaze._InOuterTemplateScope and Spacebars.TemplateWith to achieve this,\n  // so we wrap argFunc to run it in the \"original parentView\" of the\n  // Blaze._InOuterTemplateScope.\n  //\n  // To make this better, reconsider _InOuterTemplateScope as a primitive.\n  // Longer term, evaluate expressions in the proper lexical scope.\n  var wrappedArgFunc = function () {\n    var viewToEvaluateArg = null;\n    if (w.parentView && w.parentView.name === 'InOuterTemplateScope') {\n      viewToEvaluateArg = w.parentView.originalParentView;\n    }\n    if (viewToEvaluateArg) {\n      return Blaze._withCurrentView(viewToEvaluateArg, argFunc);\n    } else {\n      return argFunc();\n    }\n  };\n\n  var wrappedContentFunc = function () {\n    var content = contentFunc.call(this);\n\n    // Since we are generating the Blaze._TemplateWith view for the\n    // user, set the flag on the child view.  If `content` is a template,\n    // construct the View so that we can set the flag.\n    if (content instanceof Blaze.Template) {\n      content = content.constructView();\n    }\n    if (content instanceof Blaze.View) {\n      content._hasGeneratedParent = true;\n    }\n\n    return content;\n  };\n\n  w = Blaze.With(wrappedArgFunc, wrappedContentFunc);\n  w.__isTemplateWith = true;\n  return w;\n};\n\nBlaze._InOuterTemplateScope = function (templateView, contentFunc) {\n  var view = Blaze.View('InOuterTemplateScope', contentFunc);\n  var parentView = templateView.parentView;\n\n  // Hack so that if you call `{{> foo bar}}` and it expands into\n  // `{{#with bar}}{{> foo}}{{/with}}`, and then `foo` is a template\n  // that inserts `{{> Template.contentBlock}}`, the data context for\n  // `Template.contentBlock` is not `bar` but the one enclosing that.\n  if (parentView.__isTemplateWith)\n    parentView = parentView.parentView;\n\n  view.onViewCreated(function () {\n    this.originalParentView = this.parentView;\n    this.parentView = parentView;\n    this.__childDoesntStartNewLexicalScope = true;\n  });\n  return view;\n};\n\n// XXX COMPAT WITH 0.9.0\nBlaze.InOuterTemplateScope = Blaze._InOuterTemplateScope;\n","import has from 'lodash.has';\n\nBlaze._globalHelpers = {};\n\n// Documented as Template.registerHelper.\n// This definition also provides back-compat for `UI.registerHelper`.\nBlaze.registerHelper = function (name, func) {\n  Blaze._globalHelpers[name] = func;\n};\n\n// Also documented as Template.deregisterHelper\nBlaze.deregisterHelper = function(name) {\n  delete Blaze._globalHelpers[name];\n};\n\nvar bindIfIsFunction = function (x, target) {\n  if (typeof x !== 'function')\n    return x;\n  return Blaze._bind(x, target);\n};\n\n// If `x` is a function, binds the value of `this` for that function\n// to the current data context.\nvar bindDataContext = function (x) {\n  if (typeof x === 'function') {\n    return function () {\n      var data = Blaze.getData();\n      if (data == null)\n        data = {};\n      return x.apply(data, arguments);\n    };\n  }\n  return x;\n};\n\nBlaze._OLDSTYLE_HELPER = {};\n\nBlaze._getTemplateHelper = function (template, name, tmplInstanceFunc) {\n  // XXX COMPAT WITH 0.9.3\n  var isKnownOldStyleHelper = false;\n\n  if (template.__helpers.has(name)) {\n    var helper = template.__helpers.get(name);\n    if (helper === Blaze._OLDSTYLE_HELPER) {\n      isKnownOldStyleHelper = true;\n    } else if (helper != null) {\n      return wrapHelper(bindDataContext(helper), tmplInstanceFunc);\n    } else {\n      return null;\n    }\n  }\n\n  // old-style helper\n  if (name in template) {\n    // Only warn once per helper\n    if (! isKnownOldStyleHelper) {\n      template.__helpers.set(name, Blaze._OLDSTYLE_HELPER);\n      if (! template._NOWARN_OLDSTYLE_HELPERS) {\n        Blaze._warn('Assigning helper with `' + template.viewName + '.' +\n                    name + ' = ...` is deprecated.  Use `' + template.viewName +\n                    '.helpers(...)` instead.');\n      }\n    }\n    if (template[name] != null) {\n      return wrapHelper(bindDataContext(template[name]), tmplInstanceFunc);\n    }\n  }\n\n  return null;\n};\n\nvar wrapHelper = function (f, templateFunc) {\n  if (typeof f !== \"function\") {\n    return f;\n  }\n\n  return function () {\n    var self = this;\n    var args = arguments;\n\n    return Blaze.Template._withTemplateInstanceFunc(templateFunc, function () {\n      return Blaze._wrapCatchingExceptions(f, 'template helper').apply(self, args);\n    });\n  };\n};\n\nBlaze._lexicalBindingLookup = function (view, name) {\n  var currentView = view;\n  var blockHelpersStack = [];\n\n  // walk up the views stopping at a Spacebars.include or Template view that\n  // doesn't have an InOuterTemplateScope view as a parent\n  do {\n    // skip block helpers views\n    // if we found the binding on the scope, return it\n    if (has(currentView._scopeBindings, name)) {\n      var bindingReactiveVar = currentView._scopeBindings[name];\n      return function () {\n        return bindingReactiveVar.get();\n      };\n    }\n  } while (! (currentView.__startsNewLexicalScope &&\n              ! (currentView.parentView &&\n                 currentView.parentView.__childDoesntStartNewLexicalScope))\n           && (currentView = currentView.parentView));\n\n  return null;\n};\n\n// templateInstance argument is provided to be available for possible\n// alternative implementations of this function by 3rd party packages.\nBlaze._getTemplate = function (name, templateInstance) {\n  if ((name in Blaze.Template) && (Blaze.Template[name] instanceof Blaze.Template)) {\n    return Blaze.Template[name];\n  }\n  return null;\n};\n\nBlaze._getGlobalHelper = function (name, templateInstance) {\n  if (Blaze._globalHelpers[name] != null) {\n    return wrapHelper(bindDataContext(Blaze._globalHelpers[name]), templateInstance);\n  }\n  return null;\n};\n\n// Looks up a name, like \"foo\" or \"..\", as a helper of the\n// current template; the name of a template; a global helper;\n// or a property of the data context.  Called on the View of\n// a template (i.e. a View with a `.template` property,\n// where the helpers are).  Used for the first name in a\n// \"path\" in a template tag, like \"foo\" in `{{foo.bar}}` or\n// \"..\" in `{{frobulate ../blah}}`.\n//\n// Returns a function, a non-function value, or null.  If\n// a function is found, it is bound appropriately.\n//\n// NOTE: This function must not establish any reactive\n// dependencies itself.  If there is any reactivity in the\n// value, lookup should return a function.\nBlaze.View.prototype.lookup = function (name, _options) {\n  var template = this.template;\n  var lookupTemplate = _options && _options.template;\n  var helper;\n  var binding;\n  var boundTmplInstance;\n  var foundTemplate;\n\n  if (this.templateInstance) {\n    boundTmplInstance = Blaze._bind(this.templateInstance, this);\n  }\n\n  // 0. looking up the parent data context with the special \"../\" syntax\n  if (/^\\./.test(name)) {\n    // starts with a dot. must be a series of dots which maps to an\n    // ancestor of the appropriate height.\n    if (!/^(\\.)+$/.test(name))\n      throw new Error(\"id starting with dot must be a series of dots\");\n\n    return Blaze._parentData(name.length - 1, true /*_functionWrapped*/);\n\n  }\n\n  // 1. look up a helper on the current template\n  if (template && ((helper = Blaze._getTemplateHelper(template, name, boundTmplInstance)) != null)) {\n    return helper;\n  }\n\n  // 2. look up a binding by traversing the lexical view hierarchy inside the\n  // current template\n  if (template && (binding = Blaze._lexicalBindingLookup(Blaze.currentView, name)) != null) {\n    return binding;\n  }\n\n  // 3. look up a template by name\n  if (lookupTemplate && ((foundTemplate = Blaze._getTemplate(name, boundTmplInstance)) != null)) {\n    return foundTemplate;\n  }\n\n  // 4. look up a global helper\n  if ((helper = Blaze._getGlobalHelper(name, boundTmplInstance)) != null) {\n    return helper;\n  }\n\n  // 5. look up in a data context\n  return function () {\n    var isCalledAsFunction = (arguments.length > 0);\n    var data = Blaze.getData();\n    var x = data && data[name];\n    if (! x) {\n      if (lookupTemplate) {\n        throw new Error(\"No such template: \" + name);\n      } else if (isCalledAsFunction) {\n        throw new Error(\"No such function: \" + name);\n      } else if (name.charAt(0) === '@' && ((x === null) ||\n                                            (x === undefined))) {\n        // Throw an error if the user tries to use a `@directive`\n        // that doesn't exist.  We don't implement all directives\n        // from Handlebars, so there's a potential for confusion\n        // if we fail silently.  On the other hand, we want to\n        // throw late in case some app or package wants to provide\n        // a missing directive.\n        throw new Error(\"Unsupported directive: \" + name);\n      }\n    }\n    if (! data) {\n      return null;\n    }\n    if (typeof x !== 'function') {\n      if (isCalledAsFunction) {\n        throw new Error(\"Can't call non-function: \" + x);\n      }\n      return x;\n    }\n    return x.apply(data, arguments);\n  };\n};\n\n// Implement Spacebars' {{../..}}.\n// @param height {Number} The number of '..'s\nBlaze._parentData = function (height, _functionWrapped) {\n  // If height is null or undefined, we default to 1, the first parent.\n  if (height == null) {\n    height = 1;\n  }\n  var theWith = Blaze.getView('with');\n  for (var i = 0; (i < height) && theWith; i++) {\n    theWith = Blaze.getView(theWith, 'with');\n  }\n\n  if (! theWith)\n    return null;\n  if (_functionWrapped)\n    return function () { return theWith.dataVar.get(); };\n  return theWith.dataVar.get();\n};\n\n\nBlaze.View.prototype.lookupTemplate = function (name) {\n  return this.lookup(name, {template:true});\n};\n","import isObject from 'lodash.isobject';\nimport isFunction from 'lodash.isfunction';\nimport has from 'lodash.has';\nimport isEmpty from 'lodash.isempty';\n\n// [new] Blaze.Template([viewName], renderFunction)\n//\n// `Blaze.Template` is the class of templates, like `Template.foo` in\n// Meteor, which is `instanceof Template`.\n//\n// `viewKind` is a string that looks like \"Template.foo\" for templates\n// defined by the compiler.\n\n/**\n * @class\n * @summary Constructor for a Template, which is used to construct Views with particular name and content.\n * @locus Client\n * @param {String} [viewName] Optional.  A name for Views constructed by this Template.  See [`view.name`](#view_name).\n * @param {Function} renderFunction A function that returns [*renderable content*](#Renderable-Content).  This function is used as the `renderFunction` for Views constructed by this Template.\n */\nBlaze.Template = function (viewName, renderFunction) {\n  if (! (this instanceof Blaze.Template))\n    // called without `new`\n    return new Blaze.Template(viewName, renderFunction);\n\n  if (typeof viewName === 'function') {\n    // omitted \"viewName\" argument\n    renderFunction = viewName;\n    viewName = '';\n  }\n  if (typeof viewName !== 'string')\n    throw new Error(\"viewName must be a String (or omitted)\");\n  if (typeof renderFunction !== 'function')\n    throw new Error(\"renderFunction must be a function\");\n\n  this.viewName = viewName;\n  this.renderFunction = renderFunction;\n\n  this.__helpers = new HelperMap;\n  this.__eventMaps = [];\n\n  this._callbacks = {\n    created: [],\n    rendered: [],\n    destroyed: []\n  };\n};\nvar Template = Blaze.Template;\n\nvar HelperMap = function () {};\nHelperMap.prototype.get = function (name) {\n  return this[' '+name];\n};\nHelperMap.prototype.set = function (name, helper) {\n  this[' '+name] = helper;\n};\nHelperMap.prototype.has = function (name) {\n  return (typeof this[' '+name] !== 'undefined');\n};\n\n/**\n * @summary Returns true if `value` is a template object like `Template.myTemplate`.\n * @locus Client\n * @param {Any} value The value to test.\n */\nBlaze.isTemplate = function (t) {\n  return (t instanceof Blaze.Template);\n};\n\n/**\n * @name  onCreated\n * @instance\n * @memberOf Template\n * @summary Register a function to be called when an instance of this template is created.\n * @param {Function} callback A function to be added as a callback.\n * @locus Client\n * @importFromPackage templating\n */\nTemplate.prototype.onCreated = function (cb) {\n  this._callbacks.created.push(cb);\n};\n\n/**\n * @name  onRendered\n * @instance\n * @memberOf Template\n * @summary Register a function to be called when an instance of this template is inserted into the DOM.\n * @param {Function} callback A function to be added as a callback.\n * @locus Client\n * @importFromPackage templating\n */\nTemplate.prototype.onRendered = function (cb) {\n  this._callbacks.rendered.push(cb);\n};\n\n/**\n * @name  onDestroyed\n * @instance\n * @memberOf Template\n * @summary Register a function to be called when an instance of this template is removed from the DOM and destroyed.\n * @param {Function} callback A function to be added as a callback.\n * @locus Client\n * @importFromPackage templating\n */\nTemplate.prototype.onDestroyed = function (cb) {\n  this._callbacks.destroyed.push(cb);\n};\n\nTemplate.prototype._getCallbacks = function (which) {\n  var self = this;\n  var callbacks = self[which] ? [self[which]] : [];\n  // Fire all callbacks added with the new API (Template.onRendered())\n  // as well as the old-style callback (e.g. Template.rendered) for\n  // backwards-compatibility.\n  callbacks = callbacks.concat(self._callbacks[which]);\n  return callbacks;\n};\n\nvar fireCallbacks = function (callbacks, template) {\n  Template._withTemplateInstanceFunc(\n    function () { return template; },\n    function () {\n      for (var i = 0, N = callbacks.length; i < N; i++) {\n        callbacks[i].call(template);\n      }\n    });\n};\n\nTemplate.prototype.constructView = function (contentFunc, elseFunc) {\n  var self = this;\n  var view = Blaze.View(self.viewName, self.renderFunction);\n  view.template = self;\n\n  view.templateContentBlock = (\n    contentFunc ? new Template('(contentBlock)', contentFunc) : null);\n  view.templateElseBlock = (\n    elseFunc ? new Template('(elseBlock)', elseFunc) : null);\n\n  if (self.__eventMaps || typeof self.events === 'object') {\n    view._onViewRendered(function () {\n      if (view.renderCount !== 1)\n        return;\n\n      if (! self.__eventMaps.length && typeof self.events === \"object\") {\n        // Provide limited back-compat support for `.events = {...}`\n        // syntax.  Pass `template.events` to the original `.events(...)`\n        // function.  This code must run only once per template, in\n        // order to not bind the handlers more than once, which is\n        // ensured by the fact that we only do this when `__eventMaps`\n        // is falsy, and we cause it to be set now.\n        Template.prototype.events.call(self, self.events);\n      }\n\n      self.__eventMaps.forEach(function (m) {\n        Blaze._addEventMap(view, m, view);\n      });\n    });\n  }\n\n  view._templateInstance = new Blaze.TemplateInstance(view);\n  view.templateInstance = function () {\n    // Update data, firstNode, and lastNode, and return the TemplateInstance\n    // object.\n    var inst = view._templateInstance;\n\n    /**\n     * @instance\n     * @memberOf Blaze.TemplateInstance\n     * @name  data\n     * @summary The data context of this instance's latest invocation.\n     * @locus Client\n     */\n    inst.data = Blaze.getData(view);\n\n    if (view._domrange && !view.isDestroyed) {\n      inst.firstNode = view._domrange.firstNode();\n      inst.lastNode = view._domrange.lastNode();\n    } else {\n      // on 'created' or 'destroyed' callbacks we don't have a DomRange\n      inst.firstNode = null;\n      inst.lastNode = null;\n    }\n\n    return inst;\n  };\n\n  /**\n   * @name  created\n   * @instance\n   * @memberOf Template\n   * @summary Provide a callback when an instance of a template is created.\n   * @locus Client\n   * @deprecated in 1.1\n   */\n  // To avoid situations when new callbacks are added in between view\n  // instantiation and event being fired, decide on all callbacks to fire\n  // immediately and then fire them on the event.\n  var createdCallbacks = self._getCallbacks('created');\n  view.onViewCreated(function () {\n    fireCallbacks(createdCallbacks, view.templateInstance());\n  });\n\n  /**\n   * @name  rendered\n   * @instance\n   * @memberOf Template\n   * @summary Provide a callback when an instance of a template is rendered.\n   * @locus Client\n   * @deprecated in 1.1\n   */\n  var renderedCallbacks = self._getCallbacks('rendered');\n  view.onViewReady(function () {\n    fireCallbacks(renderedCallbacks, view.templateInstance());\n  });\n\n  /**\n   * @name  destroyed\n   * @instance\n   * @memberOf Template\n   * @summary Provide a callback when an instance of a template is destroyed.\n   * @locus Client\n   * @deprecated in 1.1\n   */\n  var destroyedCallbacks = self._getCallbacks('destroyed');\n  view.onViewDestroyed(function () {\n    fireCallbacks(destroyedCallbacks, view.templateInstance());\n  });\n\n  return view;\n};\n\n/**\n * @class\n * @summary The class for template instances\n * @param {Blaze.View} view\n * @instanceName template\n */\nBlaze.TemplateInstance = function (view) {\n  if (! (this instanceof Blaze.TemplateInstance))\n    // called without `new`\n    return new Blaze.TemplateInstance(view);\n\n  if (! (view instanceof Blaze.View))\n    throw new Error(\"View required\");\n\n  view._templateInstance = this;\n\n  /**\n   * @name view\n   * @memberOf Blaze.TemplateInstance\n   * @instance\n   * @summary The [View](../api/blaze.html#Blaze-View) object for this invocation of the template.\n   * @locus Client\n   * @type {Blaze.View}\n   */\n  this.view = view;\n  this.data = null;\n\n  /**\n   * @name firstNode\n   * @memberOf Blaze.TemplateInstance\n   * @instance\n   * @summary The first top-level DOM node in this template instance.\n   * @locus Client\n   * @type {DOMNode}\n   */\n  this.firstNode = null;\n\n  /**\n   * @name lastNode\n   * @memberOf Blaze.TemplateInstance\n   * @instance\n   * @summary The last top-level DOM node in this template instance.\n   * @locus Client\n   * @type {DOMNode}\n   */\n  this.lastNode = null;\n\n  // This dependency is used to identify state transitions in\n  // _subscriptionHandles which could cause the result of\n  // TemplateInstance#subscriptionsReady to change. Basically this is triggered\n  // whenever a new subscription handle is added or when a subscription handle\n  // is removed and they are not ready.\n  this._allSubsReadyDep = new Tracker.Dependency();\n  this._allSubsReady = false;\n\n  this._subscriptionHandles = {};\n};\n\n/**\n * @summary Find all elements matching `selector` in this template instance, and return them as a JQuery object.\n * @locus Client\n * @param {String} selector The CSS selector to match, scoped to the template contents.\n * @returns {DOMNode[]}\n */\nBlaze.TemplateInstance.prototype.$ = function (selector) {\n  var view = this.view;\n  if (! view._domrange)\n    throw new Error(\"Can't use $ on template instance with no DOM\");\n  return view._domrange.$(selector);\n};\n\n/**\n * @summary Find all elements matching `selector` in this template instance.\n * @locus Client\n * @param {String} selector The CSS selector to match, scoped to the template contents.\n * @returns {DOMElement[]}\n */\nBlaze.TemplateInstance.prototype.findAll = function (selector) {\n  return Array.prototype.slice.call(this.$(selector));\n};\n\n/**\n * @summary Find one element matching `selector` in this template instance.\n * @locus Client\n * @param {String} selector The CSS selector to match, scoped to the template contents.\n * @returns {DOMElement}\n */\nBlaze.TemplateInstance.prototype.find = function (selector) {\n  var result = this.$(selector);\n  return result[0] || null;\n};\n\n/**\n * @summary A version of [Tracker.autorun](https://docs.meteor.com/api/tracker.html#Tracker-autorun) that is stopped when the template is destroyed.\n * @locus Client\n * @param {Function} runFunc The function to run. It receives one argument: a Tracker.Computation object.\n */\nBlaze.TemplateInstance.prototype.autorun = function (f) {\n  return this.view.autorun(f);\n};\n\n/**\n * @summary A version of [Meteor.subscribe](https://docs.meteor.com/api/pubsub.html#Meteor-subscribe) that is stopped\n * when the template is destroyed.\n * @return {SubscriptionHandle} The subscription handle to the newly made\n * subscription. Call `handle.stop()` to manually stop the subscription, or\n * `handle.ready()` to find out if this particular subscription has loaded all\n * of its inital data.\n * @locus Client\n * @param {String} name Name of the subscription.  Matches the name of the\n * server's `publish()` call.\n * @param {Any} [arg1,arg2...] Optional arguments passed to publisher function\n * on server.\n * @param {Function|Object} [options] If a function is passed instead of an\n * object, it is interpreted as an `onReady` callback.\n * @param {Function} [options.onReady] Passed to [`Meteor.subscribe`](https://docs.meteor.com/api/pubsub.html#Meteor-subscribe).\n * @param {Function} [options.onStop] Passed to [`Meteor.subscribe`](https://docs.meteor.com/api/pubsub.html#Meteor-subscribe).\n * @param {DDP.Connection} [options.connection] The connection on which to make the\n * subscription.\n */\nBlaze.TemplateInstance.prototype.subscribe = function (...args) {\n  var self = this;\n\n  var subHandles = self._subscriptionHandles;\n\n  // Duplicate logic from Meteor.subscribe\n  var options = {};\n  if (args.length) {\n    var lastParam = args[args.length - 1];\n\n    // Match pattern to check if the last arg is an options argument\n    var lastParamOptionsPattern = {\n      onReady: Match.Optional(Function),\n      // XXX COMPAT WITH 1.0.3.1 onError used to exist, but now we use\n      // onStop with an error callback instead.\n      onError: Match.Optional(Function),\n      onStop: Match.Optional(Function),\n      connection: Match.Optional(Match.Any)\n    };\n\n    if (isFunction(lastParam)) {\n      options.onReady = args.pop();\n    } else if (lastParam && ! isEmpty(lastParam) && Match.test(lastParam, lastParamOptionsPattern)) {\n      options = args.pop();\n    }\n  }\n\n  var subHandle;\n  var oldStopped = options.onStop;\n  options.onStop = function (error) {\n    // When the subscription is stopped, remove it from the set of tracked\n    // subscriptions to avoid this list growing without bound\n    delete subHandles[subHandle.subscriptionId];\n\n    // Removing a subscription can only change the result of subscriptionsReady\n    // if we are not ready (that subscription could be the one blocking us being\n    // ready).\n    if (! self._allSubsReady) {\n      self._allSubsReadyDep.changed();\n    }\n\n    if (oldStopped) {\n      oldStopped(error);\n    }\n  };\n\n  var connection = options.connection;\n  const { onReady, onError, onStop } = options;\n  var callbacks = { onReady, onError, onStop };\n\n  // The callbacks are passed as the last item in the arguments array passed to\n  // View#subscribe\n  args.push(callbacks);\n\n  // View#subscribe takes the connection as one of the options in the last\n  // argument\n  subHandle = self.view.subscribe.call(self.view, args, {\n    connection: connection\n  });\n\n  if (!has(subHandles, subHandle.subscriptionId)) {\n    subHandles[subHandle.subscriptionId] = subHandle;\n\n    // Adding a new subscription will always cause us to transition from ready\n    // to not ready, but if we are already not ready then this can't make us\n    // ready.\n    if (self._allSubsReady) {\n      self._allSubsReadyDep.changed();\n    }\n  }\n\n  return subHandle;\n};\n\n/**\n * @summary A reactive function that returns true when all of the subscriptions\n * called with [this.subscribe](#TemplateInstance-subscribe) are ready.\n * @return {Boolean} True if all subscriptions on this template instance are\n * ready.\n */\nBlaze.TemplateInstance.prototype.subscriptionsReady = function () {\n  this._allSubsReadyDep.depend();\n  this._allSubsReady = Object.values(this._subscriptionHandles).every((handle) => {  \n    return handle.ready();\n  });\n\n  return this._allSubsReady;\n};\n\n/**\n * @summary Specify template helpers available to this template.\n * @locus Client\n * @param {Object} helpers Dictionary of helper functions by name.\n * @importFromPackage templating\n */\nTemplate.prototype.helpers = function (dict) {\n  if (!isObject(dict)) {\n    throw new Error(\"Helpers dictionary has to be an object\");\n  }\n\n  for (var k in dict) this.__helpers.set(k, dict[k]);\n};\n\nvar canUseGetters = (function () {\n  if (Object.defineProperty) {\n    var obj = {};\n    try {\n      Object.defineProperty(obj, \"self\", {\n        get: function () { return obj; }\n      });\n    } catch (e) {\n      return false;\n    }\n    return obj.self === obj;\n  }\n  return false;\n})();\n\nif (canUseGetters) {\n  // Like Blaze.currentView but for the template instance. A function\n  // rather than a value so that not all helpers are implicitly dependent\n  // on the current template instance's `data` property, which would make\n  // them dependent on the data context of the template inclusion.\n  var currentTemplateInstanceFunc = null;\n\n  // If getters are supported, define this property with a getter function\n  // to make it effectively read-only, and to work around this bizarre JSC\n  // bug: https://github.com/meteor/meteor/issues/9926\n  Object.defineProperty(Template, \"_currentTemplateInstanceFunc\", {\n    get: function () {\n      return currentTemplateInstanceFunc;\n    }\n  });\n\n  Template._withTemplateInstanceFunc = function (templateInstanceFunc, func) {\n    if (typeof func !== 'function') {\n      throw new Error(\"Expected function, got: \" + func);\n    }\n    var oldTmplInstanceFunc = currentTemplateInstanceFunc;\n    try {\n      currentTemplateInstanceFunc = templateInstanceFunc;\n      return func();\n    } finally {\n      currentTemplateInstanceFunc = oldTmplInstanceFunc;\n    }\n  };\n} else {\n  // If getters are not supported, just use a normal property.\n  Template._currentTemplateInstanceFunc = null;\n\n  Template._withTemplateInstanceFunc = function (templateInstanceFunc, func) {\n    if (typeof func !== 'function') {\n      throw new Error(\"Expected function, got: \" + func);\n    }\n    var oldTmplInstanceFunc = Template._currentTemplateInstanceFunc;\n    try {\n      Template._currentTemplateInstanceFunc = templateInstanceFunc;\n      return func();\n    } finally {\n      Template._currentTemplateInstanceFunc = oldTmplInstanceFunc;\n    }\n  };\n}\n\n/**\n * @summary Specify event handlers for this template.\n * @locus Client\n * @param {EventMap} eventMap Event handlers to associate with this template.\n * @importFromPackage templating\n */\nTemplate.prototype.events = function (eventMap) {\n  if (!isObject(eventMap)) {\n    throw new Error(\"Event map has to be an object\");\n  }\n\n  var template = this;\n  var eventMap2 = {};\n  for (var k in eventMap) {\n    eventMap2[k] = (function (k, v) {\n      return function (event /*, ...*/) {\n        var view = this; // passed by EventAugmenter\n        var data = Blaze.getData(event.currentTarget);\n        if (data == null) data = {};\n        var args = Array.prototype.slice.call(arguments);\n        var tmplInstanceFunc = Blaze._bind(view.templateInstance, view);\n        args.splice(1, 0, tmplInstanceFunc());\n\n        return Template._withTemplateInstanceFunc(tmplInstanceFunc, function () {\n          return v.apply(data, args);\n        });\n      };\n    })(k, eventMap[k]);\n  }\n\n  template.__eventMaps.push(eventMap2);\n};\n\n/**\n * @function\n * @name instance\n * @memberOf Template\n * @summary The [template instance](#Template-instances) corresponding to the current template helper, event handler, callback, or autorun.  If there isn't one, `null`.\n * @locus Client\n * @returns {Blaze.TemplateInstance}\n * @importFromPackage templating\n */\nTemplate.instance = function () {\n  return Template._currentTemplateInstanceFunc\n    && Template._currentTemplateInstanceFunc();\n};\n\n// Note: Template.currentData() is documented to take zero arguments,\n// while Blaze.getData takes up to one.\n\n/**\n * @summary\n *\n * - Inside an `onCreated`, `onRendered`, or `onDestroyed` callback, returns\n * the data context of the template.\n * - Inside an event handler, returns the data context of the template on which\n * this event handler was defined.\n * - Inside a helper, returns the data context of the DOM node where the helper\n * was used.\n *\n * Establishes a reactive dependency on the result.\n * @locus Client\n * @function\n * @importFromPackage templating\n */\nTemplate.currentData = Blaze.getData;\n\n/**\n * @summary Accesses other data contexts that enclose the current data context.\n * @locus Client\n * @function\n * @param {Integer} [numLevels] The number of levels beyond the current data context to look. Defaults to 1.\n * @importFromPackage templating\n */\nTemplate.parentData = Blaze._parentData;\n\n/**\n * @summary Defines a [helper function](#Template-helpers) which can be used from all templates.\n * @locus Client\n * @function\n * @param {String} name The name of the helper function you are defining.\n * @param {Function} function The helper function itself.\n * @importFromPackage templating\n */\nTemplate.registerHelper = Blaze.registerHelper;\n\n/**\n * @summary Removes a global [helper function](#Template-helpers).\n * @locus Client\n * @function\n * @param {String} name The name of the helper function you are defining.\n * @importFromPackage templating\n */\nTemplate.deregisterHelper = Blaze.deregisterHelper;\n","UI = Blaze;\n\nBlaze.ReactiveVar = ReactiveVar;\nUI._templateInstance = Blaze.Template.instance;\n\nHandlebars = {};\nHandlebars.registerHelper = Blaze.registerHelper;\n\nHandlebars._escape = Blaze._escape;\n\n// Return these from {{...}} helpers to achieve the same as returning\n// strings from {{{...}}} helpers\nHandlebars.SafeString = function(string) {\n  this.string = string;\n};\nHandlebars.SafeString.prototype.toString = function() {\n  return this.string.toString();\n};\n"]}}]