{"code":"function module(t,e,i){\"use strict\";(function(e){let s=t(\"big-integer\"),l=t(\"crypto\"),h=t(\"./util\");i.exports=class t{static async onetimeauth(e,i){Buffer.isBuffer(e)||(e=Buffer.from(e));let s=new t(i);return await s.update(e),await s.finish()}static async onetimeauth_verify(e,i,s){Buffer.isBuffer(e)||(e=Buffer.from(e));let h=new t(i);await h.update(e);let r=await h.finish();return l.timingSafeEqual(r,s)}constructor(t){if(void 0===t){this.buffer=Buffer.alloc(16,0),this.h=new Uint32Array(5),this.r=[0,0,0,0,0],this.pad=[0,0,0,0],this.leftover=0,this.final=!1;return}if(!Buffer.isBuffer(t))throw TypeError(\"Poly1305 key must be a Buffer (argument 1)\");if(32!==t.length)throw Error(\"Poly1305 requires a 32-byte key\");this.buffer=Buffer.alloc(16,0),this.r=[67108863&h.load32_le(t.slice(0,4)),h.load32_le(t.slice(3,7))>>>2&67108611,h.load32_le(t.slice(6,10))>>>4&67092735,h.load32_le(t.slice(9,13))>>>6&66076671,h.load32_le(t.slice(12,16))>>>8&1048575],this.h=new Uint32Array(5),this.pad=[h.load32_le(t.slice(16,20)),h.load32_le(t.slice(20,24)),h.load32_le(t.slice(24,28)),h.load32_le(t.slice(28,32))],this.leftover=0,this.final=!1}clone(){let e=new t;this.buffer.copy(e.buffer,0,0,16),e.r=this.r;for(let t=0;t<5;t++)e.h[t]=this.h[t];for(let t=0;t<4;t++)e.pad[t]=this.pad[t];return e.leftover=this.leftover,e.final=this.final,e}async blocks(t,e){let i,l,r,f,a,o;if(t.length<16)throw Error(\"Out of range exception\");let u=this.final?0:16777216,[d,n,c,m,p]=this.r,b=5*n,_=5*c,v=5*m,w=5*p,y=s(this.h[0]),g=s(this.h[1]),B=s(this.h[2]),S=s(this.h[3]),k=s(this.h[4]),J=0;for(;e>=16;)y=y.add(67108863&h.load32_le(t.slice(J,J+4))),g=g.add(h.load32_le(t.slice(J+3,J+7))>>>2&67108863),B=B.add(h.load32_le(t.slice(J+6,J+10))>>>4&67108863),S=S.add(h.load32_le(t.slice(J+9,J+13))>>>6&67108863),k=k.add(h.load32_le(t.slice(J+12,J+16))>>>8|u),l=s(y.times(s(d))).plus(s(w).times(g)).plus(s(v).times(B)).plus(s(_).times(S)).plus(s(b).times(k)),r=s(y.times(s(n))).plus(g.times(s(d))).plus(s(w).times(B)).plus(s(v).times(S)).plus(s(_).times(k)),f=s(y.times(s(c))).plus(g.times(s(n))).plus(B.times(s(d))).plus(s(w).times(S)).plus(s(v).times(k)),a=s(y.times(s(m))).plus(g.times(s(c))).plus(B.times(s(n))).plus(S.times(s(d))).plus(s(w).times(k)),o=s(y.times(s(p))).plus(g.times(s(m))).plus(B.times(s(c))).plus(S.times(s(n))).plus(k.times(s(d))),i=l.shiftRight(26),y=l.and(67108863),i=(r=r.add(i)).shiftRight(26),g=r.and(67108863),i=(f=f.add(i)).shiftRight(26),B=f.and(67108863),i=(a=a.add(i)).shiftRight(26),S=a.and(67108863),i=(o=o.add(i)).shiftRight(26),k=o.and(67108863),i=(y=y.add(i.multiply(5).toJSNumber())).shiftRight(26),y=y.and(67108863),g=g.add(i),J+=16,e-=16;this.h[0]=y.toJSNumber()>>>0,this.h[1]=g.toJSNumber()>>>0,this.h[2]=B.toJSNumber()>>>0,this.h[3]=S.toJSNumber()>>>0,this.h[4]=k.toJSNumber()>>>0}async update(t){let e;let i=t.length;if(this.leftover>0){if((e=16-this.leftover)>i&&(e=i),t.slice(0,e).copy(this.buffer,this.leftover,0),this.leftover+=e,this.leftover<16)return this;await this.blocks(this.buffer,16),this.leftover-=16,i-=e,t=t.slice(e)}return i>=16&&(e=-16&i)>=16&&(await this.blocks(t.slice(0,e),e),i=(t=t.slice(e)).length),i>0&&(t.slice(0,i).copy(this.buffer,this.leftover,0),this.leftover+=i),this}async finish(){let t,e,i,s,l,r,f,a,o,u,d,n;if(this.leftover){let t=this.leftover;for(this.buffer[t++]=1;t<16;t++)this.buffer[t]=0;this.final=!0,await this.blocks(this.buffer,16)}return f=this.h[0],a=this.h[1],o=this.h[2],u=this.h[3],d=this.h[4],t=a>>>26,a&=67108863,o+=t,t=o>>>26,o&=67108863,u+=t,t=u>>>26,u&=67108863,d+=t,t=d>>>26,d&=67108863,f+=5*t,t=f>>>26,f&=67108863,a+=t,t=(e=f+5)>>>26,e&=67108863,t=(i=a+t)>>>26,i&=67108863,t=(s=o+t)>>>26,s&=67108863,t=(l=o+t)>>>26,l&=67108863,e&=n=((r=d+t-67108864>>>0)>>>31)-1,i&=n,s&=n,l&=n,r&=n,f=f&(n=~n>>>0)|e,a=a&n|i,o=o&n|s,u=u&n|l,d=d&n|r,f=(f|a<<26)>>>0,a=(a>>>6|o<<20)>>>0,o=(o>>>12|u<<14)>>>0,u=(u>>>18|d<<8)>>>0,[f,t]=h.add_overflow(f,this.pad[0]),[a,t]=h.add_overflow(a,this.pad[1],t),[o,t]=h.add_overflow(o,this.pad[2],t),[u,t]=h.add_overflow(u,this.pad[3],t),Buffer.concat([h.store32_le(f>>>0),h.store32_le(a>>>0),h.store32_le(o>>>0),h.store32_le(u>>>0)])}}}).call(this,i)}","map":"{\"version\":3,\"sources\":[\"<anon>\"],\"names\":[],\"mappings\":\"\"}"}