{"code":"function module(t,e,s){var i,o,r,n,a;s.export({OutgoingRequestMessage:function(){return h}}),s.link(\"../../grammar\",{NameAddrHeader:function(t){i=t}},0),s.link(\"./utils\",{createRandomToken:function(t){o=t},headerize:function(t){r=t},newTag:function(t){n=t},utf8Length:function(t){a=t}},1);class h{constructor(t,e,s,i,r,a,d){this.headers={},this.extraHeaders=[],this.options=h.getDefaultOptions(),r&&(this.options=Object.assign(Object.assign({},this.options),r),this.options.optionTags&&this.options.optionTags.length&&(this.options.optionTags=this.options.optionTags.slice()),this.options.routeSet&&this.options.routeSet.length&&(this.options.routeSet=this.options.routeSet.slice())),a&&a.length&&(this.extraHeaders=a.slice()),d&&(this.body={body:d.content,contentType:d.contentType}),this.method=t,this.ruri=e.clone(),this.fromURI=s.clone(),this.fromTag=this.options.fromTag?this.options.fromTag:n(),this.from=h.makeNameAddrHeader(this.fromURI,this.options.fromDisplayName,this.fromTag),this.toURI=i.clone(),this.toTag=this.options.toTag,this.to=h.makeNameAddrHeader(this.toURI,this.options.toDisplayName,this.toTag),this.callId=this.options.callId?this.options.callId:this.options.callIdPrefix+o(15),this.cseq=this.options.cseq,this.setHeader(\"route\",this.options.routeSet),this.setHeader(\"via\",\"\"),this.setHeader(\"to\",this.to.toString()),this.setHeader(\"from\",this.from.toString()),this.setHeader(\"cseq\",this.cseq+\" \"+this.method),this.setHeader(\"call-id\",this.callId),this.setHeader(\"max-forwards\",\"70\")}static getDefaultOptions(){return{callId:\"\",callIdPrefix:\"\",cseq:1,toDisplayName:\"\",toTag:\"\",fromDisplayName:\"\",fromTag:\"\",forceRport:!1,hackViaTcp:!1,optionTags:[\"outbound\"],routeSet:[],userAgentString:\"sip.js\",viaHost:\"\"}}static makeNameAddrHeader(t,e,s){let o={};return s&&(o.tag=s),new i(t,e,o)}getHeader(t){let e=this.headers[r(t)];if(e){if(e[0])return e[0]}else{let e=RegExp(\"^\\\\s*\"+t+\"\\\\s*:\",\"i\");for(let t of this.extraHeaders)if(e.test(t))return t.substring(t.indexOf(\":\")+1).trim()}}getHeaders(t){let e=[],s=this.headers[r(t)];if(s)for(let t of s)e.push(t);else{let s=RegExp(\"^\\\\s*\"+t+\"\\\\s*:\",\"i\");for(let t of this.extraHeaders)s.test(t)&&e.push(t.substring(t.indexOf(\":\")+1).trim())}return e}hasHeader(t){if(this.headers[r(t)])return!0;{let e=RegExp(\"^\\\\s*\"+t+\"\\\\s*:\",\"i\");for(let t of this.extraHeaders)if(e.test(t))return!0}return!1}setHeader(t,e){this.headers[r(t)]=e instanceof Array?e:[e]}setViaHeader(t,e){this.options.hackViaTcp&&(e=\"TCP\");let s=\"SIP/2.0/\"+e;s+=\" \"+this.options.viaHost+\";branch=\"+t,this.options.forceRport&&(s+=\";rport\"),this.setHeader(\"via\",s),this.branch=t}toString(){let t=\"\";for(let e in t+=this.method+\" \"+this.ruri.toRaw()+\" SIP/2.0\\r\\n\",this.headers)if(this.headers[e])for(let s of this.headers[e])t+=e+\": \"+s+\"\\r\\n\";for(let e of this.extraHeaders)t+=e.trim()+\"\\r\\n\";return t+=\"Supported: \"+this.options.optionTags.join(\", \")+\"\\r\\nUser-Agent: \"+this.options.userAgentString+\"\\r\\n\",this.body?\"string\"==typeof this.body?t+=\"Content-Length: \"+a(this.body)+\"\\r\\n\\r\\n\"+this.body:this.body.body&&this.body.contentType?t+=\"Content-Type: \"+this.body.contentType+\"\\r\\nContent-Length: \"+a(this.body.body)+\"\\r\\n\\r\\n\"+this.body.body:t+=\"Content-Length: 0\\r\\n\\r\\n\":t+=\"Content-Length: 0\\r\\n\\r\\n\",t}}}","map":"{\"version\":3,\"sources\":[\"<anon>\"],\"names\":[],\"mappings\":\"\"}"}