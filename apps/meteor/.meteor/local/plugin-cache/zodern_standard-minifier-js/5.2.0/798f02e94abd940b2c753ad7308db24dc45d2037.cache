{"code":"function module(e,t,r){(function(t){t.link(\"@babel/runtime/helpers/slicedToArray\",{default:function(e){n=e}},0),t.link(\"@babel/runtime/regenerator\",{default:function(e){s=e}},1);var n,s,a=e(\"./backend\"),c=e(\"./cryptography-key\"),u=e(\"./keytypes/ed25519sk\"),o=e(\"./keytypes/ed25519pk\"),i=e(\"./backend/libsodium-wrappers\"),p=e(\"./sodium-error\"),h=e(\"./backend/sodiumnative\"),f=e(\"./keytypes/x25519pk\"),l=e(\"./keytypes/x25519sk\"),y=e(\"./util\");\"undefined\"==typeof Buffer&&e(\"buffer/\").Buffer;var d=function(){function e(e){if(!(e instanceof a))throw TypeError(\"Backend object must implement the backend function\");this.backend=e,y.populateConstants(this)}var t=e.prototype;return t.getBackendName=function(){return this.backend.backendName},t.isSodiumNative=function(){return this.backend instanceof h},t.isLibsodiumWrappers=function(){return this.backend instanceof i},e.auto=function(){var t;return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,s.awrap(h.init());case 3:t=r.sent,r.next=11;break;case 6:return r.prev=6,r.t0=r.catch(0),r.next=10,s.awrap(i.init());case 10:t=r.sent;case 11:if(t){r.next=15;break}return r.next=14,s.awrap(i.init());case 14:t=r.sent;case 15:return y.populateConstants(t),r.abrupt(\"return\",new e(t));case 17:case\"end\":return r.stop()}},null,null,[[0,6]],Promise)},t.ensureLoaded=function(){return s.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==this.backend){t.next=11;break}return t.prev=1,t.next=4,s.awrap(e.auto());case 4:t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(1),t.next=10,s.awrap(i.init());case 10:this.backend=t.sent;case 11:case\"end\":return t.stop()}},null,this,[[1,6]],Promise)},t.crypto_aead_xchacha20poly1305_ietf_decrypt=function(e,t,r){var n,a=arguments;return s.async(function(u){for(;;)switch(u.prev=u.next){case 0:return n=a.length>3&&void 0!==a[3]?a[3]:\"\",u.next=3,s.awrap(this.ensureLoaded());case 3:if(!(24!==t.length)){u.next=5;break}throw new p(\"Argument 2 must be 24 bytes\");case 5:if(r instanceof c){u.next=7;break}throw TypeError(\"Argument 3 must be an instance of CryptographyKey\");case 7:return u.t0=s,u.t1=this.backend,u.next=11,s.awrap(y.toBuffer(e));case 11:if(u.t2=u.sent,!(n.length>0)){u.next=18;break}return u.next=15,s.awrap(y.toBuffer(n));case 15:u.t3=u.sent,u.next=19;break;case 18:u.t3=null;case 19:return u.t4=u.t3,u.next=22,s.awrap(y.toBuffer(t));case 22:return u.t5=u.sent,u.t6=r,u.t7=u.t1.crypto_aead_xchacha20poly1305_ietf_decrypt.call(u.t1,u.t2,u.t4,u.t5,u.t6),u.next=27,u.t0.awrap.call(u.t0,u.t7);case 27:return u.abrupt(\"return\",u.sent);case 28:case\"end\":return u.stop()}},null,this,null,Promise)},t.crypto_aead_xchacha20poly1305_ietf_encrypt=function(e,t,r){var n,a=arguments;return s.async(function(u){for(;;)switch(u.prev=u.next){case 0:return n=a.length>3&&void 0!==a[3]?a[3]:\"\",u.next=3,s.awrap(this.ensureLoaded());case 3:if(!(24!==t.length)){u.next=5;break}throw new p(\"Argument 2 must be 24 bytes\");case 5:if(r instanceof c){u.next=7;break}throw TypeError(\"Argument 3 must be an instance of CryptographyKey\");case 7:return u.t0=s,u.t1=this.backend,u.next=11,s.awrap(y.toBuffer(e));case 11:if(u.t2=u.sent,!(n.length>0)){u.next=18;break}return u.next=15,s.awrap(y.toBuffer(n));case 15:u.t3=u.sent,u.next=19;break;case 18:u.t3=null;case 19:return u.t4=u.t3,u.next=22,s.awrap(y.toBuffer(t));case 22:return u.t5=u.sent,u.t6=r,u.t7=u.t1.crypto_aead_xchacha20poly1305_ietf_encrypt.call(u.t1,u.t2,u.t4,u.t5,u.t6),u.next=27,u.t0.awrap.call(u.t0,u.t7);case 27:return u.abrupt(\"return\",u.sent);case 28:case\"end\":return u.stop()}},null,this,null,Promise)},t.crypto_aead_xchacha20poly1305_ietf_keygen=function(){return s.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=c,e.next=3,s.awrap(this.backend.randombytes_buf(32));case 3:return e.t1=e.sent,e.abrupt(\"return\",new e.t0(e.t1));case 5:case\"end\":return e.stop()}},null,this,null,Promise)},t.crypto_auth=function(e,t){return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.awrap(this.ensureLoaded());case 2:if(t instanceof c){r.next=4;break}throw TypeError(\"Argument 2 must be an instance of CryptographyKey\");case 4:return r.next=6,s.awrap(this.ensureLoaded());case 6:return r.t0=s,r.t1=this.backend,r.next=10,s.awrap(y.toBuffer(e));case 10:return r.t2=r.sent,r.t3=t,r.t4=r.t1.crypto_auth.call(r.t1,r.t2,r.t3),r.next=15,r.t0.awrap.call(r.t0,r.t4);case 15:return r.abrupt(\"return\",r.sent);case 16:case\"end\":return r.stop()}},null,this,null,Promise)},t.crypto_auth_keygen=function(){return s.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=c,e.next=3,s.awrap(this.backend.randombytes_buf(32));case 3:return e.t1=e.sent,e.abrupt(\"return\",new e.t0(e.t1));case 5:case\"end\":return e.stop()}},null,this,null,Promise)},t.crypto_auth_verify=function(e,t,r){return s.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.awrap(this.ensureLoaded());case 2:if(t instanceof c){n.next=4;break}throw TypeError(\"Argument 2 must be an instance of CryptographyKey\");case 4:return n.next=6,s.awrap(this.ensureLoaded());case 6:return n.t0=s,n.t1=this.backend,n.next=10,s.awrap(y.toBuffer(r));case 10:return n.t2=n.sent,n.next=13,s.awrap(y.toBuffer(e));case 13:return n.t3=n.sent,n.t4=t,n.t5=n.t1.crypto_auth_verify.call(n.t1,n.t2,n.t3,n.t4),n.next=18,n.t0.awrap.call(n.t0,n.t5);case 18:return n.abrupt(\"return\",n.sent);case 19:case\"end\":return n.stop()}},null,this,null,Promise)},t.crypto_box=function(e,t,r,n){return s.async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.awrap(this.ensureLoaded());case 2:if(r instanceof l){a.next=4;break}throw TypeError(\"Argument 3 must be an instance of X25519SecretKey\");case 4:if(n instanceof f){a.next=6;break}throw TypeError(\"Argument 4 must be an instance of X25519PublicKey\");case 6:return a.next=8,s.awrap(y.toBuffer(t));case 8:if(!(24!==(t=a.sent).length)){a.next=11;break}throw new p(\"Nonce must be a buffer of exactly 24 bytes\");case 11:return a.t0=this.backend,a.next=14,s.awrap(y.toBuffer(e));case 14:return a.t1=a.sent,a.next=17,s.awrap(y.toBuffer(t));case 17:return a.t2=a.sent,a.t3=r,a.t4=n,a.abrupt(\"return\",a.t0.crypto_box.call(a.t0,a.t1,a.t2,a.t3,a.t4));case 21:case\"end\":return a.stop()}},null,this,null,Promise)},t.crypto_box_open=function(e,t,r,n){return s.async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.awrap(this.ensureLoaded());case 2:if(r instanceof l){a.next=4;break}throw TypeError(\"Argument 3 must be an instance of X25519SecretKey\");case 4:if(n instanceof f){a.next=6;break}throw TypeError(\"Argument 4 must be an instance of X25519PublicKey\");case 6:return a.next=8,s.awrap(y.toBuffer(e));case 8:if(!((e=a.sent).length<16)){a.next=11;break}throw new p(\"Ciphertext must be a buffer of at least 16 bytes\");case 11:return a.next=13,s.awrap(y.toBuffer(t));case 13:if(!(24!==(t=a.sent).length)){a.next=16;break}throw new p(\"Nonce must be a buffer of exactly 24 bytes\");case 16:return a.abrupt(\"return\",this.backend.crypto_box_open(e,t,r,n));case 17:case\"end\":return a.stop()}},null,this,null,Promise)},t.crypto_box_keypair=function(){return s.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.awrap(this.ensureLoaded());case 2:return e.abrupt(\"return\",this.backend.crypto_box_keypair());case 3:case\"end\":return e.stop()}},null,this,null,Promise)},t.crypto_box_keypair_from_secretkey_and_publickey=function(e,t){return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.awrap(this.ensureLoaded());case 2:if(e instanceof l){r.next=4;break}throw TypeError(\"Argument 1 must be an instance of X25519SecretKey\");case 4:if(t instanceof f){r.next=6;break}throw TypeError(\"Argument 2 must be an instance of X25519PublicKey\");case 6:return r.next=8,s.awrap(this.backend.crypto_box_keypair_from_secretkey_and_publickey(e,t));case 8:return r.abrupt(\"return\",r.sent);case 9:case\"end\":return r.stop()}},null,this,null,Promise)},t.crypto_box_secretkey=function(e){return s.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(64!==e.getLength())){t.next=2;break}throw new p(\"Keypair must be 64 bytes\");case 2:return t.abrupt(\"return\",new l(Buffer.from(e.getBuffer().slice(0,32))));case 3:case\"end\":return t.stop()}},null,null,null,Promise)},t.crypto_box_publickey=function(e){return s.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(64!==e.getLength())){t.next=2;break}throw new p(\"Keypair must be 64 bytes\");case 2:return t.abrupt(\"return\",new f(Buffer.from(e.getBuffer().slice(32,64))));case 3:case\"end\":return t.stop()}},null,null,null,Promise)},t.crypto_box_publickey_from_secretkey=function(e){return s.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.awrap(this.ensureLoaded());case 2:if(e instanceof l){t.next=4;break}throw TypeError(\"Argument 1 must be an instance of X25519SecretKey\");case 4:return t.t0=f,t.next=7,s.awrap(this.backend.crypto_scalarmult_base(e));case 7:return t.t1=t.sent,t.abrupt(\"return\",new t.t0(t.t1));case 9:case\"end\":return t.stop()}},null,this,null,Promise)},t.crypto_box_seal=function(e,t){return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.awrap(this.ensureLoaded());case 2:if(t instanceof f){r.next=4;break}throw TypeError(\"Argument 2 must be an instance of X25519PublicKey\");case 4:return r.next=6,s.awrap(this.backend.crypto_box_seal(e,t));case 6:return r.abrupt(\"return\",r.sent);case 7:case\"end\":return r.stop()}},null,this,null,Promise)},t.crypto_box_seal_open=function(e,t,r){return s.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.awrap(this.ensureLoaded());case 2:if(t instanceof f){n.next=4;break}throw TypeError(\"Argument 2 must be an instance of X25519PublicKey\");case 4:if(r instanceof l){n.next=6;break}throw TypeError(\"Argument 3 must be an instance of X25519SecretKey\");case 6:return n.t0=s,n.t1=this.backend,n.next=10,s.awrap(y.toBuffer(e));case 10:return n.t2=n.sent,n.t3=t,n.t4=r,n.t5=n.t1.crypto_box_seal_open.call(n.t1,n.t2,n.t3,n.t4),n.next=16,n.t0.awrap.call(n.t0,n.t5);case 16:return n.abrupt(\"return\",n.sent);case 17:case\"end\":return n.stop()}},null,this,null,Promise)},t.crypto_generichash=function(e){var t,r,n=arguments;return s.async(function(a){for(;;)switch(a.prev=a.next){case 0:return t=n.length>1&&void 0!==n[1]?n[1]:null,r=n.length>2&&void 0!==n[2]?n[2]:32,a.next=4,s.awrap(this.ensureLoaded());case 4:return a.next=6,s.awrap(this.backend.crypto_generichash(e,t,r));case 6:return a.abrupt(\"return\",a.sent);case 7:case\"end\":return a.stop()}},null,this,null,Promise)},t.crypto_generichash_init=function(){var e,t,r=arguments;return s.async(function(n){for(;;)switch(n.prev=n.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:null,t=r.length>1&&void 0!==r[1]?r[1]:32,n.next=4,s.awrap(this.ensureLoaded());case 4:return n.next=6,s.awrap(this.backend.crypto_generichash_init(e,t));case 6:return n.abrupt(\"return\",n.sent);case 7:case\"end\":return n.stop()}},null,this,null,Promise)},t.crypto_generichash_update=function(e,t){return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.awrap(this.ensureLoaded());case 2:return r.next=4,s.awrap(this.backend.crypto_generichash_update(e,t));case 4:return r.abrupt(\"return\",r.sent);case 5:case\"end\":return r.stop()}},null,this,null,Promise)},t.crypto_generichash_final=function(e){var t,r=arguments;return s.async(function(n){for(;;)switch(n.prev=n.next){case 0:return t=r.length>1&&void 0!==r[1]?r[1]:32,n.next=3,s.awrap(this.ensureLoaded());case 3:return n.next=5,s.awrap(this.backend.crypto_generichash_final(e,t));case 5:return n.abrupt(\"return\",n.sent);case 6:case\"end\":return n.stop()}},null,this,null,Promise)},t.crypto_generichash_keygen=function(){return s.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=c,e.next=3,s.awrap(this.backend.randombytes_buf(this.CRYPTO_GENERICHASH_KEYBYTES));case 3:return e.t1=e.sent,e.abrupt(\"return\",new e.t0(e.t1));case 5:case\"end\":return e.stop()}},null,this,null,Promise)},t.crypto_kdf_derive_from_key=function(e,t,r,n){return s.async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.awrap(this.ensureLoaded());case 2:if(!(e<1)){a.next=4;break}throw new p(\"Length must be a positive integer.\");case 4:if(!(t<0)){a.next=6;break}throw new p(\"Key ID must be an unsigned integer\");case 6:return a.next=8,s.awrap(this.backend.crypto_kdf_derive_from_key(e,t,r,n));case 8:return a.abrupt(\"return\",a.sent);case 9:case\"end\":return a.stop()}},null,this,null,Promise)},t.crypto_kdf_keygen=function(){return s.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=c,e.next=3,s.awrap(this.backend.randombytes_buf(this.CRYPTO_KDF_KEYBYTES));case 3:return e.t1=e.sent,e.abrupt(\"return\",new e.t0(e.t1));case 5:case\"end\":return e.stop()}},null,this,null,Promise)},t.crypto_kx_keypair=function(){return s.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",this.crypto_box_keypair());case 1:case\"end\":return e.stop()}},null,this,null,Promise)},t.crypto_kx_seed_keypair=function(e){var t,r;return s.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.awrap(this.ensureLoaded());case 2:return n.next=4,s.awrap(this.backend.crypto_generichash(e,null,this.CRYPTO_KX_SECRETKEYBYTES));case 4:return t=n.sent,n.next=7,s.awrap(this.backend.crypto_scalarmult_base(new c(t)));case 7:return r=n.sent,n.abrupt(\"return\",new c(Buffer.concat([t,r])));case 9:case\"end\":return n.stop()}},null,this,null,Promise)},t.crypto_kx_client_session_keys=function(e,t,r){return s.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.awrap(this.ensureLoaded());case 2:if(e instanceof f){n.next=4;break}throw TypeError(\"Argument 1 must be an instance of X25519PublicKey\");case 4:if(t instanceof l){n.next=6;break}throw TypeError(\"Argument 2 must be an instance of X25519SecretKey\");case 6:if(r instanceof f){n.next=8;break}throw TypeError(\"Argument 3 must be an instance of X25519PublicKey\");case 8:return n.abrupt(\"return\",this.backend.crypto_kx_client_session_keys(e,t,r));case 9:case\"end\":return n.stop()}},null,this,null,Promise)},t.crypto_kx_server_session_keys=function(e,t,r){return s.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.awrap(this.ensureLoaded());case 2:if(e instanceof f){n.next=4;break}throw TypeError(\"Argument 1 must be an instance of X25519PublicKey\");case 4:if(t instanceof l){n.next=6;break}throw TypeError(\"Argument 2 must be an instance of X25519SecretKey\");case 6:if(r instanceof f){n.next=8;break}throw TypeError(\"Argument 3 must be an instance of X25519PublicKey\");case 8:return n.abrupt(\"return\",this.backend.crypto_kx_server_session_keys(e,t,r));case 9:case\"end\":return n.stop()}},null,this,null,Promise)},t.crypto_onetimeauth=function(e,t){return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:if(t instanceof c){r.next=2;break}throw TypeError(\"Argument 2 must be an instance of CryptographyKey\");case 2:return r.t0=s,r.t1=this.backend,r.next=6,s.awrap(y.toBuffer(e));case 6:return r.t2=r.sent,r.t3=t,r.t4=r.t1.crypto_onetimeauth.call(r.t1,r.t2,r.t3),r.next=11,r.t0.awrap.call(r.t0,r.t4);case 11:return r.abrupt(\"return\",r.sent);case 12:case\"end\":return r.stop()}},null,this,null,Promise)},t.crypto_onetimeauth_verify=function(e,t,r){return s.async(function(n){for(;;)switch(n.prev=n.next){case 0:if(t instanceof c){n.next=2;break}throw TypeError(\"Argument 2 must be an instance of CryptographyKey\");case 2:return n.t0=s,n.t1=this.backend,n.next=6,s.awrap(y.toBuffer(e));case 6:return n.t2=n.sent,n.t3=t,n.next=10,s.awrap(y.toBuffer(r));case 10:return n.t4=n.sent,n.t5=n.t1.crypto_onetimeauth_verify.call(n.t1,n.t2,n.t3,n.t4),n.next=14,n.t0.awrap.call(n.t0,n.t5);case 14:return n.abrupt(\"return\",n.sent);case 15:case\"end\":return n.stop()}},null,this,null,Promise)},t.crypto_onetimeauth_keygen=function(){return s.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=c,e.next=3,s.awrap(this.backend.randombytes_buf(32));case 3:return e.t1=e.sent,e.abrupt(\"return\",new e.t0(e.t1));case 5:case\"end\":return e.stop()}},null,this,null,Promise)},t.crypto_pwhash=function(e,t,r,n,a){var u,o=arguments;return s.async(function(i){for(;;)switch(i.prev=i.next){case 0:return u=o.length>5&&void 0!==o[5]?o[5]:null,i.next=3,s.awrap(this.ensureLoaded());case 3:return u||(u=this.CRYPTO_PWHASH_ALG_DEFAULT),i.t0=c,i.t1=s,i.t2=this.backend,i.t3=e,i.next=10,s.awrap(y.toBuffer(t));case 10:return i.t4=i.sent,i.next=13,s.awrap(y.toBuffer(r));case 13:return i.t5=i.sent,i.t6=n,i.t7=a,i.t8=u,i.t9=i.t2.crypto_pwhash.call(i.t2,i.t3,i.t4,i.t5,i.t6,i.t7,i.t8),i.next=20,i.t1.awrap.call(i.t1,i.t9);case 20:return i.t10=i.sent,i.abrupt(\"return\",new i.t0(i.t10));case 22:case\"end\":return i.stop()}},null,this,null,Promise)},t.crypto_pwhash_str=function(e,t,r){return s.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.awrap(this.ensureLoaded());case 2:return n.next=4,s.awrap(this.backend.crypto_pwhash_str(e,t,r));case 4:return n.abrupt(\"return\",n.sent);case 5:case\"end\":return n.stop()}},null,this,null,Promise)},t.crypto_pwhash_str_verify=function(e,t){return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.awrap(this.ensureLoaded());case 2:return r.next=4,s.awrap(this.backend.crypto_pwhash_str_verify(e,t));case 4:return r.abrupt(\"return\",r.sent);case 5:case\"end\":return r.stop()}},null,this,null,Promise)},t.crypto_pwhash_str_needs_rehash=function(e,t,r){return s.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.awrap(this.ensureLoaded());case 2:return n.next=4,s.awrap(this.backend.crypto_pwhash_str_needs_rehash(e,t,r));case 4:return n.abrupt(\"return\",n.sent);case 5:case\"end\":return n.stop()}},null,this,null,Promise)},t.crypto_scalarmult=function(e,t){return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.awrap(this.ensureLoaded());case 2:if(e instanceof l){r.next=4;break}throw TypeError(\"Argument 1 must be an instance of X25519SecretKey\");case 4:if(t instanceof f){r.next=6;break}throw TypeError(\"Argument 2 must be an instance of X25519PublicKey\");case 6:return r.next=8,s.awrap(this.backend.crypto_scalarmult(e,t));case 8:return r.abrupt(\"return\",r.sent);case 9:case\"end\":return r.stop()}},null,this,null,Promise)},t.crypto_scalarmult_base=function(e){return s.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.awrap(this.ensureLoaded());case 2:if(e instanceof l){t.next=4;break}throw TypeError(\"Argument 1 must be an instance of X25519SecretKey\");case 4:return t.t0=f,t.next=7,s.awrap(this.backend.crypto_scalarmult_base(e));case 7:return t.t1=t.sent,t.abrupt(\"return\",new t.t0(t.t1));case 9:case\"end\":return t.stop()}},null,this,null,Promise)},t.crypto_secretbox=function(e,t,r){return s.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.awrap(this.ensureLoaded());case 2:if(!(r.isEd25519Key()||r.isX25519Key())){n.next=4;break}throw TypeError(\"Argument 3 must not be an asymmetric key\");case 4:return n.next=6,s.awrap(y.toBuffer(t));case 6:if(!(24!==(t=n.sent).length)){n.next=9;break}throw new p(\"Nonce must be a buffer of exactly 24 bytes\");case 9:return n.next=11,s.awrap(this.backend.crypto_secretbox(e,t,r));case 11:return n.abrupt(\"return\",n.sent);case 12:case\"end\":return n.stop()}},null,this,null,Promise)},t.crypto_secretbox_open=function(e,t,r){return s.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.awrap(this.ensureLoaded());case 2:if(!(r.isEd25519Key()||r.isX25519Key())){n.next=4;break}throw TypeError(\"Argument 3 must not be an asymmetric key\");case 4:return n.next=6,s.awrap(y.toBuffer(e));case 6:if(!((e=n.sent).length<16)){n.next=9;break}throw new p(\"Ciphertext must be a buffer of at least 16 bytes\");case 9:return n.next=11,s.awrap(y.toBuffer(t));case 11:if(!(24!==(t=n.sent).length)){n.next=14;break}throw new p(\"Nonce must be a buffer of exactly 24 bytes\");case 14:return n.next=16,s.awrap(this.backend.crypto_secretbox_open(e,t,r));case 16:return n.abrupt(\"return\",n.sent);case 17:case\"end\":return n.stop()}},null,this,null,Promise)},t.crypto_secretbox_keygen=function(){return s.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=c,e.next=3,s.awrap(this.backend.randombytes_buf(this.CRYPTO_SECRETBOX_KEYBYTES));case 3:return e.t1=e.sent,e.abrupt(\"return\",new e.t0(e.t1));case 5:case\"end\":return e.stop()}},null,this,null,Promise)},t.crypto_secretstream_xchacha20poly1305_init_push=function(e){var t,r,a,u;return s.async(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,s.awrap(this.ensureLoaded());case 2:if(e instanceof c){o.next=4;break}throw TypeError(\"Key must be an instance of CryptographyKey\");case 4:if(!(32!==e.getLength())){o.next=6;break}throw new p(\"crypto_secretstream keys must be 32 bytes long\");case 6:return o.next=8,s.awrap(this.backend.crypto_secretstream_xchacha20poly1305_init_push(e));case 8:return t=o.sent,a=(r=n(t,2))[0],u=r[1],o.abrupt(\"return\",Object.freeze({header:u,push:this.crypto_secretstream_xchacha20poly1305_push.bind(this,a),rekey:this.crypto_secretstream_xchacha20poly1305_rekey.bind(this,a)}));case 13:case\"end\":return o.stop()}},null,this,null,Promise)},t.crypto_secretstream_xchacha20poly1305_init_pull=function(e,t){var r;return s.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.awrap(this.ensureLoaded());case 2:return n.next=4,s.awrap(y.toBuffer(t));case 4:if(!(24!==(t=n.sent).length)){n.next=7;break}throw new p(\"crypto_secretstream headers must be 24 bytes long\");case 7:if(e instanceof c){n.next=9;break}throw TypeError(\"Key must be an instance of CryptographyKey\");case 9:if(!(32!==e.getLength())){n.next=11;break}throw new p(\"crypto_secretstream keys must be 32 bytes long\");case 11:return n.next=13,s.awrap(this.backend.crypto_secretstream_xchacha20poly1305_init_pull(t,e));case 13:return r=n.sent,n.abrupt(\"return\",Object.freeze({pull:this.crypto_secretstream_xchacha20poly1305_pull.bind(this,r)}));case 15:case\"end\":return n.stop()}},null,this,null,Promise)},t.crypto_secretstream_xchacha20poly1305_push=function(e,t){var r,n,a=arguments;return s.async(function(c){for(;;)switch(c.prev=c.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:\"\",n=a.length>3&&void 0!==a[3]?a[3]:0,c.next=4,s.awrap(this.ensureLoaded());case 4:return c.abrupt(\"return\",this.backend.crypto_secretstream_xchacha20poly1305_push(e,t,r,n));case 5:case\"end\":return c.stop()}},null,this,null,Promise)},t.crypto_secretstream_xchacha20poly1305_pull=function(e,t){var r,n,a=arguments;return s.async(function(c){for(;;)switch(c.prev=c.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:\"\",n=a.length>3&&void 0!==a[3]?a[3]:0,c.next=4,s.awrap(this.ensureLoaded());case 4:return c.abrupt(\"return\",this.backend.crypto_secretstream_xchacha20poly1305_pull(e,t,r,n));case 5:case\"end\":return c.stop()}},null,this,null,Promise)},t.crypto_secretstream_xchacha20poly1305_rekey=function(e){return s.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.awrap(this.ensureLoaded());case 2:return t.next=4,s.awrap(this.backend.crypto_secretstream_xchacha20poly1305_rekey(e));case 4:case\"end\":return t.stop()}},null,this,null,Promise)},t.crypto_secretstream_xchacha20poly1305_keygen=function(){return s.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=c,e.next=3,s.awrap(this.backend.randombytes_buf(this.CRYPTO_SECRETSTREAM_XCHACHA20POLY1305_KEYBYTES));case 3:return e.t1=e.sent,e.abrupt(\"return\",new e.t0(e.t1));case 5:case\"end\":return e.stop()}},null,this,null,Promise)},t.crypto_shorthash=function(e,t){return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.awrap(this.ensureLoaded());case 2:return r.t0=s,r.t1=this.backend,r.next=6,s.awrap(y.toBuffer(e));case 6:return r.t2=r.sent,r.t3=t,r.t4=r.t1.crypto_shorthash.call(r.t1,r.t2,r.t3),r.next=11,r.t0.awrap.call(r.t0,r.t4);case 11:return r.abrupt(\"return\",r.sent);case 12:case\"end\":return r.stop()}},null,this,null,Promise)},t.crypto_shorthash_keygen=function(){return s.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=c,e.next=3,s.awrap(this.backend.randombytes_buf(this.CRYPTO_SHORTHASH_KEYBYTES));case 3:return e.t1=e.sent,e.abrupt(\"return\",new e.t0(e.t1));case 5:case\"end\":return e.stop()}},null,this,null,Promise)},t.crypto_sign=function(e,t){return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.awrap(this.ensureLoaded());case 2:if(t instanceof u){r.next=4;break}throw TypeError(\"Argument 2 must be an instance of Ed25519SecretKey\");case 4:return r.abrupt(\"return\",this.backend.crypto_sign(e,t));case 5:case\"end\":return r.stop()}},null,this,null,Promise)},t.crypto_sign_open=function(e,t){return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.awrap(this.ensureLoaded());case 2:if(t instanceof o){r.next=4;break}throw TypeError(\"Argument 2 must be an instance of Ed25519PublicKey\");case 4:return r.abrupt(\"return\",this.backend.crypto_sign_open(e,t));case 5:case\"end\":return r.stop()}},null,this,null,Promise)},t.crypto_sign_detached=function(e,t){return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.awrap(this.ensureLoaded());case 2:if(t instanceof u){r.next=4;break}throw TypeError(\"Argument 2 must be an instance of Ed25519SecretKey\");case 4:return r.abrupt(\"return\",this.backend.crypto_sign_detached(e,t));case 5:case\"end\":return r.stop()}},null,this,null,Promise)},t.crypto_sign_verify_detached=function(e,t,r){return s.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.awrap(this.ensureLoaded());case 2:if(t instanceof o){n.next=4;break}throw TypeError(\"Argument 2 must be an instance of Ed25519PublicKey\");case 4:return n.abrupt(\"return\",this.backend.crypto_sign_verify_detached(e,t,r));case 5:case\"end\":return n.stop()}},null,this,null,Promise)},t.crypto_sign_secretkey=function(e){return s.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(96!==e.getLength())){t.next=2;break}throw new p(\"Keypair must be 96 bytes\");case 2:return t.t0=u,t.next=5,s.awrap(y.toBuffer(e.getBuffer().slice(0,64)));case 5:return t.t1=t.sent,t.abrupt(\"return\",new t.t0(t.t1));case 7:case\"end\":return t.stop()}},null,null,null,Promise)},t.crypto_sign_publickey=function(e){return s.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(96!==e.getLength())){t.next=2;break}throw new p(\"Keypair must be 96 bytes\");case 2:return t.abrupt(\"return\",new o(e.getBuffer().slice(64,96)));case 3:case\"end\":return t.stop()}},null,null,null,Promise)},t.crypto_sign_keypair=function(){return s.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.awrap(this.ensureLoaded());case 2:return e.abrupt(\"return\",this.backend.crypto_sign_keypair());case 3:case\"end\":return e.stop()}},null,this,null,Promise)},t.crypto_sign_seed_keypair=function(e){return s.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.awrap(this.ensureLoaded());case 2:return e instanceof c&&(e=e.getBuffer()),t.next=5,s.awrap(y.toBuffer(e));case 5:if(!(32!==(e=t.sent).length)){t.next=8;break}throw new p(\"Seed must be 32 bytes long; got \"+e.length);case 8:return t.abrupt(\"return\",this.backend.crypto_sign_seed_keypair(e));case 9:case\"end\":return t.stop()}},null,this,null,Promise)},t.crypto_sign_ed25519_sk_to_curve25519=function(e){return s.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.awrap(this.ensureLoaded());case 2:return t.t0=l,t.next=5,s.awrap(this.backend.crypto_sign_ed25519_sk_to_curve25519(e));case 5:return t.t1=t.sent,t.abrupt(\"return\",new t.t0(t.t1));case 7:case\"end\":return t.stop()}},null,this,null,Promise)},t.crypto_sign_ed25519_pk_to_curve25519=function(e){return s.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.awrap(this.ensureLoaded());case 2:return t.t0=f,t.next=5,s.awrap(this.backend.crypto_sign_ed25519_pk_to_curve25519(e));case 5:return t.t1=t.sent,t.abrupt(\"return\",new t.t0(t.t1));case 7:case\"end\":return t.stop()}},null,this,null,Promise)},t.crypto_stream=function(e,t,r){return s.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.awrap(this.ensureLoaded());case 2:return n.abrupt(\"return\",this.backend.crypto_stream(e,t,r));case 3:case\"end\":return n.stop()}},null,this,null,Promise)},t.crypto_stream_xor=function(e,t,r){return s.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.awrap(this.ensureLoaded());case 2:return n.abrupt(\"return\",this.backend.crypto_stream_xor(e,t,r));case 3:case\"end\":return n.stop()}},null,this,null,Promise)},t.crypto_stream_keygen=function(){return s.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=c,e.next=3,s.awrap(this.backend.randombytes_buf(this.CRYPTO_STREAM_KEYBYTES));case 3:return e.t1=e.sent,e.abrupt(\"return\",new e.t0(e.t1));case 5:case\"end\":return e.stop()}},null,this,null,Promise)},t.randombytes_buf=function(e){return s.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.awrap(this.ensureLoaded());case 2:return t.next=4,s.awrap(this.backend.randombytes_buf(e));case 4:return t.abrupt(\"return\",t.sent);case 5:case\"end\":return t.stop()}},null,this,null,Promise)},t.randombytes_uniform=function(e){return s.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.awrap(this.ensureLoaded());case 2:return t.abrupt(\"return\",this.backend.randombytes_uniform(e));case 3:case\"end\":return t.stop()}},null,this,null,Promise)},t.sodium_add=function(e,t){return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.awrap(this.ensureLoaded());case 2:return r.t0=s,r.t1=this.backend,r.next=6,s.awrap(y.toBuffer(e));case 6:return r.t2=r.sent,r.next=9,s.awrap(y.toBuffer(t));case 9:return r.t3=r.sent,r.t4=r.t1.sodium_add.call(r.t1,r.t2,r.t3),r.next=13,r.t0.awrap.call(r.t0,r.t4);case 13:return r.abrupt(\"return\",r.sent);case 14:case\"end\":return r.stop()}},null,this,null,Promise)},t.sodium_bin2hex=function(e){return s.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.awrap(this.ensureLoaded());case 2:return t.abrupt(\"return\",this.backend.sodium_bin2hex(e));case 3:case\"end\":return t.stop()}},null,this,null,Promise)},t.sodium_compare=function(e,t){return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.awrap(this.ensureLoaded());case 2:return r.abrupt(\"return\",this.backend.sodium_compare(e,t));case 3:case\"end\":return r.stop()}},null,this,null,Promise)},t.sodium_hex2bin=function(e){return s.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.awrap(this.ensureLoaded());case 2:return t.abrupt(\"return\",this.backend.sodium_hex2bin(e));case 3:case\"end\":return t.stop()}},null,this,null,Promise)},t.sodium_increment=function(e){return s.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.awrap(this.ensureLoaded());case 2:return t.abrupt(\"return\",this.backend.sodium_increment(e));case 3:case\"end\":return t.stop()}},null,this,null,Promise)},t.sodium_is_zero=function(e,t){return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.awrap(this.ensureLoaded());case 2:return r.abrupt(\"return\",this.backend.sodium_is_zero(e,t));case 3:case\"end\":return r.stop()}},null,this,null,Promise)},t.sodium_memcmp=function(e,t){return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.awrap(this.ensureLoaded());case 2:return r.abrupt(\"return\",this.backend.sodium_memcmp(e,t));case 3:case\"end\":return r.stop()}},null,this,null,Promise)},t.sodium_memzero=function(e){return s.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.awrap(this.ensureLoaded());case 2:return t.next=4,s.awrap(this.backend.sodium_memzero(e));case 4:case\"end\":return t.stop()}},null,this,null,Promise)},t.sodium_pad=function(e,t){return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.awrap(this.ensureLoaded());case 2:return r.abrupt(\"return\",this.backend.sodium_pad(e,t));case 3:case\"end\":return r.stop()}},null,this,null,Promise)},t.sodium_unpad=function(e,t){return s.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.awrap(this.ensureLoaded());case 2:return r.abrupt(\"return\",this.backend.sodium_unpad(e,t));case 3:case\"end\":return r.stop()}},null,this,null,Promise)},e}();r.exports=d}).call(this,r)}","map":"{\"version\":3,\"sources\":[\"<anon>\"],\"names\":[],\"mappings\":\"\"}"}