{"code":"function module(t,e,h){var a=t(\"./aes\"),i=t(\"safe-buffer\").Buffer,r=t(\"cipher-base\"),s=t(\"inherits\"),n=t(\"./ghash\"),o=t(\"buffer-xor\"),u=t(\"./incr32\");function c(t,e,h,s){r.call(this);var o=i.alloc(4,0);this._cipher=new a.AES(e);var c=this._cipher.encryptBlock(o);this._ghash=new n(c),h=function(t,e,h){if(12===e.length)return t._finID=i.concat([e,i.from([0,0,0,1])]),i.concat([e,i.from([0,0,0,2])]);var a=new n(h),r=e.length,s=r%16;a.update(e),s&&(s=16-s,a.update(i.alloc(s,0))),a.update(i.alloc(8,0));var o=i.alloc(8);o.writeUIntBE(8*r,0,8),a.update(o),t._finID=a.state;var c=i.from(t._finID);return u(c),c}(this,h,c),this._prev=i.from(h),this._cache=i.allocUnsafe(0),this._secCache=i.allocUnsafe(0),this._decrypt=s,this._alen=0,this._len=0,this._mode=t,this._authTag=null,this._called=!1}s(c,r),c.prototype._update=function(t){if(!this._called&&this._alen){var e=16-this._alen%16;e<16&&(e=i.alloc(e,0),this._ghash.update(e))}this._called=!0;var h=this._mode.encrypt(this,t);return this._decrypt?this._ghash.update(t):this._ghash.update(h),this._len+=t.length,h},c.prototype._final=function(){if(this._decrypt&&!this._authTag)throw Error(\"Unsupported state or unable to authenticate data\");var t=o(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(t,e){var h=0;t.length!==e.length&&h++;for(var a=Math.min(t.length,e.length),i=0;i<a;++i)h+=t[i]^e[i];return h}(t,this._authTag))throw Error(\"Unsupported state or unable to authenticate data\");this._authTag=t,this._cipher.scrub()},c.prototype.getAuthTag=function t(){if(this._decrypt||!i.isBuffer(this._authTag))throw Error(\"Attempting to get auth tag in unsupported state\");return this._authTag},c.prototype.setAuthTag=function t(t){if(!this._decrypt)throw Error(\"Attempting to set auth tag in unsupported state\");this._authTag=t},c.prototype.setAAD=function t(t){if(this._called)throw Error(\"Attempting to set AAD in unsupported state\");this._ghash.update(t),this._alen+=t.length},h.exports=c}","map":"{\"version\":3,\"sources\":[\"<anon>\"],\"names\":[],\"mappings\":\"\"}"}