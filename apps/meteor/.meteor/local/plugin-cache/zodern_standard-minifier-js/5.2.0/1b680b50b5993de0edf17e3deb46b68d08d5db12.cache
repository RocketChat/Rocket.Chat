{"code":"function module(e,t,i){let r,s,a,n,o,l;i.export({InviteUserAgentClient:()=>g}),i.link(\"../dialogs\",{Dialog(e){r=e},SessionDialog(e){s=e}},0),i.link(\"../session\",{SignalingState(e){a=e}},1),i.link(\"../transactions\",{InviteClientTransaction(e){n=e},TransactionState(e){o=e}},2),i.link(\"./user-agent-client\",{UserAgentClient(e){l=e}},3);class g extends l{constructor(e,t,i){super(n,e,t,i),this.confirmedDialogAcks=new Map,this.confirmedDialogs=new Map,this.earlyDialogs=new Map,this.delegate=i}dispose(){this.earlyDialogs.forEach(e=>e.dispose()),this.earlyDialogs.clear(),super.dispose()}onTransportError(e){if(this.transaction.state===o.Calling)return super.onTransportError(e);this.logger.error(e.message),this.logger.error(\"User agent client request transport error while sending ACK.\")}receiveResponse(e){if(!this.authenticationGuard(e))return;let t=e.statusCode?e.statusCode.toString():\"\";if(!t)throw Error(\"Response status code undefined.\");switch(!0){case/^100$/.test(t):this.delegate&&this.delegate.onTrying&&this.delegate.onTrying({message:e});return;case/^1[0-9]{2}$/.test(t):{if(!e.toTag){this.logger.warn(\"Non-100 1xx INVITE response received without a to tag, dropping.\");return}let t=e.parseHeader(\"contact\");if(!t){this.logger.error(\"Non-100 1xx INVITE response received without a Contact header field, dropping.\");return}let i=r.initialDialogStateForUserAgentClient(this.message,e),o=this.earlyDialogs.get(i.id);if(!o){let e=this.transaction;if(!(e instanceof n))throw Error(\"Transaction not instance of InviteClientTransaction.\");o=new s(e,this.core,i),this.earlyDialogs.set(o.id,o)}if(!o.reliableSequenceGuard(e)){this.logger.warn(\"1xx INVITE reliable response received out of order or is a retransmission, dropping.\");return}(o.signalingState===a.Initial||o.signalingState===a.HaveLocalOffer)&&o.signalingStateTransition(e);let l=o;this.delegate&&this.delegate.onProgress&&this.delegate.onProgress({message:e,session:l,prack:e=>{let t=l.prack(void 0,e);return t}})}return;case/^2[0-9]{2}$/.test(t):{if(!e.toTag){this.logger.error(\"2xx INVITE response received without a to tag, dropping.\");return}let t=e.parseHeader(\"contact\");if(!t){this.logger.error(\"2xx INVITE response received without a Contact header field, dropping.\");return}let i=r.initialDialogStateForUserAgentClient(this.message,e),o=this.confirmedDialogs.get(i.id);if(o){let e=this.confirmedDialogAcks.get(i.id);if(e){let t=this.transaction;if(!(t instanceof n))throw Error(\"Client transaction not instance of InviteClientTransaction.\");t.ackResponse(e.message)}return}if(o=this.earlyDialogs.get(i.id))o.confirm(),o.recomputeRouteSet(e),this.earlyDialogs.delete(o.id),this.confirmedDialogs.set(o.id,o);else{let e=this.transaction;if(!(e instanceof n))throw Error(\"Transaction not instance of InviteClientTransaction.\");o=new s(e,this.core,i),this.confirmedDialogs.set(o.id,o)}(o.signalingState===a.Initial||o.signalingState===a.HaveLocalOffer)&&o.signalingStateTransition(e);let l=o;if(this.delegate&&this.delegate.onAccept)this.delegate.onAccept({message:e,session:l,ack:e=>{let t=l.ack(e);return this.confirmedDialogAcks.set(l.id,t),t}});else{let e=l.ack();this.confirmedDialogAcks.set(l.id,e)}}return;case/^3[0-9]{2}$/.test(t):this.earlyDialogs.forEach(e=>e.dispose()),this.earlyDialogs.clear(),this.delegate&&this.delegate.onRedirect&&this.delegate.onRedirect({message:e});return;case/^[4-6][0-9]{2}$/.test(t):this.earlyDialogs.forEach(e=>e.dispose()),this.earlyDialogs.clear(),this.delegate&&this.delegate.onReject&&this.delegate.onReject({message:e});return;default:throw Error(`Invalid status code ${t}`)}throw Error(`Executing what should be an unreachable code path receiving ${t} response.`)}}}","map":"{\"version\":3,\"sources\":[\"<anon>\"],\"names\":[],\"mappings\":\"\"}"}