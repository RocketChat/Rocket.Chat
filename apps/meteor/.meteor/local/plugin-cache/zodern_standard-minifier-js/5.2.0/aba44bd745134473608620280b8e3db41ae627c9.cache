{"code":"function module(e,r,a){var t;let s,n,o;a.export({Parser:()=>t}),a.link(\"../../grammar\",{Grammar(e){s=e}},0),a.link(\"./incoming-request-message\",{IncomingRequestMessage(e){n=e}},1),a.link(\"./incoming-response-message\",{IncomingResponseMessage(e){o=e}},2),function(e){function r(e,r){let a=r,t=0,s=0;if(e.substring(a,a+2).match(/(^\\r\\n)/))return -2;for(;0===t;){if(-1===(s=e.indexOf(\"\\r\\n\",a)))return s;!e.substring(s+2,s+4).match(/(^\\r\\n)/)&&e.charAt(s+2).match(/(^\\s+)/)?a=s+2:t=s}return t}function a(e,r,a,t){let n;let d=r.indexOf(\":\",a),c=r.substring(a,d).trim(),i=r.substring(d+1,t).trim();switch(c.toLowerCase()){case\"via\":case\"v\":e.addHeader(\"via\",i),1===e.getHeaders(\"via\").length?(n=e.parseHeader(\"Via\"))&&(e.via=n,e.viaBranch=n.branch):n=0;break;case\"from\":case\"f\":e.setHeader(\"from\",i),(n=e.parseHeader(\"from\"))&&(e.from=n,e.fromTag=n.getParam(\"tag\"));break;case\"to\":case\"t\":e.setHeader(\"to\",i),(n=e.parseHeader(\"to\"))&&(e.to=n,e.toTag=n.getParam(\"tag\"));break;case\"record-route\":if(-1===(n=s.parse(i,\"Record_Route\"))||!(n instanceof Array)){n=void 0;break}n.forEach(r=>{e.addHeader(\"record-route\",i.substring(r.position,r.offset)),e.headers[\"Record-Route\"][e.getHeaders(\"record-route\").length-1].parsed=r.parsed});break;case\"call-id\":case\"i\":e.setHeader(\"call-id\",i),(n=e.parseHeader(\"call-id\"))&&(e.callId=i);break;case\"contact\":case\"m\":if(-1===(n=s.parse(i,\"Contact\"))||!(n instanceof Array)){n=void 0;break}n.forEach(r=>{e.addHeader(\"contact\",i.substring(r.position,r.offset)),e.headers.Contact[e.getHeaders(\"contact\").length-1].parsed=r.parsed});break;case\"content-length\":case\"l\":e.setHeader(\"content-length\",i),n=e.parseHeader(\"content-length\");break;case\"content-type\":case\"c\":e.setHeader(\"content-type\",i),n=e.parseHeader(\"content-type\");break;case\"cseq\":e.setHeader(\"cseq\",i),(n=e.parseHeader(\"cseq\"))&&(e.cseq=n.value),e instanceof o&&(e.method=n.method);break;case\"max-forwards\":e.setHeader(\"max-forwards\",i),n=e.parseHeader(\"max-forwards\");break;case\"www-authenticate\":e.setHeader(\"www-authenticate\",i),n=e.parseHeader(\"www-authenticate\");break;case\"proxy-authenticate\":e.setHeader(\"proxy-authenticate\",i),n=e.parseHeader(\"proxy-authenticate\");break;case\"refer-to\":case\"r\":e.setHeader(\"refer-to\",i),(n=e.parseHeader(\"refer-to\"))&&(e.referTo=n);break;default:e.addHeader(c.toLowerCase(),i),n=0}return void 0!==n||{error:\"error parsing header '\"+c+\"'\"}}e.getHeader=r,e.parseHeader=a,e.parseMessage=function(e,t){let d,c,i=0,u=e.indexOf(\"\\r\\n\");if(-1===u){t.warn(\"no CRLF found, not a SIP message, discarded\");return}let f=e.substring(0,u),g=s.parse(f,\"Request_Response\");if(-1===g){t.warn('error parsing first line of SIP message: \"'+f+'\"');return}for(g.status_code?((d=new o).statusCode=g.status_code,d.reasonPhrase=g.reason_phrase):((d=new n).method=g.method,d.ruri=g.uri),d.data=e,i=u+2;;){if(-2===(u=r(e,i))){c=i+2;break}if(-1===u){t.error(\"malformed message\");return}let s=a(d,e,i,u);if(s&&!0!==s){t.error(s.error);return}i=u+2}return d.hasHeader(\"content-length\")?d.body=e.substr(c,Number(d.getHeader(\"content-length\"))):d.body=e.substring(c),d}}(t||a.runSetters(t={},[\"Parser\"]))}","map":"{\"version\":3,\"sources\":[\"<anon>\"],\"names\":[],\"mappings\":\"\"}"}