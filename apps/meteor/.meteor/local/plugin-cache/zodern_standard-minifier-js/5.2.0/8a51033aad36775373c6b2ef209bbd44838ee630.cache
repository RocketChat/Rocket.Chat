{"code":"function module(e,t,n){\"use strict\";let o=e(\"./stringify\"),{MAX_LENGTH:i,CHAR_BACKSLASH:p,CHAR_BACKTICK:s,CHAR_COMMA:l,CHAR_DOT:r,CHAR_LEFT_PARENTHESES:a,CHAR_RIGHT_PARENTHESES:u,CHAR_LEFT_CURLY_BRACE:c,CHAR_RIGHT_CURLY_BRACE:y,CHAR_LEFT_SQUARE_BRACKET:f,CHAR_RIGHT_SQUARE_BRACKET:g,CHAR_DOUBLE_QUOTE:d,CHAR_SINGLE_QUOTE:h,CHAR_NO_BREAK_SPACE:x,CHAR_ZERO_WIDTH_NOBREAK_SPACE:m}=e(\"./constants\");n.exports=(e,t={})=>{let n;if(\"string\"!=typeof e)throw TypeError(\"Expected a string\");let v=t||{},b=\"number\"==typeof v.maxLength?Math.min(i,v.maxLength):i;if(e.length>b)throw SyntaxError(`Input length (${e.length}), exceeds max characters (${b})`);let k={type:\"root\",input:e,nodes:[]},E=[k],w=k,$=k,L=0,O=e.length,Q=0,C=0,I=()=>e[Q++],M=e=>{if(\"text\"===e.type&&\"dot\"===$.type&&($.type=\"text\"),$&&\"text\"===$.type&&\"text\"===e.type){$.value+=e.value;return}return w.nodes.push(e),e.parent=w,e.prev=$,$=e,e};for(M({type:\"bos\"});Q<O;)if(w=E[E.length-1],(n=I())!==m&&n!==x){if(n===p){M({type:\"text\",value:(t.keepEscaping?n:\"\")+I()});continue}if(n===g){M({type:\"text\",value:\"\\\\\"+n});continue}if(n===f){let e;for(L++;Q<O&&(e=I());){if(n+=e,e===f){L++;continue}if(e===p){n+=I();continue}if(e===g&&0==--L)break}M({type:\"text\",value:n});continue}if(n===a){w=M({type:\"paren\",nodes:[]}),E.push(w),M({type:\"text\",value:n});continue}if(n===u){if(\"paren\"!==w.type){M({type:\"text\",value:n});continue}w=E.pop(),M({type:\"text\",value:n}),w=E[E.length-1];continue}if(n===d||n===h||n===s){let e,o=n;for(!0!==t.keepQuotes&&(n=\"\");Q<O&&(e=I());){if(e===p){n+=e+I();continue}if(e===o){!0===t.keepQuotes&&(n+=e);break}n+=e}M({type:\"text\",value:n});continue}if(n===c){C++,w=M({type:\"brace\",open:!0,close:!1,dollar:$.value&&\"$\"===$.value.slice(-1)||!0===w.dollar,depth:C,commas:0,ranges:0,nodes:[]}),E.push(w),M({type:\"open\",value:n});continue}if(n===y){if(\"brace\"!==w.type){M({type:\"text\",value:n});continue}(w=E.pop()).close=!0,M({type:\"close\",value:n}),C--,w=E[E.length-1];continue}if(n===l&&C>0){if(w.ranges>0){w.ranges=0;let e=w.nodes.shift();w.nodes=[e,{type:\"text\",value:o(w)}]}M({type:\"comma\",value:n}),w.commas++;continue}if(n===r&&C>0&&0===w.commas){let e=w.nodes;if(0===C||0===e.length){M({type:\"text\",value:n});continue}if(\"dot\"===$.type){if(w.range=[],$.value+=n,$.type=\"range\",3!==w.nodes.length&&5!==w.nodes.length){w.invalid=!0,w.ranges=0,$.type=\"text\";continue}w.ranges++,w.args=[];continue}if(\"range\"===$.type){e.pop();let t=e[e.length-1];t.value+=$.value+n,$=t,w.ranges--;continue}M({type:\"dot\",value:n});continue}M({type:\"text\",value:n})}do if(\"root\"!==(w=E.pop()).type){w.nodes.forEach(e=>{e.nodes||(\"open\"===e.type&&(e.isOpen=!0),\"close\"===e.type&&(e.isClose=!0),e.nodes||(e.type=\"text\"),e.invalid=!0)});let e=E[E.length-1],t=e.nodes.indexOf(w);e.nodes.splice(t,1,...w.nodes)}while(E.length>0);return M({type:\"eos\"}),k}}","map":"{\"version\":3,\"sources\":[\"<anon>\"],\"names\":[],\"mappings\":\"\"}"}