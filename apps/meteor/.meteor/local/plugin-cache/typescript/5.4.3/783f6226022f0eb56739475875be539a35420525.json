{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/workspace/VersionCard/modals/RegisterWorkspaceSetupModal/RegisterWorkspaceSetupStepTwoModal.tsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","topLevelAwait","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"client/views/admin/workspace/VersionCard/modals/RegisterWorkspaceSetupModal/RegisterWorkspaceSetupStepTwoModal.tsx","filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/workspace/VersionCard/modals/RegisterWorkspaceSetupModal/RegisterWorkspaceSetupStepTwoModal.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/workspace/VersionCard/modals/RegisterWorkspaceSetupModal/RegisterWorkspaceSetupStepTwoModal.tsx","sourceRoot":"","sources":["client/views/admin/workspace/VersionCard/modals/RegisterWorkspaceSetupModal/RegisterWorkspaceSetupStepTwoModal.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Modal, Box, Field, FieldLabel, FieldRow, TextInput } from '@rocket.chat/fuselage';\nimport { useEndpoint, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\nimport React, { useCallback, useEffect } from 'react';\nimport { useTranslation, Trans } from 'react-i18next';\n\ntype Props = {\n\temail: string;\n\tstep: number;\n\tsetStep: (step: number) => void;\n\tonClose: () => void;\n\tintentData: {\n\t\tdevice_code: string;\n\t\tinterval: number;\n\t\tuser_code: string;\n\t};\n\tonSuccess: () => void;\n};\n\nconst setIntervalTime = (interval?: number): number => (interval ? interval * 1000 : 0);\n\nconst RegisterWorkspaceSetupStepTwoModal = ({ email, step, setStep, onClose, intentData, onSuccess, ...props }: Props) => {\n\tconst { t } = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst cloudConfirmationPoll = useEndpoint('GET', '/v1/cloud.confirmationPoll');\n\tconst createRegistrationIntent = useEndpoint('POST', '/v1/cloud.createRegistrationIntent');\n\n\tconst handleBackFromConfirmation = (): void => setStep(step - 1);\n\n\tconst handleResendRegistrationEmail = async () => {\n\t\ttry {\n\t\t\tawait createRegistrationIntent({ resend: true, email });\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Email_sent') });\n\t\t} catch (error: unknown) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t};\n\n\tconst getConfirmation = useCallback(async () => {\n\t\ttry {\n\t\t\tconst { pollData } = await cloudConfirmationPoll({\n\t\t\t\tdeviceCode: intentData.device_code,\n\t\t\t});\n\n\t\t\tif ('successful' in pollData && pollData.successful) {\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Workspace_registered') });\n\t\t\t\tonSuccess();\n\t\t\t}\n\t\t} catch (error: any) {\n\t\t\tconsole.log(error);\n\t\t}\n\t}, [cloudConfirmationPoll, intentData.device_code, dispatchToastMessage, t, onSuccess]);\n\n\tuseEffect(() => {\n\t\tconst pollInterval = setInterval(() => getConfirmation(), setIntervalTime(intentData.interval));\n\n\t\treturn (): void => clearInterval(pollInterval);\n\t}, [getConfirmation, intentData]);\n\n\treturn (\n\t\t<Modal {...props}>\n\t\t\t<Modal.Header>\n\t\t\t\t<Modal.HeaderText>\n\t\t\t\t\t<Modal.Tagline>{t('RegisterWorkspace_Setup_Steps', { step, numberOfSteps: 2 })}</Modal.Tagline>\n\t\t\t\t\t<Modal.Title>{t('Awaiting_confirmation')}</Modal.Title>\n\t\t\t\t</Modal.HeaderText>\n\t\t\t\t<Modal.Close onClick={onClose} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content>\n\t\t\t\t<Box fontSize='p2'>\n\t\t\t\t\t<Box>\n\t\t\t\t\t\t<Trans i18nKey='RegisterWorkspace_Setup_Email_Confirmation'>\n\t\t\t\t\t\t\t<Box is='p'>\n\t\t\t\t\t\t\t\tEmail sent to{' '}\n\t\t\t\t\t\t\t\t<Box is='span' fontScale='p2b'>\n\t\t\t\t\t\t\t\t\t{email}{' '}\n\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\twith a confirmation link.\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Trans>\n\t\t\t\t\t</Box>\n\t\t\t\t\t<Box is='p'>{t('RegisterWorkspace_Setup_Email_Verification')}</Box>\n\t\t\t\t\t<Field pbs={10}>\n\t\t\t\t\t\t<FieldLabel>{t('Security_code')}</FieldLabel>\n\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t<TextInput defaultValue={intentData.user_code} disabled />\n\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t</Field>\n\t\t\t\t</Box>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t{/* FIXME: missing translation */}\n\t\t\t\t<Box is='div' display='flex' justifyContent='start' fontSize='c1' w='full'>\n\t\t\t\t\tDidn’t receive email?{' '}\n\t\t\t\t\t<Box is='a' pi={4} onClick={handleResendRegistrationEmail}>\n\t\t\t\t\t\tResend\n\t\t\t\t\t</Box>{' '}\n\t\t\t\t\tor{' '}\n\t\t\t\t\t<Box is='a' pi={4} onClick={handleBackFromConfirmation}>\n\t\t\t\t\t\tchange email\n\t\t\t\t\t</Box>\n\t\t\t\t</Box>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default RegisterWorkspaceSetupStepTwoModal;\n"]},"targets":{"android":"125.0.0","chrome":"125.0.0","edge":"125.0.0","firefox":"115.0.0","ie":"10.0.0","ios":"17.4.0","opera":"110.0.0","opera_mobile":"80.0.0","safari":"17.4.0","samsung":"24.0.0"},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"production","cwd":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","root":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null,null]},"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true,"DoWhileStatement":{"exit":[null]},"ForInStatement":{"exit":[null]},"ForStatement":{"exit":[null]},"WhileStatement":{"exit":[null]},"ForOfStatement":{"exit":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-regenerator","visitor":{"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/guilhermegazzo/dev/Rocket.Chat/apps/meteor/client/views/admin/workspace/VersionCard/modals/RegisterWorkspaceSetupModal/RegisterWorkspaceSetupStepTwoModal.tsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/views/admin/workspace/VersionCard/modals/RegisterWorkspaceSetupModal/RegisterWorkspaceSetupStepTwoModal.tsx","inputSourceMap":{"version":3,"file":"client/views/admin/workspace/VersionCard/modals/RegisterWorkspaceSetupModal/RegisterWorkspaceSetupStepTwoModal.tsx","sourceRoot":"","sources":["client/views/admin/workspace/VersionCard/modals/RegisterWorkspaceSetupModal/RegisterWorkspaceSetupStepTwoModal.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Modal, Box, Field, FieldLabel, FieldRow, TextInput } from '@rocket.chat/fuselage';\nimport { useEndpoint, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\nimport React, { useCallback, useEffect } from 'react';\nimport { useTranslation, Trans } from 'react-i18next';\n\ntype Props = {\n\temail: string;\n\tstep: number;\n\tsetStep: (step: number) => void;\n\tonClose: () => void;\n\tintentData: {\n\t\tdevice_code: string;\n\t\tinterval: number;\n\t\tuser_code: string;\n\t};\n\tonSuccess: () => void;\n};\n\nconst setIntervalTime = (interval?: number): number => (interval ? interval * 1000 : 0);\n\nconst RegisterWorkspaceSetupStepTwoModal = ({ email, step, setStep, onClose, intentData, onSuccess, ...props }: Props) => {\n\tconst { t } = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst cloudConfirmationPoll = useEndpoint('GET', '/v1/cloud.confirmationPoll');\n\tconst createRegistrationIntent = useEndpoint('POST', '/v1/cloud.createRegistrationIntent');\n\n\tconst handleBackFromConfirmation = (): void => setStep(step - 1);\n\n\tconst handleResendRegistrationEmail = async () => {\n\t\ttry {\n\t\t\tawait createRegistrationIntent({ resend: true, email });\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Email_sent') });\n\t\t} catch (error: unknown) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t};\n\n\tconst getConfirmation = useCallback(async () => {\n\t\ttry {\n\t\t\tconst { pollData } = await cloudConfirmationPoll({\n\t\t\t\tdeviceCode: intentData.device_code,\n\t\t\t});\n\n\t\t\tif ('successful' in pollData && pollData.successful) {\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Workspace_registered') });\n\t\t\t\tonSuccess();\n\t\t\t}\n\t\t} catch (error: any) {\n\t\t\tconsole.log(error);\n\t\t}\n\t}, [cloudConfirmationPoll, intentData.device_code, dispatchToastMessage, t, onSuccess]);\n\n\tuseEffect(() => {\n\t\tconst pollInterval = setInterval(() => getConfirmation(), setIntervalTime(intentData.interval));\n\n\t\treturn (): void => clearInterval(pollInterval);\n\t}, [getConfirmation, intentData]);\n\n\treturn (\n\t\t<Modal {...props}>\n\t\t\t<Modal.Header>\n\t\t\t\t<Modal.HeaderText>\n\t\t\t\t\t<Modal.Tagline>{t('RegisterWorkspace_Setup_Steps', { step, numberOfSteps: 2 })}</Modal.Tagline>\n\t\t\t\t\t<Modal.Title>{t('Awaiting_confirmation')}</Modal.Title>\n\t\t\t\t</Modal.HeaderText>\n\t\t\t\t<Modal.Close onClick={onClose} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content>\n\t\t\t\t<Box fontSize='p2'>\n\t\t\t\t\t<Box>\n\t\t\t\t\t\t<Trans i18nKey='RegisterWorkspace_Setup_Email_Confirmation'>\n\t\t\t\t\t\t\t<Box is='p'>\n\t\t\t\t\t\t\t\tEmail sent to{' '}\n\t\t\t\t\t\t\t\t<Box is='span' fontScale='p2b'>\n\t\t\t\t\t\t\t\t\t{email}{' '}\n\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\twith a confirmation link.\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Trans>\n\t\t\t\t\t</Box>\n\t\t\t\t\t<Box is='p'>{t('RegisterWorkspace_Setup_Email_Verification')}</Box>\n\t\t\t\t\t<Field pbs={10}>\n\t\t\t\t\t\t<FieldLabel>{t('Security_code')}</FieldLabel>\n\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t<TextInput defaultValue={intentData.user_code} disabled />\n\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t</Field>\n\t\t\t\t</Box>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t{/* FIXME: missing translation */}\n\t\t\t\t<Box is='div' display='flex' justifyContent='start' fontSize='c1' w='full'>\n\t\t\t\t\tDidn’t receive email?{' '}\n\t\t\t\t\t<Box is='a' pi={4} onClick={handleResendRegistrationEmail}>\n\t\t\t\t\t\tResend\n\t\t\t\t\t</Box>{' '}\n\t\t\t\t\tor{' '}\n\t\t\t\t\t<Box is='a' pi={4} onClick={handleBackFromConfirmation}>\n\t\t\t\t\t\tchange email\n\t\t\t\t\t</Box>\n\t\t\t\t</Box>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default RegisterWorkspaceSetupStepTwoModal;\n"]}}},"code":"var _excluded = [\"email\", \"step\", \"setStep\", \"onClose\", \"intentData\", \"onSuccess\"];\nvar _regeneratorRuntime;\nmodule.link(\"@babel/runtime/regenerator\", {\n  default: function (v) {\n    _regeneratorRuntime = v;\n  }\n}, 0);\nvar _objectWithoutProperties;\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default: function (v) {\n    _objectWithoutProperties = v;\n  }\n}, 1);\nvar Modal, Box, Field, FieldLabel, FieldRow, TextInput;\nmodule.link(\"@rocket.chat/fuselage\", {\n  Modal: function (v) {\n    Modal = v;\n  },\n  Box: function (v) {\n    Box = v;\n  },\n  Field: function (v) {\n    Field = v;\n  },\n  FieldLabel: function (v) {\n    FieldLabel = v;\n  },\n  FieldRow: function (v) {\n    FieldRow = v;\n  },\n  TextInput: function (v) {\n    TextInput = v;\n  }\n}, 0);\nvar useEndpoint, useToastMessageDispatch;\nmodule.link(\"@rocket.chat/ui-contexts\", {\n  useEndpoint: function (v) {\n    useEndpoint = v;\n  },\n  useToastMessageDispatch: function (v) {\n    useToastMessageDispatch = v;\n  }\n}, 1);\nvar React, useCallback, useEffect;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  useCallback: function (v) {\n    useCallback = v;\n  },\n  useEffect: function (v) {\n    useEffect = v;\n  }\n}, 2);\nvar useTranslation, Trans;\nmodule.link(\"react-i18next\", {\n  useTranslation: function (v) {\n    useTranslation = v;\n  },\n  Trans: function (v) {\n    Trans = v;\n  }\n}, 3);\nvar setIntervalTime = function (interval) {\n  return interval ? interval * 1000 : 0;\n};\nvar RegisterWorkspaceSetupStepTwoModal = function (_ref) {\n  var email = _ref.email,\n    step = _ref.step,\n    setStep = _ref.setStep,\n    onClose = _ref.onClose,\n    intentData = _ref.intentData,\n    onSuccess = _ref.onSuccess,\n    props = _objectWithoutProperties(_ref, _excluded);\n  var _useTranslation = useTranslation(),\n    t = _useTranslation.t;\n  var dispatchToastMessage = useToastMessageDispatch();\n  var cloudConfirmationPoll = useEndpoint('GET', '/v1/cloud.confirmationPoll');\n  var createRegistrationIntent = useEndpoint('POST', '/v1/cloud.createRegistrationIntent');\n  var handleBackFromConfirmation = function () {\n    return setStep(step - 1);\n  };\n  var handleResendRegistrationEmail = function () {\n    function _callee() {\n      return _regeneratorRuntime.async(function () {\n        function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(createRegistrationIntent({\n                resend: true,\n                email: email\n              }));\n            case 3:\n              dispatchToastMessage({\n                type: 'success',\n                message: t('Email_sent')\n              });\n              _context.next = 9;\n              break;\n            case 6:\n              _context.prev = 6;\n              _context.t0 = _context[\"catch\"](0);\n              dispatchToastMessage({\n                type: 'error',\n                message: _context.t0\n              });\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n        return _callee$;\n      }(), null, null, [[0, 6]], Promise);\n    }\n    return _callee;\n  }();\n  var getConfirmation = useCallback(function () {\n    function _callee2() {\n      var _await$cloudConfirmat, pollData;\n      return _regeneratorRuntime.async(function () {\n        function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return _regeneratorRuntime.awrap(cloudConfirmationPoll({\n                deviceCode: intentData.device_code\n              }));\n            case 3:\n              _await$cloudConfirmat = _context2.sent;\n              pollData = _await$cloudConfirmat.pollData;\n              if ('successful' in pollData && pollData.successful) {\n                dispatchToastMessage({\n                  type: 'success',\n                  message: t('Workspace_registered')\n                });\n                onSuccess();\n              }\n              _context2.next = 11;\n              break;\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log(_context2.t0);\n            case 11:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n        return _callee2$;\n      }(), null, null, [[0, 8]], Promise);\n    }\n    return _callee2;\n  }(), [cloudConfirmationPoll, intentData.device_code, dispatchToastMessage, t, onSuccess]);\n  useEffect(function () {\n    var pollInterval = setInterval(function () {\n      return getConfirmation();\n    }, setIntervalTime(intentData.interval));\n    return function () {\n      return clearInterval(pollInterval);\n    };\n  }, [getConfirmation, intentData]);\n  return /*#__PURE__*/React.createElement(Modal, props, /*#__PURE__*/React.createElement(Modal.Header, null, /*#__PURE__*/React.createElement(Modal.HeaderText, null, /*#__PURE__*/React.createElement(Modal.Tagline, null, t('RegisterWorkspace_Setup_Steps', {\n    step: step,\n    numberOfSteps: 2\n  })), /*#__PURE__*/React.createElement(Modal.Title, null, t('Awaiting_confirmation'))), /*#__PURE__*/React.createElement(Modal.Close, {\n    onClick: onClose\n  })), /*#__PURE__*/React.createElement(Modal.Content, null, /*#__PURE__*/React.createElement(Box, {\n    fontSize: \"p2\"\n  }, /*#__PURE__*/React.createElement(Box, null, /*#__PURE__*/React.createElement(Trans, {\n    i18nKey: \"RegisterWorkspace_Setup_Email_Confirmation\"\n  }, /*#__PURE__*/React.createElement(Box, {\n    is: \"p\"\n  }, \"Email sent to\", ' ', /*#__PURE__*/React.createElement(Box, {\n    is: \"span\",\n    fontScale: \"p2b\"\n  }, email, ' '), \"with a confirmation link.\"))), /*#__PURE__*/React.createElement(Box, {\n    is: \"p\"\n  }, t('RegisterWorkspace_Setup_Email_Verification')), /*#__PURE__*/React.createElement(Field, {\n    pbs: 10\n  }, /*#__PURE__*/React.createElement(FieldLabel, null, t('Security_code')), /*#__PURE__*/React.createElement(FieldRow, null, /*#__PURE__*/React.createElement(TextInput, {\n    defaultValue: intentData.user_code,\n    disabled: true\n  }))))), /*#__PURE__*/React.createElement(Modal.Footer, null, /*#__PURE__*/React.createElement(Box, {\n    is: \"div\",\n    display: \"flex\",\n    justifyContent: \"start\",\n    fontSize: \"c1\",\n    w: \"full\"\n  }, \"Didn\\u2019t receive email?\", ' ', /*#__PURE__*/React.createElement(Box, {\n    is: \"a\",\n    pi: 4,\n    onClick: handleResendRegistrationEmail\n  }, \"Resend\"), ' ', \"or\", ' ', /*#__PURE__*/React.createElement(Box, {\n    is: \"a\",\n    pi: 4,\n    onClick: handleBackFromConfirmation\n  }, \"change email\"))));\n};\nmodule.exportDefault(RegisterWorkspaceSetupStepTwoModal);","map":{"version":3,"names":["_regeneratorRuntime","module","link","default","v","_objectWithoutProperties","Modal","Box","Field","FieldLabel","FieldRow","TextInput","useEndpoint","useToastMessageDispatch","React","useCallback","useEffect","useTranslation","Trans","setIntervalTime","interval","RegisterWorkspaceSetupStepTwoModal","_ref","email","step","setStep","onClose","intentData","onSuccess","props","_excluded","_useTranslation","t","dispatchToastMessage","cloudConfirmationPoll","createRegistrationIntent","handleBackFromConfirmation","handleResendRegistrationEmail","_callee","async","_callee$","_context","prev","next","awrap","resend","type","message","t0","stop","Promise","getConfirmation","_callee2","_await$cloudConfirmat","pollData","_callee2$","_context2","deviceCode","device_code","sent","successful","console","log","pollInterval","setInterval","clearInterval","createElement","Header","HeaderText","Tagline","numberOfSteps","Title","Close","onClick","Content","fontSize","i18nKey","is","fontScale","pbs","defaultValue","user_code","disabled","Footer","display","justifyContent","w","pi","exportDefault"],"sources":["client/views/admin/workspace/VersionCard/modals/RegisterWorkspaceSetupModal/RegisterWorkspaceSetupStepTwoModal.tsx"],"sourcesContent":["import { Modal, Box, Field, FieldLabel, FieldRow, TextInput } from '@rocket.chat/fuselage';\nimport { useEndpoint, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\nimport React, { useCallback, useEffect } from 'react';\nimport { useTranslation, Trans } from 'react-i18next';\n\ntype Props = {\n\temail: string;\n\tstep: number;\n\tsetStep: (step: number) => void;\n\tonClose: () => void;\n\tintentData: {\n\t\tdevice_code: string;\n\t\tinterval: number;\n\t\tuser_code: string;\n\t};\n\tonSuccess: () => void;\n};\n\nconst setIntervalTime = (interval?: number): number => (interval ? interval * 1000 : 0);\n\nconst RegisterWorkspaceSetupStepTwoModal = ({ email, step, setStep, onClose, intentData, onSuccess, ...props }: Props) => {\n\tconst { t } = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst cloudConfirmationPoll = useEndpoint('GET', '/v1/cloud.confirmationPoll');\n\tconst createRegistrationIntent = useEndpoint('POST', '/v1/cloud.createRegistrationIntent');\n\n\tconst handleBackFromConfirmation = (): void => setStep(step - 1);\n\n\tconst handleResendRegistrationEmail = async () => {\n\t\ttry {\n\t\t\tawait createRegistrationIntent({ resend: true, email });\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Email_sent') });\n\t\t} catch (error: unknown) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t};\n\n\tconst getConfirmation = useCallback(async () => {\n\t\ttry {\n\t\t\tconst { pollData } = await cloudConfirmationPoll({\n\t\t\t\tdeviceCode: intentData.device_code,\n\t\t\t});\n\n\t\t\tif ('successful' in pollData && pollData.successful) {\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Workspace_registered') });\n\t\t\t\tonSuccess();\n\t\t\t}\n\t\t} catch (error: any) {\n\t\t\tconsole.log(error);\n\t\t}\n\t}, [cloudConfirmationPoll, intentData.device_code, dispatchToastMessage, t, onSuccess]);\n\n\tuseEffect(() => {\n\t\tconst pollInterval = setInterval(() => getConfirmation(), setIntervalTime(intentData.interval));\n\n\t\treturn (): void => clearInterval(pollInterval);\n\t}, [getConfirmation, intentData]);\n\n\treturn (\n\t\t<Modal {...props}>\n\t\t\t<Modal.Header>\n\t\t\t\t<Modal.HeaderText>\n\t\t\t\t\t<Modal.Tagline>{t('RegisterWorkspace_Setup_Steps', { step, numberOfSteps: 2 })}</Modal.Tagline>\n\t\t\t\t\t<Modal.Title>{t('Awaiting_confirmation')}</Modal.Title>\n\t\t\t\t</Modal.HeaderText>\n\t\t\t\t<Modal.Close onClick={onClose} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content>\n\t\t\t\t<Box fontSize='p2'>\n\t\t\t\t\t<Box>\n\t\t\t\t\t\t<Trans i18nKey='RegisterWorkspace_Setup_Email_Confirmation'>\n\t\t\t\t\t\t\t<Box is='p'>\n\t\t\t\t\t\t\t\tEmail sent to{' '}\n\t\t\t\t\t\t\t\t<Box is='span' fontScale='p2b'>\n\t\t\t\t\t\t\t\t\t{email}{' '}\n\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\twith a confirmation link.\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Trans>\n\t\t\t\t\t</Box>\n\t\t\t\t\t<Box is='p'>{t('RegisterWorkspace_Setup_Email_Verification')}</Box>\n\t\t\t\t\t<Field pbs={10}>\n\t\t\t\t\t\t<FieldLabel>{t('Security_code')}</FieldLabel>\n\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t<TextInput defaultValue={intentData.user_code} disabled />\n\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t</Field>\n\t\t\t\t</Box>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t{/* FIXME: missing translation */}\n\t\t\t\t<Box is='div' display='flex' justifyContent='start' fontSize='c1' w='full'>\n\t\t\t\t\tDidn’t receive email?{' '}\n\t\t\t\t\t<Box is='a' pi={4} onClick={handleResendRegistrationEmail}>\n\t\t\t\t\t\tResend\n\t\t\t\t\t</Box>{' '}\n\t\t\t\t\tor{' '}\n\t\t\t\t\t<Box is='a' pi={4} onClick={handleBackFromConfirmation}>\n\t\t\t\t\t\tchange email\n\t\t\t\t\t</Box>\n\t\t\t\t</Box>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default RegisterWorkspaceSetupStepTwoModal;\n"],"mappings":"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","ignoreList":[]},"sourceType":"module","externalDependencies":{},"hash":"783f6226022f0eb56739475875be539a35420525"}
