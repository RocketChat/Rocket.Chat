import{$ as C,r as m}from"./index-a5kokUUU.js";const g=typeof document<"u"?C.useLayoutEffect:()=>{},E=e=>{var t;return(t=e==null?void 0:e.ownerDocument)!==null&&t!==void 0?t:document},A=e=>e&&"window"in e&&e.window===e?e:E(e).defaultView||window;function q(e){if(le())e.focus({preventScroll:!0});else{let t=fe(e);e.focus(),ce(t)}}let R=null;function le(){if(R==null){R=!1;try{document.createElement("div").focus({get preventScroll(){return R=!0,!0}})}catch{}}return R}function fe(e){let t=e.parentNode,n=[],r=document.scrollingElement||document.documentElement;for(;t instanceof HTMLElement&&t!==r;)(t.offsetHeight<t.scrollHeight||t.offsetWidth<t.scrollWidth)&&n.push({element:t,scrollTop:t.scrollTop,scrollLeft:t.scrollLeft}),t=t.parentNode;return r instanceof HTMLElement&&n.push({element:r,scrollTop:r.scrollTop,scrollLeft:r.scrollLeft}),n}function ce(e){for(let{element:t,scrollTop:n,scrollLeft:r}of e)t.scrollTop=n,t.scrollLeft=r}function Z(e){var t;return typeof window>"u"||window.navigator==null?!1:((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.brands.some(n=>e.test(n.brand)))||e.test(window.navigator.userAgent)}function se(e){var t;return typeof window<"u"&&window.navigator!=null?e.test(((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.platform)||window.navigator.platform):!1}function V(e){let t=null;return()=>(t==null&&(t=e()),t)}const be=V(function(){return se(/^Mac/i)}),ve=V(function(){return Z(/Chrome/i)}),ee=V(function(){return Z(/Android/i)});let F=new Map,P=new Set;function G(){if(typeof window>"u")return;function e(r){return"propertyName"in r}let t=r=>{if(!e(r)||!r.target)return;let o=F.get(r.target);o||(o=new Set,F.set(r.target,o),r.target.addEventListener("transitioncancel",n,{once:!0})),o.add(r.propertyName)},n=r=>{if(!e(r)||!r.target)return;let o=F.get(r.target);if(o&&(o.delete(r.propertyName),o.size===0&&(r.target.removeEventListener("transitioncancel",n),F.delete(r.target)),F.size===0)){for(let i of P)i();P.clear()}};document.body.addEventListener("transitionrun",t),document.body.addEventListener("transitionend",n)}typeof document<"u"&&(document.readyState!=="loading"?G():document.addEventListener("DOMContentLoaded",G));function $e(e){requestAnimationFrame(()=>{F.size===0?e():P.add(e)})}function pe(e){return e.mozInputSource===0&&e.isTrusted?!0:ee()&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}let k=null,Ee=new Set,_=new Map,S=!1,H=!1;function z(e,t){for(let n of Ee)n(e,t)}function me(e){return!(e.metaKey||!be()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}function D(e){S=!0,me(e)&&(k="keyboard",z("keyboard",e))}function h(e){k="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&(S=!0,z("pointer",e))}function te(e){pe(e)&&(S=!0,k="virtual")}function ne(e){e.target===window||e.target===document||(!S&&!H&&(k="virtual",z("virtual",e)),S=!1,H=!1)}function re(){S=!1,H=!0}function J(e){if(typeof window>"u"||_.get(A(e)))return;const t=A(e),n=E(e);let r=t.HTMLElement.prototype.focus;t.HTMLElement.prototype.focus=function(){S=!0,r.apply(this,arguments)},n.addEventListener("keydown",D,!0),n.addEventListener("keyup",D,!0),n.addEventListener("click",te,!0),t.addEventListener("focus",ne,!0),t.addEventListener("blur",re,!1),typeof PointerEvent<"u"?(n.addEventListener("pointerdown",h,!0),n.addEventListener("pointermove",h,!0),n.addEventListener("pointerup",h,!0)):(n.addEventListener("mousedown",h,!0),n.addEventListener("mousemove",h,!0),n.addEventListener("mouseup",h,!0)),t.addEventListener("beforeunload",()=>{oe(e)},{once:!0}),_.set(t,{focus:r})}const oe=(e,t)=>{const n=A(e),r=E(e);t&&r.removeEventListener("DOMContentLoaded",t),_.has(n)&&(n.HTMLElement.prototype.focus=_.get(n).focus,r.removeEventListener("keydown",D,!0),r.removeEventListener("keyup",D,!0),r.removeEventListener("click",te,!0),n.removeEventListener("focus",ne,!0),n.removeEventListener("blur",re,!1),typeof PointerEvent<"u"?(r.removeEventListener("pointerdown",h,!0),r.removeEventListener("pointermove",h,!0),r.removeEventListener("pointerup",h,!0)):(r.removeEventListener("mousedown",h,!0),r.removeEventListener("mousemove",h,!0),r.removeEventListener("mouseup",h,!0)),_.delete(n))};function he(e){const t=E(e);let n;return t.readyState!=="loading"?J(e):(n=()=>{J(e)},t.addEventListener("DOMContentLoaded",n)),()=>oe(e,n)}typeof document<"u"&&he();function ie(){return k}function we(e){const t=E(e);if(ie()==="virtual"){let n=t.activeElement;$e(()=>{t.activeElement===n&&e.isConnected&&q(e)})}else q(e)}function ge(e){const t=A(e);if(!(e instanceof t.HTMLElement)&&!(e instanceof t.SVGElement))return!1;let{display:n,visibility:r}=e.style,o=n!=="none"&&r!=="hidden"&&r!=="collapse";if(o){const{getComputedStyle:i}=e.ownerDocument.defaultView;let{display:d,visibility:a}=i(e);o=d!=="none"&&a!=="hidden"&&a!=="collapse"}return o}function ye(e,t){return!e.hasAttribute("hidden")&&!e.hasAttribute("data-react-aria-prevent-focus")&&(e.nodeName==="DETAILS"&&t&&t.nodeName!=="SUMMARY"?e.hasAttribute("open"):!0)}function ae(e,t){return e.nodeName!=="#comment"&&ge(e)&&ye(e,t)&&(!e.parentElement||ae(e.parentElement,e))}const Y=C.createContext(null),I="react-aria-focus-scope-restore";let c=null;function _e(e){let{children:t,contain:n,restoreFocus:r,autoFocus:o}=e,i=m.useRef(null),d=m.useRef(null),a=m.useRef([]),{parentNode:$}=m.useContext(Y)||{},u=m.useMemo(()=>new j({scopeRef:a}),[a]);g(()=>{let s=$||v.root;if(v.getTreeNode(s.scopeRef)&&c&&!K(c,s.scopeRef)){let b=v.getTreeNode(c);b&&(s=b)}s.addChild(u),v.addNode(u)},[u,$]),g(()=>{let s=v.getTreeNode(a);s&&(s.contain=!!n)},[n]),g(()=>{var s;let b=(s=i.current)===null||s===void 0?void 0:s.nextSibling,p=[],x=O=>O.stopPropagation();for(;b&&b!==d.current;)p.push(b),b.addEventListener(I,x),b=b.nextSibling;return a.current=p,()=>{for(let O of p)O.removeEventListener(I,x)}},[t]),Fe(a,r,n),Se(a,n),Ce(a,r,n),xe(a,o),m.useEffect(()=>{const s=E(a.current?a.current[0]:void 0).activeElement;let b=null;if(w(s,a.current)){for(let p of v.traverse())p.scopeRef&&w(s,p.scopeRef.current)&&(b=p);b===v.getTreeNode(a)&&(c=b.scopeRef)}},[a]),g(()=>()=>{var s,b,p;let x=(p=(b=v.getTreeNode(a))===null||b===void 0||(s=b.parent)===null||s===void 0?void 0:s.scopeRef)!==null&&p!==void 0?p:null;(a===c||K(a,c))&&(!x||v.getTreeNode(x))&&(c=x),v.removeTreeNode(a)},[a]);let l=m.useMemo(()=>Ne(a),[]),f=m.useMemo(()=>({focusManager:l,parentNode:u}),[u,l]);return C.createElement(Y.Provider,{value:f},C.createElement("span",{"data-focus-scope-start":!0,hidden:!0,ref:i}),t,C.createElement("span",{"data-focus-scope-end":!0,hidden:!0,ref:d}))}function Ne(e){return{focusNext(t={}){let n=e.current,{from:r,tabbable:o,wrap:i,accept:d}=t,a=r||E(n[0]).activeElement,$=n[0].previousElementSibling,u=T(n),l=N(u,{tabbable:o,accept:d},n);l.currentNode=w(a,n)?a:$;let f=l.nextNode();return!f&&i&&(l.currentNode=$,f=l.nextNode()),f&&y(f,!0),f},focusPrevious(t={}){let n=e.current,{from:r,tabbable:o,wrap:i,accept:d}=t,a=r||E(n[0]).activeElement,$=n[n.length-1].nextElementSibling,u=T(n),l=N(u,{tabbable:o,accept:d},n);l.currentNode=w(a,n)?a:$;let f=l.previousNode();return!f&&i&&(l.currentNode=$,f=l.previousNode()),f&&y(f,!0),f},focusFirst(t={}){let n=e.current,{tabbable:r,accept:o}=t,i=T(n),d=N(i,{tabbable:r,accept:o},n);d.currentNode=n[0].previousElementSibling;let a=d.nextNode();return a&&y(a,!0),a},focusLast(t={}){let n=e.current,{tabbable:r,accept:o}=t,i=T(n),d=N(i,{tabbable:r,accept:o},n);d.currentNode=n[n.length-1].nextElementSibling;let a=d.previousNode();return a&&y(a,!0),a}}}const W=["input:not([disabled]):not([type=hidden])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable^="false"])'],Te=W.join(":not([hidden]),")+",[tabindex]:not([disabled]):not([hidden])";W.push('[tabindex]:not([tabindex="-1"]):not([disabled])');const Le=W.join(':not([hidden]):not([tabindex="-1"]),');function T(e){return e[0].parentElement}function M(e){let t=v.getTreeNode(c);for(;t&&t.scopeRef!==e;){if(t.contain)return!1;t=t.parent}return!0}function Se(e,t){let n=m.useRef(void 0),r=m.useRef(void 0);g(()=>{let o=e.current;if(!t){r.current&&(cancelAnimationFrame(r.current),r.current=void 0);return}const i=E(o?o[0]:void 0);let d=u=>{if(u.key!=="Tab"||u.altKey||u.ctrlKey||u.metaKey||!M(e)||u.isComposing)return;let l=i.activeElement,f=e.current;if(!f||!w(l,f))return;let s=T(f),b=N(s,{tabbable:!0},f);if(!l)return;b.currentNode=l;let p=u.shiftKey?b.previousNode():b.nextNode();p||(b.currentNode=u.shiftKey?f[f.length-1].nextElementSibling:f[0].previousElementSibling,p=u.shiftKey?b.previousNode():b.nextNode()),u.preventDefault(),p&&y(p,!0)},a=u=>{(!c||K(c,e))&&w(u.target,e.current)?(c=e,n.current=u.target):M(e)&&!L(u.target,e)?n.current?n.current.focus():c&&c.current&&B(c.current):M(e)&&(n.current=u.target)},$=u=>{r.current&&cancelAnimationFrame(r.current),r.current=requestAnimationFrame(()=>{let l=ie();if(!((l==="virtual"||l===null)&&ee()&&ve())&&i.activeElement&&M(e)&&!L(i.activeElement,e))if(c=e,i.body.contains(u.target)){var s;n.current=u.target,(s=n.current)===null||s===void 0||s.focus()}else c.current&&B(c.current)})};return i.addEventListener("keydown",d,!1),i.addEventListener("focusin",a,!1),o==null||o.forEach(u=>u.addEventListener("focusin",a,!1)),o==null||o.forEach(u=>u.addEventListener("focusout",$,!1)),()=>{i.removeEventListener("keydown",d,!1),i.removeEventListener("focusin",a,!1),o==null||o.forEach(u=>u.removeEventListener("focusin",a,!1)),o==null||o.forEach(u=>u.removeEventListener("focusout",$,!1))}},[e,t]),g(()=>()=>{r.current&&cancelAnimationFrame(r.current)},[r])}function ue(e){return L(e)}function w(e,t){return!e||!t?!1:t.some(n=>n.contains(e))}function L(e,t=null){if(e instanceof Element&&e.closest("[data-react-aria-top-layer]"))return!0;for(let{scopeRef:n}of v.traverse(v.getTreeNode(t)))if(n&&w(e,n.current))return!0;return!1}function K(e,t){var n;let r=(n=v.getTreeNode(t))===null||n===void 0?void 0:n.parent;for(;r;){if(r.scopeRef===e)return!0;r=r.parent}return!1}function y(e,t=!1){if(e!=null&&!t)try{we(e)}catch{}else if(e!=null)try{e.focus()}catch{}}function de(e,t=!0){let n=e[0].previousElementSibling,r=T(e),o=N(r,{tabbable:t},e);o.currentNode=n;let i=o.nextNode();return t&&!i&&(r=T(e),o=N(r,{tabbable:!1},e),o.currentNode=n,i=o.nextNode()),i}function B(e,t=!0){y(de(e,t))}function xe(e,t){const n=C.useRef(t);m.useEffect(()=>{if(n.current){c=e;const r=E(e.current?e.current[0]:void 0);!w(r.activeElement,c.current)&&e.current&&B(e.current)}n.current=!1},[e])}function Fe(e,t,n){g(()=>{if(t||n)return;let r=e.current;const o=E(r?r[0]:void 0);let i=d=>{let a=d.target;w(a,e.current)?c=e:ue(a)||(c=null)};return o.addEventListener("focusin",i,!1),r==null||r.forEach(d=>d.addEventListener("focusin",i,!1)),()=>{o.removeEventListener("focusin",i,!1),r==null||r.forEach(d=>d.removeEventListener("focusin",i,!1))}},[e,t,n])}function Q(e){let t=v.getTreeNode(c);for(;t&&t.scopeRef!==e;){if(t.nodeToRestore)return!1;t=t.parent}return(t==null?void 0:t.scopeRef)===e}function Ce(e,t,n){const r=m.useRef(typeof document<"u"?E(e.current?e.current[0]:void 0).activeElement:null);g(()=>{let o=e.current;const i=E(o?o[0]:void 0);if(!t||n)return;let d=()=>{(!c||K(c,e))&&w(i.activeElement,e.current)&&(c=e)};return i.addEventListener("focusin",d,!1),o==null||o.forEach(a=>a.addEventListener("focusin",d,!1)),()=>{i.removeEventListener("focusin",d,!1),o==null||o.forEach(a=>a.removeEventListener("focusin",d,!1))}},[e,n]),g(()=>{const o=E(e.current?e.current[0]:void 0);if(!t)return;let i=d=>{if(d.key!=="Tab"||d.altKey||d.ctrlKey||d.metaKey||!M(e)||d.isComposing)return;let a=o.activeElement;if(!L(a,e)||!Q(e))return;let $=v.getTreeNode(e);if(!$)return;let u=$.nodeToRestore,l=N(o.body,{tabbable:!0});l.currentNode=a;let f=d.shiftKey?l.previousNode():l.nextNode();if((!u||!o.body.contains(u)||u===o.body)&&(u=void 0,$.nodeToRestore=void 0),(!f||!L(f,e))&&u){l.currentNode=u;do f=d.shiftKey?l.previousNode():l.nextNode();while(L(f,e));d.preventDefault(),d.stopPropagation(),f?y(f,!0):ue(u)?y(u,!0):a.blur()}};return n||o.addEventListener("keydown",i,!0),()=>{n||o.removeEventListener("keydown",i,!0)}},[e,t,n]),g(()=>{const o=E(e.current?e.current[0]:void 0);if(!t)return;let i=v.getTreeNode(e);if(i){var d;return i.nodeToRestore=(d=r.current)!==null&&d!==void 0?d:void 0,()=>{let a=v.getTreeNode(e);if(!a)return;let $=a.nodeToRestore;if(t&&$&&(o.activeElement&&L(o.activeElement,e)||o.activeElement===o.body&&Q(e))){let u=v.clone();requestAnimationFrame(()=>{if(o.activeElement===o.body){let l=u.getTreeNode(e);for(;l;){if(l.nodeToRestore&&l.nodeToRestore.isConnected){X(l.nodeToRestore);return}l=l.parent}for(l=u.getTreeNode(e);l;){if(l.scopeRef&&l.scopeRef.current&&v.getTreeNode(l.scopeRef)){let f=de(l.scopeRef.current,!0);X(f);return}l=l.parent}}})}}}},[e,t])}function X(e){e.dispatchEvent(new CustomEvent(I,{bubbles:!0,cancelable:!0}))&&y(e)}function N(e,t,n){let r=t!=null&&t.tabbable?Le:Te,o=E(e).createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode(i){var d;return!(t==null||(d=t.from)===null||d===void 0)&&d.contains(i)?NodeFilter.FILTER_REJECT:i.matches(r)&&ae(i)&&(!n||w(i,n))&&(!(t!=null&&t.accept)||t.accept(i))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return t!=null&&t.from&&(o.currentNode=t.from),o}class U{get size(){return this.fastMap.size}getTreeNode(t){return this.fastMap.get(t)}addTreeNode(t,n,r){let o=this.fastMap.get(n??null);if(!o)return;let i=new j({scopeRef:t});o.addChild(i),i.parent=o,this.fastMap.set(t,i),r&&(i.nodeToRestore=r)}addNode(t){this.fastMap.set(t.scopeRef,t)}removeTreeNode(t){if(t===null)return;let n=this.fastMap.get(t);if(!n)return;let r=n.parent;for(let i of this.traverse())i!==n&&n.nodeToRestore&&i.nodeToRestore&&n.scopeRef&&n.scopeRef.current&&w(i.nodeToRestore,n.scopeRef.current)&&(i.nodeToRestore=n.nodeToRestore);let o=n.children;r&&(r.removeChild(n),o.size>0&&o.forEach(i=>r&&r.addChild(i))),this.fastMap.delete(n.scopeRef)}*traverse(t=this.root){if(t.scopeRef!=null&&(yield t),t.children.size>0)for(let n of t.children)yield*this.traverse(n)}clone(){var t;let n=new U;var r;for(let o of this.traverse())n.addTreeNode(o.scopeRef,(r=(t=o.parent)===null||t===void 0?void 0:t.scopeRef)!==null&&r!==void 0?r:null,o.nodeToRestore);return n}constructor(){this.fastMap=new Map,this.root=new j({scopeRef:null}),this.fastMap.set(null,this.root)}}class j{addChild(t){this.children.add(t),t.parent=this}removeChild(t){this.children.delete(t),t.parent=void 0}constructor(t){this.children=new Set,this.contain=!1,this.scopeRef=t.scopeRef}}let v=new U;export{_e as FocusScope};
