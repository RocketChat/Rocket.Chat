/*! For license information please see 5146.ff3aeb6e.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunk_rocket_chat_meteor=self.webpackChunk_rocket_chat_meteor||[]).push([[5146],{"./client/components/message/IgnoredContent.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@rocket.chat/fuselage/index.js"),_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/index.js"),IgnoredContent=function IgnoredContent(_ref){var onShowMessageIgnored=_ref.onShowMessageIgnored,t=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__.useTranslation)(),showMessageIgnored=function showMessageIgnored(event){event.stopPropagation(),onShowMessageIgnored()};return react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.MessageBody,{"data-qa-type":"message-body",dir:"auto"},react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.Box,{display:"flex",alignItems:"center",fontSize:"c2",color:"hint"},react__WEBPACK_IMPORTED_MODULE_2__.createElement("span",{tabIndex:0,role:"button",onClick:showMessageIgnored,onKeyDown:function onKeyDown(e){return"Enter"===e.code&&showMessageIgnored(e)},style:{cursor:"pointer"}},react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.Icon,{name:"chevron-left"})," ",t("Message_Ignored"))))};__webpack_exports__.A=(0,react__WEBPACK_IMPORTED_MODULE_2__.memo)(IgnoredContent),IgnoredContent.__docgenInfo={description:"",methods:[],displayName:"IgnoredContent",props:{onShowMessageIgnored:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}}},"./client/components/message/MessageHeader.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{A:function(){return message_MessageHeader}});var fuselage=__webpack_require__("./node_modules/@rocket.chat/fuselage/index.js"),dist=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react=__webpack_require__("./node_modules/react/index.js"),getUserDisplayName=__webpack_require__("./lib/getUserDisplayName.ts"),useFormatDateAndTime=__webpack_require__("./client/hooks/useFormatDateAndTime.ts"),useFormatTime=__webpack_require__("./client/hooks/useFormatTime.ts"),useUserData=__webpack_require__("./client/hooks/useUserData.ts"),UserCardContext=__webpack_require__("./client/views/room/contexts/UserCardContext.ts"),StatusIndicators=__webpack_require__("./client/components/message/StatusIndicators.tsx"),MessageRoles=__webpack_require__("./client/components/message/header/MessageRoles.tsx"),client=__webpack_require__("./app/models/client/index.ts"),useReactiveValue=__webpack_require__("./client/hooks/useReactiveValue.ts");function _toConsumableArray(r){return function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}(r)||function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var MessageListContext=__webpack_require__("./client/components/message/list/MessageListContext.tsx");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var MessageHeader=function MessageHeader(_ref){var message=_ref.message,t=(0,dist.useTranslation)(),formatTime=(0,useFormatTime.a)(),formatDateAndTime=(0,useFormatDateAndTime.J)(),_useUserCard=(0,UserCardContext.P)(),triggerProps=_useUserCard.triggerProps,openUserCard=_useUserCard.openUserCard,showRealName=(0,MessageListContext.ls)(),user=_objectSpread(_objectSpread({},message.u),{},{roles:[]},(0,useUserData.P)(message.u._id)),usernameAndRealNameAreSame=!user.name||user.username===user.name,showUsername=(0,MessageListContext.OH)()&&showRealName&&!usernameAndRealNameAreSame,showRoles=(0,MessageListContext.Rl)(),roles=function useMessageRoles(userId,roomId,shouldLoadRoles){return(0,useReactiveValue.S)((0,react.useCallback)((function(){if(!shouldLoadRoles||!userId)return[];var userRoles=client.UserRoles.findOne(userId),roomRoles=client.RoomRoles.findOne({"u._id":userId,rid:roomId}),roles=[].concat(_toConsumableArray((null==userRoles?void 0:userRoles.roles)||[]),_toConsumableArray((null==roomRoles?void 0:roomRoles.roles)||[]));return client.Roles.find({_id:{$in:roles},description:{$exists:!0,$ne:""}},{fields:{description:1}}).fetch().map((function(_ref){return _ref.description}))}),[userId,roomId,shouldLoadRoles]))}(message.u._id,message.rid,showRoles),shouldShowRolesList=roles.length>0;return react.createElement(fuselage.MessageHeader,null,react.createElement(fuselage.MessageNameContainer,_extends({tabIndex:0,role:"button",id:"".concat(message._id,"-displayName"),"aria-label":(0,getUserDisplayName.N)(user.name,user.username,showRealName),onClick:function onClick(e){return openUserCard(e,message.u.username)},onKeyDown:function onKeyDown(e){("Enter"===e.code||"Space"===e.code)&&openUserCard(e,message.u.username)},style:{cursor:"pointer"}},triggerProps),react.createElement(fuselage.MessageName,_extends({},!showUsername&&{"data-qa-type":"username"},{title:showUsername||usernameAndRealNameAreSame?void 0:"@".concat(user.username),"data-username":user.username}),message.alias||(0,getUserDisplayName.N)(user.name,user.username,showRealName)),showUsername&&react.createElement(react.Fragment,null," ",react.createElement(fuselage.MessageUsername,{"data-username":user.username,"data-qa-type":"username"},"@",user.username))),shouldShowRolesList&&react.createElement(MessageRoles.A,{roles:roles,isBot:message.bot}),react.createElement(fuselage.MessageTimestamp,{id:"".concat(message._id,"-time"),title:formatDateAndTime(message.ts)},formatTime(message.ts)),message.private&&react.createElement(fuselage.MessageStatusPrivateIndicator,null,t("Only_you_can_see_this_message")),react.createElement(StatusIndicators.A,{message:message}))},message_MessageHeader=(0,react.memo)(MessageHeader);MessageHeader.__docgenInfo={description:"",methods:[],displayName:"MessageHeader",props:{message:{required:!0,tsType:{name:"IMessage"},description:""}}}},"./client/components/message/MessageToolbarHolder.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{A:function(){return message_MessageToolbarHolder}});var fuselage=__webpack_require__("./node_modules/@rocket.chat/fuselage/index.js"),lib=__webpack_require__("../../node_modules/@tanstack/react-query/build/lib/index.js"),react=__webpack_require__("./node_modules/react/index.js"),ChatContext=__webpack_require__("./client/views/room/contexts/ChatContext.ts"),index_module=__webpack_require__("./node_modules/@rocket.chat/fuselage-hooks/dist/index.module.js");function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)}))}}function MessageToolbarHolder_slicedToArray(r,e){return function MessageToolbarHolder_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function MessageToolbarHolder_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function MessageToolbarHolder_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return MessageToolbarHolder_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?MessageToolbarHolder_arrayLikeToArray(r,a):void 0}}(r,e)||function MessageToolbarHolder_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MessageToolbarHolder_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var MessageToolbar=(0,react.lazy)((function(){return __webpack_require__.e(4478).then(__webpack_require__.bind(__webpack_require__,"./client/components/message/toolbar/MessageToolbar.tsx"))})),MessageToolbarHolder=function MessageToolbarHolder(_ref){var message=_ref.message,context=_ref.context,chat=(0,ChatContext.Y)(),_useIsVisible2=MessageToolbarHolder_slicedToArray(function useIsVisible(){var _useSafely2=_slicedToArray((0,index_module.useSafely)((0,index_module.useDebouncedState)(!!window.DISABLE_ANIMATION,100)),2),menuVisibility=_useSafely2[0],setMenuVisibility=_useSafely2[1];return[(0,react.useCallback)((function(node){node&&new IntersectionObserver((function(entries){entries.forEach((function(entry){setMenuVisibility(entry.isIntersecting)}))})).observe(node)}),[setMenuVisibility]),menuVisibility]}(),2),ref=_useIsVisible2[0],isVisible=_useIsVisible2[1],_useState2=MessageToolbarHolder_slicedToArray((0,react.useState)(!1),2),isToolbarMenuOpen=_useState2[0],setIsToolbarMenuOpen=_useState2[1],showToolbar=isVisible||isToolbarMenuOpen,depsQueryResult=(0,lib.useQuery)(["toolbox",message._id,context],_asyncToGenerator(_regeneratorRuntime().mark((function _callee(){var room,subscription;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,null==chat?void 0:chat.data.findRoom();case 2:return room=_context.sent,_context.next=5,null==chat?void 0:chat.data.findSubscription();case 5:return subscription=_context.sent,_context.abrupt("return",{room:room,subscription:subscription});case 7:case"end":return _context.stop()}}),_callee)}))),{enabled:showToolbar});return react.createElement(fuselage.MessageToolbarWrapper,{ref:ref,visible:isToolbarMenuOpen},showToolbar&&depsQueryResult.isSuccess&&depsQueryResult.data.room&&react.createElement(react.Suspense,{fallback:null},react.createElement(MessageToolbar,{message:message,messageContext:context,room:depsQueryResult.data.room,subscription:depsQueryResult.data.subscription,onChangeMenuVisibility:setIsToolbarMenuOpen})))},message_MessageToolbarHolder=(0,react.memo)(MessageToolbarHolder);MessageToolbarHolder.__docgenInfo={description:"",methods:[],displayName:"MessageToolbarHolder",props:{message:{required:!0,tsType:{name:"IMessage"},description:""},context:{required:!1,tsType:{name:"union",raw:"| 'message'\n| 'threads'\n| 'message-mobile'\n| 'pinned'\n| 'direct'\n| 'starred'\n| 'mentions'\n| 'federated'\n| 'videoconf'\n| 'search'\n| 'videoconf-threads'",elements:[{name:"literal",value:"'message'"},{name:"literal",value:"'threads'"},{name:"literal",value:"'message-mobile'"},{name:"literal",value:"'pinned'"},{name:"literal",value:"'direct'"},{name:"literal",value:"'starred'"},{name:"literal",value:"'mentions'"},{name:"literal",value:"'federated'"},{name:"literal",value:"'videoconf'"},{name:"literal",value:"'search'"},{name:"literal",value:"'videoconf-threads'"}]},description:""}}}},"./client/components/message/ReadReceiptIndicator.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@rocket.chat/fuselage/index.js"),_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/index.js"),ReadReceiptIndicator=function ReadReceiptIndicator(_ref){var mid=_ref.mid,unread=_ref.unread,t=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__.useTranslation)();return react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.Box,{role:"status",id:"".concat(mid,"-read-status"),"aria-label":t(unread?"Message_sent":"Message_viewed"),position:"absolute",insetBlockStart:2,insetInlineEnd:8},react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.Icon,{size:"x16",name:unread?"check-single":"check-double",color:unread?"annotation":"info"}))};__webpack_exports__.A=ReadReceiptIndicator,ReadReceiptIndicator.__docgenInfo={description:"",methods:[],displayName:"ReadReceiptIndicator",props:{mid:{required:!0,tsType:{name:"IMessage['_id']",raw:"IMessage['_id']"},description:""},unread:{required:!1,tsType:{name:"boolean"},description:""}}}},"./client/components/message/content/BroadcastMetrics.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@rocket.chat/fuselage/index.js"),_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/index.js"),_views_room_contexts_ChatContext__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./client/views/room/contexts/ChatContext.ts"),BroadcastMetrics=function BroadcastMetrics(_ref){var username=_ref.username,message=_ref.message,t=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__.useTranslation)(),chat=(0,_views_room_contexts_ChatContext__WEBPACK_IMPORTED_MODULE_3__.Y)();return react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.MessageBlock,null,react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.MessageMetrics,null,react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.MessageMetricsReply,{"data-username":username,"data-mid":message._id,onClick:function handleReplyButtonClick(){null==chat||chat.flows.replyBroadcast(message)}},t("Reply"))))};__webpack_exports__.A=BroadcastMetrics,BroadcastMetrics.__docgenInfo={description:"",methods:[],displayName:"BroadcastMetrics",props:{username:{required:!0,tsType:{name:"string"},description:""},message:{required:!0,tsType:{name:"IMessage"},description:""}}}},"./client/components/message/content/Location.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_location_MapView__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./client/components/message/content/location/MapView.tsx");function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var Location=function Location(_ref){var _location$coordinates,location=_ref.location,_ref3=_slicedToArray(null!==(_location$coordinates=null==location?void 0:location.coordinates)&&void 0!==_location$coordinates?_location$coordinates:[],2),longitude=_ref3[0],latitude=_ref3[1];return latitude&&longitude?react__WEBPACK_IMPORTED_MODULE_0__.createElement(_location_MapView__WEBPACK_IMPORTED_MODULE_1__.A,{latitude:latitude,longitude:longitude}):null};__webpack_exports__.A=Location,Location.__docgenInfo={description:"",methods:[],displayName:"Location",props:{location:{required:!1,tsType:{name:"IMessage['location']",raw:"IMessage['location']"},description:""}}}},"./client/components/message/content/MessageActions.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{A:function(){return content_MessageActions}});var fuselage=__webpack_require__("./node_modules/@rocket.chat/fuselage/index.js"),index_module=__webpack_require__("./node_modules/@rocket.chat/fuselage-hooks/dist/index.module.js"),react=__webpack_require__("./node_modules/react/index.js"),meteor=__webpack_require__("./.storybook/mocks/meteor.js"),fireGlobalEvent=__webpack_require__("./client/lib/utils/fireGlobalEvent.ts"),RouterProvider=__webpack_require__("./client/providers/RouterProvider.tsx"),embedded=!1;RouterProvider.Q.subscribeToRouteChange((function(){embedded="embedded"===RouterProvider.Q.getSearchParameters().layout}));var isLayoutEmbedded=function isLayoutEmbedded(){return embedded},actionLinks={actions:new Map,register:function register(name,fn){actionLinks.actions.set(name,fn)},run:function run(actionMethodId,message){var _message$actionLinks;if(isLayoutEmbedded())(0,fireGlobalEvent.fireGlobalEvent)("click-action-link",{actionlink:actionMethodId,value:message._id,message:message});else{var actionLink=null===(_message$actionLinks=message.actionLinks)||void 0===_message$actionLinks?void 0:_message$actionLinks.find((function(action){return action.method_id===actionMethodId}));if(!actionLink)throw new meteor.fj.Error("error-invalid-actionlink","Invalid action link");if(!actionLinks.actions.has(actionLink.method_id))throw new meteor.fj.Error("error-invalid-actionlink","Invalid action link");var fn=actionLinks.actions.get(actionLink.method_id);null==fn||fn(message,actionLink.params)}}},MessageAction=__webpack_require__("./client/components/message/content/actions/MessageAction.tsx");function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}var MessageActions=function MessageActions(_ref){var _actions$,message=_ref.message,actions=_ref.actions,runAction=(0,index_module.useMutableCallback)((function(action){return function(){actionLinks.run(action,message)}})),alignment=(null===(_actions$=actions[0])||void 0===_actions$?void 0:_actions$.actionLinksAlignment)||"center";return react.createElement(fuselage.Box,{display:"flex",mb:4,mi:-4,width:"full",justifyContent:alignment},react.createElement(fuselage.ButtonGroup,{align:"center"},actions.map((function(action,key){return react.createElement(MessageAction.A,_extends({key:key,runAction:runAction},action))}))))},content_MessageActions=MessageActions;MessageActions.__docgenInfo={description:"",methods:[],displayName:"MessageActions",props:{message:{required:!0,tsType:{name:"IMessage"},description:""},actions:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\n\ticon: IconName;\n\ti18nLabel?: TranslationKey;\n\tlabel?: string;\n\tmethodId: string;\n\trunAction?: (action: string) => () => void;\n\tactionLinksAlignment?: string;\n}",signature:{properties:[{key:"icon",value:{name:"IconName",required:!0}},{key:"i18nLabel",value:{name:"TranslationKey",required:!1}},{key:"label",value:{name:"string",required:!1}},{key:"methodId",value:{name:"string",required:!0}},{key:"runAction",value:{name:"signature",type:"function",raw:"(action: string) => () => void",signature:{arguments:[{type:{name:"string"},name:"action"}],return:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}}},required:!1}},{key:"actionLinksAlignment",value:{name:"string",required:!1}}]}}],raw:"MessageActionOptions[]"},description:""}}}},"./client/components/message/content/Reactions.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{A:function(){return content_Reactions}});var dist_import=__webpack_require__("./node_modules/@react-aria/toolbar/dist/import.mjs"),fuselage=__webpack_require__("./node_modules/@rocket.chat/fuselage/index.js"),dist=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react=__webpack_require__("./node_modules/react/index.js"),MessageListContext=__webpack_require__("./client/components/message/list/MessageListContext.tsx"),renderEmoji=__webpack_require__("./client/lib/utils/renderEmoji.ts"),lib=__webpack_require__("../../node_modules/@tanstack/react-query/build/lib/index.js"),useGetMessageByID=__webpack_require__("./client/views/room/contextualBar/Threads/hooks/useGetMessageByID.ts"),MarkdownText=__webpack_require__("./client/components/MarkdownText.tsx");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)}))}}var ReactionTooltip=function ReactionTooltip(_ref){var emojiName=_ref.emojiName,usernames=_ref.usernames,mine=_ref.mine,messageId=_ref.messageId,showRealName=_ref.showRealName,username=_ref.username,t=(0,dist.useTranslation)(),key=function getTranslationKey(users,mine){return 0===users.length&&mine?"You_reacted_with":users.length>10?mine?"You_users_and_more_Reacted_with":"Users_and_more_reacted_with":mine?"You_and_users_Reacted_with":"Users_reacted_with"}(usernames,mine),getMessage=(0,useGetMessageByID.J)(),_useQuery=(0,lib.useQuery)(["chat.getMessage","reactions",messageId,usernames],_asyncToGenerator(_regeneratorRuntime().mark((function _callee(){var data,reactions,_reactions$emojiName$,index;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(usernames.length){_context.next=2;break}return _context.abrupt("return",[]);case 2:if(showRealName){_context.next=4;break}return _context.abrupt("return",usernames);case 4:return _context.next=6,getMessage(messageId);case 6:if(data=_context.sent,reactions=data.reactions){_context.next=10;break}return _context.abrupt("return",[]);case 10:if(!username){_context.next=14;break}return(index=reactions[emojiName].usernames.indexOf(username))>=0&&(null===(_reactions$emojiName$=reactions[emojiName].names)||void 0===_reactions$emojiName$||_reactions$emojiName$.splice(index,1)),_context.abrupt("return",(reactions[emojiName].names||usernames).filter(Boolean));case 14:return _context.abrupt("return",reactions[emojiName].names||usernames);case 15:case"end":return _context.stop()}}),_callee)}))),{staleTime:3e5}),users=_useQuery.data;return _useQuery.isLoading?react.createElement(react.Fragment,null,react.createElement(fuselage.Skeleton,{width:"x200",variant:"text",backgroundColor:"surface-light"}),react.createElement(fuselage.Skeleton,{width:"x200",variant:"text",backgroundColor:"surface-light"}),usernames.length>5&&react.createElement(fuselage.Skeleton,{width:"x200",variant:"text",backgroundColor:"surface-light"}),usernames.length>8&&react.createElement(fuselage.Skeleton,{width:"x200",variant:"text",backgroundColor:"surface-light"})):react.createElement(MarkdownText.A,{content:t(key,{counter:usernames.length>10?usernames.length-10:usernames.length,users:(null==users?void 0:users.slice(0,10).join(", "))||"",emoji:emojiName}),variant:"inline"})},reactions_ReactionTooltip=ReactionTooltip;function Reaction_typeof(o){return Reaction_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},Reaction_typeof(o)}ReactionTooltip.__docgenInfo={description:"",methods:[],displayName:"ReactionTooltip",props:{emojiName:{required:!0,tsType:{name:"string"},description:""},usernames:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},username:{required:!0,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},mine:{required:!0,tsType:{name:"boolean"},description:""},showRealName:{required:!0,tsType:{name:"boolean"},description:""},messageId:{required:!0,tsType:{name:"string"},description:""}}};var _excluded=["hasReacted","counter","name","names","messageId"];function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}function Reaction_regeneratorRuntime(){Reaction_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==Reaction_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(Reaction_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Reaction_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}var Reaction=function Reaction(_ref){var hasReacted=_ref.hasReacted,counter=_ref.counter,name=_ref.name,names=_ref.names,messageId=_ref.messageId,props=function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)o=s[r],t.includes(o)||{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,_excluded),t=(0,dist.useTranslation)(),ref=(0,react.useRef)(null),openTooltip=(0,dist.useTooltipOpen)(),closeTooltip=(0,dist.useTooltipClose)(),_useContext=(0,react.useContext)(MessageListContext.N5),showRealName=_useContext.showRealName,username=_useContext.username,mine=hasReacted(name),emojiProps=(0,renderEmoji.P)(name);return react.createElement(fuselage.MessageReaction,_extends({ref:ref,key:name,mine:mine,"aria-label":t("React_with__reaction__",{reaction:name}),"data-tooltip":"",onMouseEnter:function(){var _ref2=function Reaction_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function _next(n){Reaction_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){Reaction_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)}))}}(Reaction_regeneratorRuntime().mark((function _callee(e){return Reaction_regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:e.stopPropagation(),e.preventDefault(),ref.current&&openTooltip(react.createElement(reactions_ReactionTooltip,{emojiName:name,usernames:names,mine:mine,messageId:messageId,showRealName:showRealName,username:username}),ref.current);case 3:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref2.apply(this,arguments)}}(),onMouseLeave:function onMouseLeave(){closeTooltip()}},props),react.createElement(fuselage.MessageReactionEmoji,emojiProps),react.createElement(fuselage.MessageReactionCounter,{counter:counter}))},reactions_Reaction=Reaction;function useToggleReactionMutation_typeof(o){return useToggleReactionMutation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},useToggleReactionMutation_typeof(o)}function useToggleReactionMutation_regeneratorRuntime(){useToggleReactionMutation_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==useToggleReactionMutation_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(useToggleReactionMutation_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function useToggleReactionMutation_asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}Reaction.__docgenInfo={description:"",methods:[],displayName:"Reaction",props:{hasReacted:{required:!0,tsType:{name:"signature",type:"function",raw:"(name: string) => boolean",signature:{arguments:[{type:{name:"string"},name:"name"}],return:{name:"boolean"}}},description:""},counter:{required:!0,tsType:{name:"number"},description:""},name:{required:!0,tsType:{name:"string"},description:""},names:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},messageId:{required:!0,tsType:{name:"string"},description:""}}};var useToggleReactionMutation=function useToggleReactionMutation(options){var uid=(0,dist.useUserId)(),reactToMessage=(0,dist.useEndpoint)("POST","/v1/chat.react");return(0,lib.useMutation)(function(){var _ref2=function useToggleReactionMutation_asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function _next(n){useToggleReactionMutation_asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){useToggleReactionMutation_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)}))}}(useToggleReactionMutation_regeneratorRuntime().mark((function _callee(_ref){var mid,reaction;return useToggleReactionMutation_regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(mid=_ref.mid,reaction=_ref.reaction,uid){_context.next=3;break}throw new Error("Not logged in");case 3:return _context.next=5,reactToMessage({messageId:mid,reaction:reaction});case 5:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref2.apply(this,arguments)}}(),options)},Reactions_excluded=["message"];function Reactions_extends(){return Reactions_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Reactions_extends.apply(null,arguments)}function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var Reactions=function Reactions(_ref){var message=_ref.message,props=function Reactions_objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function Reactions_objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)o=s[r],t.includes(o)||{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,Reactions_excluded),t=(0,dist.useTranslation)(),ref=(0,react.useRef)(null),hasReacted=(0,MessageListContext.T$)(message),openEmojiPicker=(0,MessageListContext.AH)(message),username=(0,react.useContext)(MessageListContext.N5).username,toggleReactionMutation=useToggleReactionMutation(),toolbarProps=(0,dist_import.t)(props,ref).toolbarProps;return react.createElement(fuselage.MessageReactions,Reactions_extends({ref:ref},toolbarProps,props),message.reactions&&Object.entries(message.reactions).map((function(_ref2){var _ref3=_slicedToArray(_ref2,2),name=_ref3[0],reactions=_ref3[1];return react.createElement(reactions_Reaction,{key:name,counter:reactions.usernames.length,hasReacted:hasReacted,name:name,names:reactions.usernames.filter((function(user){return user!==username})).map((function(username){return"@".concat(username)})),messageId:message._id,onKeyDown:function onKeyDown(e){return("Space"===e.code||"Enter"===e.code)&&toggleReactionMutation.mutate({mid:message._id,reaction:name})},onClick:function onClick(){return toggleReactionMutation.mutate({mid:message._id,reaction:name})}})})),react.createElement(fuselage.MessageReactionAction,{title:t("Add_Reaction"),onKeyDown:function onKeyDown(e){return("Space"===e.code||"Enter"===e.code)&&openEmojiPicker(e)},onClick:openEmojiPicker}))},content_Reactions=Reactions;Reactions.__docgenInfo={description:"",methods:[],displayName:"Reactions",props:{message:{required:!0,tsType:{name:"IMessage"},description:""}}}},"./client/components/message/content/UrlPreviews.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{A:function(){return content_UrlPreviews}});var fuselage=__webpack_require__("./node_modules/@rocket.chat/fuselage/index.js"),react=__webpack_require__("./node_modules/react/index.js"),useOembedLayout=__webpack_require__("./client/components/message/hooks/useOembedLayout.ts"),purify=__webpack_require__("./node_modules/dompurify/dist/purify.js"),purify_default=__webpack_require__.n(purify),dist=__webpack_require__("../../packages/ui-contexts/dist/index.js"),MessageCollapsible=__webpack_require__("./client/components/message/MessageCollapsible.tsx"),MarkdownText=__webpack_require__("./client/components/MarkdownText.tsx"),OEmbedPreviewContent=function OEmbedPreviewContent(_ref){var title=_ref.title,description=_ref.description,url=_ref.url,thumb=_ref.thumb,authorName=_ref.authorName,authorUrl=_ref.authorUrl,siteName=_ref.siteName,siteUrl=_ref.siteUrl,showSiteName=siteName&&siteUrl,showAuthorName=authorName&&authorUrl,showFooterSeparator=showSiteName&&showAuthorName;return react.createElement(fuselage.MessageGenericPreviewContent,{thumb:thumb},title&&react.createElement(fuselage.MessageGenericPreviewTitle,{externalUrl:url,title:title},title),description&&react.createElement(fuselage.MessageGenericPreviewDescription,null,description),(showSiteName||showAuthorName)&&react.createElement(fuselage.MessageGenericPreviewFooter,null,react.createElement(fuselage.Box,{display:"flex",justifyContent:"flex-start"},showSiteName&&react.createElement(MarkdownText.A,{variant:"inline",content:"[".concat(siteName,"](").concat(siteUrl,")")}),showFooterSeparator&&react.createElement(fuselage.Box,{marginInline:4},"|"),showAuthorName&&react.createElement(MarkdownText.A,{variant:"inline",content:"[".concat(authorName,"](").concat(authorUrl,")")}))))},urlPreviews_OEmbedPreviewContent=OEmbedPreviewContent;OEmbedPreviewContent.__docgenInfo={description:"",methods:[],displayName:"OEmbedPreviewContent",props:{thumb:{required:!1,tsType:{name:"ReactElement"},description:""},children:{required:!1,tsType:{name:"ReactNode"},description:""}}};var _excluded=["children"];var OEmbedCollapsible=function OEmbedCollapsible(_ref){var children=_ref.children,props=function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)o=s[r],t.includes(o)||{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,_excluded),t=(0,dist.useTranslation)();return react.createElement(MessageCollapsible.A,{title:t("Link_Preview")},react.createElement(fuselage.MessageGenericPreview,null,children,react.createElement(urlPreviews_OEmbedPreviewContent,props)))},urlPreviews_OEmbedCollapsible=OEmbedCollapsible;OEmbedCollapsible.__docgenInfo={description:"",methods:[],displayName:"OEmbedCollapsible",props:{children:{required:!1,tsType:{name:"ReactNode"},description:""}}};var OEmbedHtmlPreview_excluded=["html"];var purifyOptions={ADD_TAGS:["iframe"],ADD_ATTR:["frameborder","allow","allowfullscreen","scrolling","src","style","referrerpolicy"],ALLOW_UNKNOWN_PROTOCOLS:!0},OEmbedHtmlPreview=function OEmbedHtmlPreview(_ref){var html=_ref.html,props=function OEmbedHtmlPreview_objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function OEmbedHtmlPreview_objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)o=s[r],t.includes(o)||{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,OEmbedHtmlPreview_excluded);return react.createElement(urlPreviews_OEmbedCollapsible,props,html&&react.createElement(fuselage.Box,{withRichContent:!0,dangerouslySetInnerHTML:{__html:purify_default().sanitize(html,purifyOptions)}}))},urlPreviews_OEmbedHtmlPreview=OEmbedHtmlPreview;OEmbedHtmlPreview.__docgenInfo={description:"",methods:[],displayName:"OEmbedHtmlPreview"};var OEmbedImagePreview_excluded=["image"];var OEmbedImagePreview=function OEmbedImagePreview(_ref){var image=_ref.image,props=function OEmbedImagePreview_objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function OEmbedImagePreview_objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)o=s[r],t.includes(o)||{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,OEmbedImagePreview_excluded);return react.createElement(urlPreviews_OEmbedCollapsible,props,(null==image?void 0:image.url)&&react.createElement(fuselage.MessageGenericPreviewCoverImage,{height:192,width:368,url:null==image?void 0:image.url}))},urlPreviews_OEmbedImagePreview=OEmbedImagePreview;OEmbedImagePreview.__docgenInfo={description:"",methods:[],displayName:"OEmbedImagePreview"};var ui_client_dist=__webpack_require__("../../packages/ui-client/dist/index.js"),OEmbedLinkPreview_excluded=["image","url"];function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}var OEmbedLinkPreview=function OEmbedLinkPreview(_ref){var image=_ref.image,url=_ref.url,props=function OEmbedLinkPreview_objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function OEmbedLinkPreview_objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)o=s[r],t.includes(o)||{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,OEmbedLinkPreview_excluded);return react.createElement(urlPreviews_OEmbedCollapsible,_extends({url:url},props),(null==image?void 0:image.url)&&url&&react.createElement(ui_client_dist.Gr,{to:url},react.createElement(fuselage.MessageGenericPreviewCoverImage,{height:192,width:368,url:null==image?void 0:image.url})))},urlPreviews_OEmbedLinkPreview=OEmbedLinkPreview;OEmbedLinkPreview.__docgenInfo={description:"",methods:[],displayName:"OEmbedLinkPreview"};var OEmbedResolver=function OEmbedResolver(_ref){var meta=_ref.meta;switch(meta.type){case"rich":case"video":return react.createElement(urlPreviews_OEmbedHtmlPreview,meta);case"photo":return react.createElement(urlPreviews_OEmbedImagePreview,meta);default:return react.createElement(urlPreviews_OEmbedLinkPreview,meta)}},urlPreviews_OEmbedResolver=OEmbedResolver;OEmbedResolver.__docgenInfo={description:"",methods:[],displayName:"OEmbedResolver",props:{meta:{required:!0,tsType:{name:"Partial",elements:[{name:"signature",type:"object",raw:"{\n\tsiteName: string; // nome\n\tsiteUrl: string; // parsedUrl.host\n\tsiteColor: string; // ogColor\n\ttitle: string; // ogTitle\n\tdescription: string; // ogDescription\n\tauthorName: string;\n\tauthorUrl?: string;\n\timage: {\n\t\t// preview?: string; // base64 low res preview\n\t\turl: string;\n\t\tdimensions: {\n\t\t\twidth?: number;\n\t\t\theight?: number;\n\t\t};\n\t};\n\turl: string;\n\ttype: PreviewType;\n\thtml?: string; // for embedded OembedType\n}",signature:{properties:[{key:"siteName",value:{name:"string",required:!0}},{key:"siteUrl",value:{name:"string",required:!0}},{key:"siteColor",value:{name:"string",required:!0}},{key:"title",value:{name:"string",required:!0}},{key:"description",value:{name:"string",required:!0}},{key:"authorName",value:{name:"string",required:!0}},{key:"authorUrl",value:{name:"string",required:!1}},{key:"image",value:{name:"signature",type:"object",raw:"{\n\t// preview?: string; // base64 low res preview\n\turl: string;\n\tdimensions: {\n\t\twidth?: number;\n\t\theight?: number;\n\t};\n}",signature:{properties:[{key:"url",value:{name:"string",required:!0}},{key:"dimensions",value:{name:"signature",type:"object",raw:"{\n\twidth?: number;\n\theight?: number;\n}",signature:{properties:[{key:"width",value:{name:"number",required:!1}},{key:"height",value:{name:"number",required:!1}}]},required:!0}}]},required:!0}},{key:"url",value:{name:"string",required:!0}},{key:"type",value:{name:"union",raw:"'photo' | 'video' | 'link' | 'rich'",elements:[{name:"literal",value:"'photo'"},{name:"literal",value:"'video'"},{name:"literal",value:"'link'"},{name:"literal",value:"'rich'"}],required:!0}},{key:"html",value:{name:"string",required:!1}}]}}],raw:"Partial<{\n\tsiteName: string; // nome\n\tsiteUrl: string; // parsedUrl.host\n\tsiteColor: string; // ogColor\n\ttitle: string; // ogTitle\n\tdescription: string; // ogDescription\n\tauthorName: string;\n\tauthorUrl?: string;\n\timage: {\n\t\t// preview?: string; // base64 low res preview\n\t\turl: string;\n\t\tdimensions: {\n\t\t\twidth?: number;\n\t\t\theight?: number;\n\t\t};\n\t};\n\turl: string;\n\ttype: PreviewType;\n\thtml?: string; // for embedded OembedType\n}>"},description:""}}};var useCollapse=__webpack_require__("./client/components/message/hooks/useCollapse.tsx"),UrlAudioPreview=function UrlAudioPreview(_ref){var url=_ref.url;return react.createElement(fuselage.AudioPlayer,{src:url})},urlPreviews_UrlAudioPreview=UrlAudioPreview;UrlAudioPreview.__docgenInfo={description:"",methods:[],displayName:"UrlAudioPreview"};var UrlImagePreview=function UrlImagePreview(_ref){var url=_ref.url,oembedMaxHeight=(0,useOembedLayout.y)().maxHeight;return react.createElement(fuselage.Box,{maxHeight:oembedMaxHeight,maxWidth:"100%"},react.createElement(fuselage.MessageGenericPreviewImage,{"data-id":url,className:"preview-image",url:url||"",alt:""}))},urlPreviews_UrlImagePreview=UrlImagePreview;UrlImagePreview.__docgenInfo={description:"",methods:[],displayName:"UrlImagePreview"};var style={maxWidth:"100%"},UrlVideoPreview=function UrlVideoPreview(_ref){var url=_ref.url,originalType=_ref.originalType;return react.createElement("video",{controls:!0,style:style},react.createElement("source",{src:url,type:originalType}),"Your browser doesn't support the video element.",react.createElement("track",{kind:"captions"}))},urlPreviews_UrlVideoPreview=UrlVideoPreview;UrlVideoPreview.__docgenInfo={description:"",methods:[],displayName:"UrlVideoPreview"};var UrlPreviewResolver=function UrlPreviewResolver(_ref){var url=_ref.url,type=_ref.type,originalType=_ref.originalType;switch(type){case"audio":return react.createElement(urlPreviews_UrlAudioPreview,{url:url});case"video":return react.createElement(urlPreviews_UrlVideoPreview,{url:url,originalType:originalType});case"image":return react.createElement(urlPreviews_UrlImagePreview,{url:url});default:return null}},urlPreviews_UrlPreviewResolver=UrlPreviewResolver;function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}UrlPreviewResolver.__docgenInfo={description:"",methods:[],displayName:"UrlPreviewResolver",props:{type:{required:!0,tsType:{name:"union",raw:"'image' | 'video' | 'audio'",elements:[{name:"literal",value:"'image'"},{name:"literal",value:"'video'"},{name:"literal",value:"'audio'"}]},description:""},originalType:{required:!0,tsType:{name:"string"},description:""},url:{required:!0,tsType:{name:"string"},description:""}}};var UrlPreview=function UrlPreview(props){var autoLoadMedia=(0,dist.useAttachmentAutoLoadEmbedMedia)(),_useCollapse2=_slicedToArray((0,useCollapse.n)(!autoLoadMedia),2),collapsed=_useCollapse2[0],collapse=_useCollapse2[1],t=(0,dist.useTranslation)();return react.createElement(react.Fragment,null,react.createElement(fuselage.Box,{display:"flex",flexDirection:"row",color:"hint",fontScale:"c1",alignItems:"center"},t("Link_Preview")," ",collapse),!collapsed&&react.createElement(urlPreviews_UrlPreviewResolver,props))},urlPreviews_UrlPreview=UrlPreview;UrlPreview.__docgenInfo={description:"",methods:[],displayName:"UrlPreview",props:{type:{required:!0,tsType:{name:"union",raw:"'image' | 'video' | 'audio'",elements:[{name:"literal",value:"'image'"},{name:"literal",value:"'video'"},{name:"literal",value:"'audio'"}]},description:""},originalType:{required:!0,tsType:{name:"string"},description:""},url:{required:!0,tsType:{name:"string"},description:""}}};var buildImageURL=function buildImageURL(url,imageUrl){if(function isValidLink(link){try{return Boolean(new URL(link))}catch(error){return!1}}(imageUrl))return JSON.stringify(imageUrl);var origin=new URL(url).origin,normalizedUrl="".concat(origin,"/").concat(imageUrl).replace(/([^:]\/)\/+/gm,"$1");return JSON.stringify(normalizedUrl)};function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function UrlPreviews_slicedToArray(r,e){return function UrlPreviews_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function UrlPreviews_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function UrlPreviews_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return UrlPreviews_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?UrlPreviews_arrayLikeToArray(r,a):void 0}}(r,e)||function UrlPreviews_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function UrlPreviews_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var hasContentType=function hasContentType(headers){return!!headers&&"contentType"in headers},processMetaAndHeaders=function processMetaAndHeaders(url){var _url$headers;if(!url.headers&&!url.meta)return!1;var data=function hasMeta(url){return!!url.meta&&!!Object.values(url.meta)}(url)?function normalizeMeta(_ref){var url=_ref.url,meta=_ref.meta,image=meta.ogImage||meta.twitterImage||meta.msapplicationTileImage||meta.oembedThumbnailUrl||meta.oembedThumbnailUrl,imageHeight=meta.ogImageHeight||meta.oembedHeight||meta.oembedThumbnailHeight,imageWidth=meta.ogImageWidth||meta.oembedWidth||meta.oembedThumbnailWidth;return Object.fromEntries(Object.entries(_objectSpread(_objectSpread({siteName:meta.ogSiteName||meta.oembedProviderName,siteUrl:meta.ogUrl||meta.oembedProviderUrl,title:meta.ogTitle||meta.twitterTitle||meta.title||meta.pageTitle||meta.oembedTitle,description:meta.ogDescription||meta.twitterDescription||meta.description,authorName:meta.oembedAuthorName,authorUrl:meta.oembedAuthorUrl},image&&{image:{url:buildImageURL(url,image),dimensions:_objectSpread(_objectSpread({},imageHeight&&{height:imageHeight}),imageWidth&&{width:imageWidth})}}),{},{url:meta.oembedUrl||url,type:meta.ogType||meta.oembedType},meta.oembedHtml&&{html:meta.oembedHtml})).filter((function(_ref2){return UrlPreviews_slicedToArray(_ref2,2)[1]})))}(url):void 0;if(data&&function isValidPreviewMeta(_ref4){var siteName=_ref4.siteName,siteUrl=_ref4.siteUrl,authorName=_ref4.authorName,authorUrl=_ref4.authorUrl,title=_ref4.title,description=_ref4.description,image=_ref4.image,html=_ref4.html;return!!(siteName&&siteUrl||authorName&&authorUrl||title||description||image||html)}(data))return{type:"oembed",data:data};var type=function getHeaderType(headers){if(hasContentType(headers))return headers.contentType.match(/image\/.*/)?"image":headers.contentType.match(/audio\/.*/)?"audio":headers.contentType.match(/video\/.*/)?"video":void 0}(url.headers);return!!type&&{type:"headers",data:{url:url.url,type:type,originalType:hasContentType(url.headers)?null===(_url$headers=url.headers)||void 0===_url$headers?void 0:_url$headers.contentType:""}}},isPreviewData=function isPreviewData(data){return!!data},UrlPreviews=function UrlPreviews(_ref5){var urls=_ref5.urls,oembedMaxWidth=(0,useOembedLayout.y)().maxWidth,metaAndHeaders=urls.map(processMetaAndHeaders).filter(isPreviewData);return react.createElement(react.Fragment,null,metaAndHeaders.map((function(_ref6,index){var type=_ref6.type,data=_ref6.data;return function isMetaPreview(_data,type){return"oembed"===type}(0,type)?react.createElement(fuselage.MessageBlock,{width:"100%",maxWidth:oembedMaxWidth,key:index},react.createElement(urlPreviews_OEmbedResolver,{meta:data})):react.createElement(fuselage.MessageBlock,{width:"100%",maxWidth:oembedMaxWidth,key:index},react.createElement(urlPreviews_UrlPreview,data))})))},content_UrlPreviews=UrlPreviews;UrlPreviews.__docgenInfo={description:"",methods:[],displayName:"UrlPreviews",props:{urls:{required:!0,tsType:{name:"Array",elements:[{name:"Required['urls'][0]",raw:"Required<IMessage>['urls'][0]"}],raw:"OembedUrlLegacy[]"},description:""}}}},"./client/components/message/content/actions/MessageAction.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@rocket.chat/fuselage/index.js"),_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/index.js"),MessageAction=function MessageAction(_ref){var icon=_ref.icon,methodId=_ref.methodId,i18nLabel=_ref.i18nLabel,label=_ref.label,runAction=_ref.runAction,danger=_ref.danger,t=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__.useTranslation)(),resolvedIcon=function resolveLegacyIcon(legacyIcon){return"icon-videocam"===legacyIcon?"video":null==legacyIcon?void 0:legacyIcon.replace(/^icon-/,"")}(icon);return react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.Button,{icon:resolvedIcon,"data-method-id":methodId,onClick:runAction(methodId),marginInline:4,small:!0,danger:danger},i18nLabel?t(i18nLabel):label)};__webpack_exports__.A=MessageAction,MessageAction.__docgenInfo={description:"",methods:[],displayName:"MessageAction",props:{icon:{required:!0,tsType:{name:"IconName"},description:""},i18nLabel:{required:!1,tsType:{name:"TranslationKey"},description:""},label:{required:!1,tsType:{name:"string"},description:""},methodId:{required:!0,tsType:{name:"string"},description:""},runAction:{required:!0,tsType:{name:"signature",type:"function",raw:"(actionId: string) => () => void",signature:{arguments:[{type:{name:"string"},name:"actionId"}],return:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}}}},description:""},danger:{required:!1,tsType:{name:"boolean"},description:""}}}},"./client/components/message/content/location/MapView.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{A:function(){return location_MapView}});var dist=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react=__webpack_require__("./node_modules/react/index.js"),fuselage=__webpack_require__("./node_modules/@rocket.chat/fuselage/index.js"),ui_client_dist=__webpack_require__("../../packages/ui-client/dist/index.js"),MapViewFallback=function MapViewFallback(_ref){var linkUrl=_ref.linkUrl,t=(0,dist.useTranslation)();return react.createElement(fuselage.Box,{is:"span",fontScale:"p2",display:"inline-flex",alignItems:"center",paddingBlock:4},react.createElement(fuselage.Icon,{name:"map-pin",size:"x20",color:"hint"}),react.createElement(ui_client_dist.Gr,{to:linkUrl},t("Shared_Location")))},location_MapViewFallback=MapViewFallback;MapViewFallback.__docgenInfo={description:"",methods:[],displayName:"MapViewFallback",props:{linkUrl:{required:!0,tsType:{name:"string"},description:""}}};var MapViewImage=function MapViewImage(_ref){var linkUrl=_ref.linkUrl,imageUrl=_ref.imageUrl,t=(0,dist.useTranslation)();return react.createElement(ui_client_dist.Gr,{to:linkUrl},react.createElement("img",{src:imageUrl,alt:t("Shared_Location")}))},location_MapViewImage=MapViewImage;MapViewImage.__docgenInfo={description:"",methods:[],displayName:"MapViewImage",props:{linkUrl:{required:!0,tsType:{name:"string"},description:""},imageUrl:{required:!0,tsType:{name:"string"},description:""}}};var useAsyncState=__webpack_require__("./client/hooks/useAsyncState.ts"),MapView=function MapView(_ref){var latitude=_ref.latitude,longitude=_ref.longitude,googleMapsApiKey=(0,dist.useSetting)("MapView_GMapsAPIKey"),linkUrl="https://maps.google.com/maps?daddr=".concat(latitude,",").concat(longitude),imageUrl=function useAsyncImage(src){var _useAsyncState=(0,useAsyncState.vl)(),value=_useAsyncState.value,resolve=_useAsyncState.resolve,reject=_useAsyncState.reject,reset=_useAsyncState.reset;return(0,react.useEffect)((function(){if(reset(),src){var image=new Image;image.addEventListener("load",(function(){resolve(image.src)})),image.addEventListener("error",(function(e){reject(e.error)})),image.src=src}}),[src,resolve,reject,reset]),value}(googleMapsApiKey?"https://maps.googleapis.com/maps/api/staticmap?zoom=14&size=250x250&markers=color:gray%7Clabel:%7C".concat(latitude,",").concat(longitude,"&key=").concat(googleMapsApiKey):void 0);return linkUrl?imageUrl?react.createElement(location_MapViewImage,{linkUrl:linkUrl,imageUrl:imageUrl}):react.createElement(location_MapViewFallback,{linkUrl:linkUrl}):null},location_MapView=(0,react.memo)(MapView);MapView.__docgenInfo={description:"",methods:[],displayName:"MapView",props:{latitude:{required:!0,tsType:{name:"number"},description:""},longitude:{required:!0,tsType:{name:"number"},description:""}}}},"./client/components/message/header/MessageRoles.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@rocket.chat/fuselage/index.js"),_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/index.js"),MessageRoles=function MessageRoles(_ref){var roles=_ref.roles,isBot=_ref.isBot,t=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__.useTranslation)();return react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.MessageRoles,null,roles.map((function(role,index){return react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.MessageRole,{key:index},role)})),isBot&&react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.MessageRole,null,t("Bot")))};__webpack_exports__.A=MessageRoles,MessageRoles.__docgenInfo={description:"",methods:[],displayName:"MessageRoles",props:{roles:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"Array<string>"},description:""},isBot:{required:!1,tsType:{name:"boolean"},description:""}}}},"./client/components/message/helpers/followSyle.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Y:function(){return anchor},d:function(){return followStyle}});var _templateObject,_rocket_chat_css_in_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@rocket.chat/css-in-js/dist/index.module.js");var anchor="rcx-contextual-message__follow",followStyle=(0,_rocket_chat_css_in_js__WEBPACK_IMPORTED_MODULE_0__.css)(_templateObject||(_templateObject=function _taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n\t& ."," {\n\t\topacity: 0;\n\t}\n\t.",":focus, &:hover .",", &:focus ."," {\n\t\topacity: 1;\n\t}\n"])),anchor,anchor,anchor,anchor)},"./client/components/message/hooks/useNormalizedMessage.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Q:function(){return useNormalizedMessage}});var _rocket_chat_base64__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/base64/dist/base64.js"),_rocket_chat_core_typings__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/core-typings/dist/index.js"),_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/index.js"),_lib_parseMessageTextToAstMarkdown__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./client/lib/parseMessageTextToAstMarkdown.ts"),_views_room_MessageList_hooks_useAutoLinkDomains__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./client/views/room/MessageList/hooks/useAutoLinkDomains.ts"),_views_room_MessageList_hooks_useAutoTranslate__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./client/views/room/MessageList/hooks/useAutoTranslate.ts"),_views_room_MessageList_hooks_useKatex__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./client/views/room/MessageList/hooks/useKatex.ts"),_useSubscriptionFromMessageQuery__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./client/components/message/hooks/useSubscriptionFromMessageQuery.ts");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toConsumableArray(r){return function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}(r)||function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var normalizeAttachments=function normalizeAttachments(attachments,name,type){return name&&(name=String.fromCharCode.apply(String,_toConsumableArray((new TextEncoder).encode(name)))),attachments.map((function(attachment){if((0,_rocket_chat_core_typings__WEBPACK_IMPORTED_MODULE_1__.isQuoteAttachment)(attachment)&&attachment.attachments)return attachment.attachments=normalizeAttachments(attachment.attachments),attachment;if(!attachment.encryption)return attachment;var key=_rocket_chat_base64__WEBPACK_IMPORTED_MODULE_0__.o.encode(JSON.stringify(_objectSpread(_objectSpread({},attachment.encryption),{},{name:name,type:type})));return(0,_rocket_chat_core_typings__WEBPACK_IMPORTED_MODULE_1__.isFileAttachment)(attachment)&&(attachment.title_link&&!attachment.title_link.startsWith("/file-decrypt/")&&(attachment.title_link="/file-decrypt".concat(attachment.title_link,"?key=").concat(key)),(0,_rocket_chat_core_typings__WEBPACK_IMPORTED_MODULE_1__.isFileImageAttachment)(attachment)&&!attachment.image_url.startsWith("/file-decrypt/")&&(attachment.image_url="/file-decrypt".concat(attachment.image_url,"?key=").concat(key)),(0,_rocket_chat_core_typings__WEBPACK_IMPORTED_MODULE_1__.isFileAudioAttachment)(attachment)&&!attachment.audio_url.startsWith("/file-decrypt/")&&(attachment.audio_url="/file-decrypt".concat(attachment.audio_url,"?key=").concat(key)),(0,_rocket_chat_core_typings__WEBPACK_IMPORTED_MODULE_1__.isFileVideoAttachment)(attachment)&&!attachment.video_url.startsWith("/file-decrypt/")&&(attachment.video_url="/file-decrypt".concat(attachment.video_url,"?key=").concat(key))),attachment}))},useNormalizedMessage=function useNormalizedMessage(message){var _useSubscriptionFromM,_useKatex=(0,_views_room_MessageList_hooks_useKatex__WEBPACK_IMPORTED_MODULE_7__.n)(),katexEnabled=_useKatex.katexEnabled,katexDollarSyntaxEnabled=_useKatex.katexDollarSyntaxEnabled,katexParenthesisSyntaxEnabled=_useKatex.katexParenthesisSyntaxEnabled,customDomains=(0,_views_room_MessageList_hooks_useAutoLinkDomains__WEBPACK_IMPORTED_MODULE_5__.I)(),subscription=null!==(_useSubscriptionFromM=(0,_useSubscriptionFromMessageQuery__WEBPACK_IMPORTED_MODULE_8__.g)(message).data)&&void 0!==_useSubscriptionFromM?_useSubscriptionFromM:void 0,autoTranslateOptions=(0,_views_room_MessageList_hooks_useAutoTranslate__WEBPACK_IMPORTED_MODULE_6__.F)(subscription),showColors=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_2__.useSetting)("HexColorPreview_Enabled");return(0,react__WEBPACK_IMPORTED_MODULE_3__.useMemo)((function(){var _normalizedMessage$fi,_normalizedMessage$fi2,parseOptions=_objectSpread({colors:showColors,emoticons:!0,customDomains:customDomains},katexEnabled&&{katex:{dollarSyntax:katexDollarSyntaxEnabled,parenthesisSyntax:katexParenthesisSyntaxEnabled}}),normalizedMessage=(0,_lib_parseMessageTextToAstMarkdown__WEBPACK_IMPORTED_MODULE_4__.Sr)(message,parseOptions,autoTranslateOptions);normalizedMessage.attachments&&(normalizedMessage.attachments=normalizeAttachments(normalizedMessage.attachments,null===(_normalizedMessage$fi=normalizedMessage.file)||void 0===_normalizedMessage$fi?void 0:_normalizedMessage$fi.name,null===(_normalizedMessage$fi2=normalizedMessage.file)||void 0===_normalizedMessage$fi2?void 0:_normalizedMessage$fi2.type));return normalizedMessage}),[showColors,customDomains,katexEnabled,katexDollarSyntaxEnabled,katexParenthesisSyntaxEnabled,message,autoTranslateOptions])}},"./client/components/message/hooks/useOembedLayout.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{y:function(){return useOembedLayout}});var _rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),useOembedLayout=function useOembedLayout(){return{enabled:(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__.useSetting)("API_Embed",!1),maxWidth:(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__.useLayout)().isMobile?"100%":368,maxHeight:368}}},"./client/components/message/hooks/useSubscriptionFromMessageQuery.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{g:function(){return useSubscriptionFromMessageQuery}});var _tanstack_react_query__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/@tanstack/react-query/build/lib/index.js"),_views_room_contexts_ChatContext__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./client/views/room/contexts/ChatContext.ts");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)}))}}var useSubscriptionFromMessageQuery=function useSubscriptionFromMessageQuery(message){var chat=(0,_views_room_contexts_ChatContext__WEBPACK_IMPORTED_MODULE_0__.Y)();return(0,_tanstack_react_query__WEBPACK_IMPORTED_MODULE_1__.useQuery)(["messages",message._id,"subscription"],_asyncToGenerator(_regeneratorRuntime().mark((function _callee(){var _chat$data$getSubscri;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",null!==(_chat$data$getSubscri=null==chat?void 0:chat.data.getSubscriptionFromMessage(message))&&void 0!==_chat$data$getSubscri?_chat$data$getSubscri:null);case 1:case"end":return _context.stop()}}),_callee)}))))}},"./client/components/message/notification/AllMentionNotification.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_MessageNotification__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./client/components/message/notification/MessageNotification.tsx"),AllMentionNotification=function All(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_MessageNotification__WEBPACK_IMPORTED_MODULE_1__.A,{label:"mention-all",bg:"badge-background-level-3"})};__webpack_exports__.A=AllMentionNotification,AllMentionNotification.__docgenInfo={description:"",methods:[],displayName:"AllMentionNotification"}},"./client/components/message/notification/MeMentionNotification.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_MessageNotification__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./client/components/message/notification/MessageNotification.tsx"),MeMentionNotification=function MeMentionNotification(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_MessageNotification__WEBPACK_IMPORTED_MODULE_1__.A,{label:"Me",bg:"badge-background-level-4"})};__webpack_exports__.A=MeMentionNotification,MeMentionNotification.__docgenInfo={description:"",methods:[],displayName:"MeMentionNotification"}},"./client/components/message/notification/MessageNotification.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@rocket.chat/fuselage/index.js"),_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/index.js"),MessageNotification=function MessageNotification(_ref){var label=_ref.label,bg=_ref.bg,t=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__.useTranslation)();return react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.Box,{width:"x8","aria-label":t(label),borderRadius:"full",height:"x8",bg:bg})};__webpack_exports__.A=MessageNotification,MessageNotification.__docgenInfo={description:"",methods:[],displayName:"MessageNotification",props:{label:{required:!0,tsType:{name:"TranslationKey"},description:""},bg:{required:!0,tsType:{name:"unknown"},description:""}}}},"./client/components/message/notification/UnreadMessagesNotification.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_MessageNotification__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./client/components/message/notification/MessageNotification.tsx"),UnreadMessagesNotification=function UnreadMessagesNotification(){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_MessageNotification__WEBPACK_IMPORTED_MODULE_1__.A,{label:"Unread",bg:"badge-background-level-2"})};__webpack_exports__.A=UnreadMessagesNotification,UnreadMessagesNotification.__docgenInfo={description:"",methods:[],displayName:"UnreadMessagesNotification"}},"./client/components/message/variants/SystemMessage.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@rocket.chat/fuselage/index.js"),_rocket_chat_ui_avatar__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/ui-avatar/dist/index.js"),_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/index.js"),_app_ui_utils_client__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./app/ui-utils/client/index.ts"),_lib_getUserDisplayName__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./lib/getUserDisplayName.ts"),_hooks_useFormatDateAndTime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./client/hooks/useFormatDateAndTime.ts"),_hooks_useFormatTime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./client/hooks/useFormatTime.ts"),_hooks_useUserData__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./client/hooks/useUserData.ts"),_views_room_MessageList_contexts_SelectedMessagesContext__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./client/views/room/MessageList/contexts/SelectedMessagesContext.tsx"),_views_room_contexts_UserCardContext__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./client/views/room/contexts/UserCardContext.ts"),_content_Attachments__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./client/components/message/content/Attachments.tsx"),_content_MessageActions__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./client/components/message/content/MessageActions.tsx"),_list_MessageListContext__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./client/components/message/list/MessageListContext.tsx");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var _excluded=["message","showUserAvatar"],_excluded2=["method_id","i18nLabel"];function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)o=s[r],t.includes(o)||{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}var SystemMessage=function SystemMessage(_ref){var _message$actionLinks,message=_ref.message,showUserAvatar=_ref.showUserAvatar,props=_objectWithoutProperties(_ref,_excluded),t=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_2__.useTranslation)(),formatTime=(0,_hooks_useFormatTime__WEBPACK_IMPORTED_MODULE_6__.a)(),formatDateAndTime=(0,_hooks_useFormatDateAndTime__WEBPACK_IMPORTED_MODULE_5__.J)(),_useUserCard=(0,_views_room_contexts_UserCardContext__WEBPACK_IMPORTED_MODULE_9__.P)(),triggerProps=_useUserCard.triggerProps,openUserCard=_useUserCard.openUserCard,showRealName=(0,_list_MessageListContext__WEBPACK_IMPORTED_MODULE_12__.ls)(),user=_objectSpread(_objectSpread({},message.u),{},{roles:[]},(0,_hooks_useUserData__WEBPACK_IMPORTED_MODULE_7__.P)(message.u._id)),usernameAndRealNameAreSame=!user.name||user.username===user.name,showUsername=(0,_list_MessageListContext__WEBPACK_IMPORTED_MODULE_12__.OH)()&&showRealName&&!usernameAndRealNameAreSame,messageType=_app_ui_utils_client__WEBPACK_IMPORTED_MODULE_4__.MessageTypes.getType(message),isSelecting=(0,_views_room_MessageList_contexts_SelectedMessagesContext__WEBPACK_IMPORTED_MODULE_8__.IV)(),toggleSelected=(0,_views_room_MessageList_contexts_SelectedMessagesContext__WEBPACK_IMPORTED_MODULE_8__.GS)(message._id),isSelected=(0,_views_room_MessageList_contexts_SelectedMessagesContext__WEBPACK_IMPORTED_MODULE_8__.qA)(message._id);return(0,_views_room_MessageList_contexts_SelectedMessagesContext__WEBPACK_IMPORTED_MODULE_8__.MS)(),react__WEBPACK_IMPORTED_MODULE_3__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.MessageSystem,_extends({role:"listitem","aria-roledescription":t("system_message"),tabIndex:0,onClick:isSelecting?toggleSelected:void 0,isSelected:isSelected,"data-qa-selected":isSelected,"data-qa":"system-message","data-system-message-type":message.t},props),react__WEBPACK_IMPORTED_MODULE_3__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.MessageSystemLeftContainer,null,!isSelecting&&showUserAvatar&&react__WEBPACK_IMPORTED_MODULE_3__.createElement(_rocket_chat_ui_avatar__WEBPACK_IMPORTED_MODULE_1__.H8,{username:message.u.username,size:"x18"}),isSelecting&&react__WEBPACK_IMPORTED_MODULE_3__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.CheckBox,{checked:isSelected,onChange:toggleSelected})),react__WEBPACK_IMPORTED_MODULE_3__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.MessageSystemContainer,null,react__WEBPACK_IMPORTED_MODULE_3__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.MessageSystemBlock,null,react__WEBPACK_IMPORTED_MODULE_3__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.MessageNameContainer,_extends({tabIndex:0,role:"button",onClick:function onClick(e){return user.username&&openUserCard(e,user.username)},onKeyDown:function onKeyDown(e){("Enter"===e.code||"Space"===e.code)&&openUserCard(e,message.u.username)},style:{cursor:"pointer"}},triggerProps),react__WEBPACK_IMPORTED_MODULE_3__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.MessageSystemName,null,(0,_lib_getUserDisplayName__WEBPACK_IMPORTED_MODULE_13__.N)(user.name,user.username,showRealName)),showUsername&&react__WEBPACK_IMPORTED_MODULE_3__.createElement(react__WEBPACK_IMPORTED_MODULE_3__.Fragment,null," ",react__WEBPACK_IMPORTED_MODULE_3__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.MessageUsername,{"data-username":user.username},"@",user.username))),messageType&&react__WEBPACK_IMPORTED_MODULE_3__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.MessageSystemBody,{"data-qa-type":"system-message-body"},t(messageType.message,messageType.data?messageType.data(message):{})),react__WEBPACK_IMPORTED_MODULE_3__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.MessageSystemTimestamp,{title:formatDateAndTime(message.ts)},formatTime(message.ts))),message.attachments&&react__WEBPACK_IMPORTED_MODULE_3__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.MessageSystemBlock,null,react__WEBPACK_IMPORTED_MODULE_3__.createElement(_content_Attachments__WEBPACK_IMPORTED_MODULE_10__.A,{attachments:message.attachments})),(null===(_message$actionLinks=message.actionLinks)||void 0===_message$actionLinks?void 0:_message$actionLinks.length)&&react__WEBPACK_IMPORTED_MODULE_3__.createElement(_content_MessageActions__WEBPACK_IMPORTED_MODULE_11__.A,{message:message,actions:message.actionLinks.map((function(_ref2){return _objectSpread({methodId:_ref2.method_id,i18nLabel:_ref2.i18nLabel},_objectWithoutProperties(_ref2,_excluded2))}))})))};__webpack_exports__.A=(0,react__WEBPACK_IMPORTED_MODULE_3__.memo)(SystemMessage),SystemMessage.__docgenInfo={description:"",methods:[],displayName:"SystemMessage",props:{message:{required:!0,tsType:{name:"IMessage"},description:""},showUserAvatar:{required:!0,tsType:{name:"boolean"},description:""}}}},"./client/hooks/useAsyncState.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z7:function(){return _lib_asyncState__WEBPACK_IMPORTED_MODULE_2__.Z7},vl:function(){return useAsyncState}});var _rocket_chat_fuselage_hooks__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@rocket.chat/fuselage-hooks/dist/index.module.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_lib_asyncState__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./client/lib/asyncState/index.ts");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var useAsyncState=function useAsyncState(initialValue){var _useSafely2=_slicedToArray((0,_rocket_chat_fuselage_hooks__WEBPACK_IMPORTED_MODULE_0__.useSafely)((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)((function(){return void 0===initialValue?_lib_asyncState__WEBPACK_IMPORTED_MODULE_2__.es.loading():_lib_asyncState__WEBPACK_IMPORTED_MODULE_2__.es.resolved("function"==typeof initialValue?initialValue():initialValue)}))),2),state=_useSafely2[0],setState=_useSafely2[1],resolve=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(value){setState((function(state){return"function"==typeof value?_lib_asyncState__WEBPACK_IMPORTED_MODULE_2__.es.resolve(state,value(state.value)):_lib_asyncState__WEBPACK_IMPORTED_MODULE_2__.es.resolve(state,value)}))}),[setState]),reject=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(error){setState((function(state){return _lib_asyncState__WEBPACK_IMPORTED_MODULE_2__.es.reject(state,error)}))}),[setState]),update=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(){setState((function(state){return _lib_asyncState__WEBPACK_IMPORTED_MODULE_2__.es.update(state)}))}),[setState]),reset=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(){setState((function(state){return _lib_asyncState__WEBPACK_IMPORTED_MODULE_2__.es.reload(state)}))}),[setState]);return(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((function(){return _objectSpread(_objectSpread({},state),{},{resolve:resolve,reject:reject,reset:reset,update:update})}),[state,resolve,reject,reset,update])}},"./client/hooks/useUserData.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{P:function(){return useUserData}});var react=__webpack_require__("./node_modules/react/index.js"),shim=__webpack_require__("./node_modules/use-sync-external-store/shim/index.js"),UserPresenceContext=(0,react.createContext)(void 0),useUserData=function useUserData(uid){var userPresence=(0,react.useContext)(UserPresenceContext),_useMemo=(0,react.useMemo)((function(){var _userPresence$queryUs;return null!==(_userPresence$queryUs=null==userPresence?void 0:userPresence.queryUserData(uid))&&void 0!==_userPresence$queryUs?_userPresence$queryUs:{subscribe:function subscribe(){return function(){}},get:function get(){}}}),[userPresence,uid]),subscribe=_useMemo.subscribe,get=_useMemo.get;return(0,shim.useSyncExternalStore)(subscribe,get)}},"./client/lib/parseMessageTextToAstMarkdown.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Sr:function(){return parseMessageTextToAstMarkdown}});var _rocket_chat_core_typings__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/core-typings/dist/index.js"),_rocket_chat_message_parser__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/message-parser/messageParser.js"),_views_room_MessageList_lib_isParsedMessage__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./client/views/room/MessageList/lib/isParsedMessage.ts"),_excluded=["editedBy","editedAt","emoji","avatar","alias","customFields","groupable","attachments","reactions"];function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var parseMessageTextToAstMarkdown=function parseMessageTextToAstMarkdown(message,parseOptions,autoTranslateOptions){var _msg$md,msg=removePossibleNullMessageValues(message),showAutoTranslate=autoTranslateOptions.showAutoTranslate,autoTranslateLanguage=autoTranslateOptions.autoTranslateLanguage,translations=autoTranslateLanguage&&(0,_rocket_chat_core_typings__WEBPACK_IMPORTED_MODULE_0__.isTranslatedMessage)(msg)&&msg.translations,translated=showAutoTranslate(message),text=translated&&translations&&translations[autoTranslateLanguage]||msg.msg;return _objectSpread(_objectSpread({},msg),{},{md:(0,_rocket_chat_core_typings__WEBPACK_IMPORTED_MODULE_0__.isE2EEMessage)(message)||(0,_rocket_chat_core_typings__WEBPACK_IMPORTED_MODULE_0__.isOTRMessage)(message)||(0,_rocket_chat_core_typings__WEBPACK_IMPORTED_MODULE_0__.isOTRAckMessage)(message)||translated?textToMessageToken(text,parseOptions):null!==(_msg$md=msg.md)&&void 0!==_msg$md?_msg$md:textToMessageToken(text,parseOptions)},msg.attachments&&{attachments:parseMessageAttachments(msg.attachments,parseOptions,{autoTranslateLanguage:autoTranslateLanguage,translated:translated})})},parseMessageAttachment=function parseMessageAttachment(attachment,parseOptions,autoTranslateOptions){var _attachment$translati,_attachment$md,translated=autoTranslateOptions.translated,autoTranslateLanguage=autoTranslateOptions.autoTranslateLanguage;if(!attachment.text&&!attachment.description)return attachment;(0,_rocket_chat_core_typings__WEBPACK_IMPORTED_MODULE_0__.isQuoteAttachment)(attachment)&&attachment.attachments&&(attachment.attachments=parseMessageAttachments(attachment.attachments,parseOptions,autoTranslateOptions));var _attachment$descripti,text=(0,_rocket_chat_core_typings__WEBPACK_IMPORTED_MODULE_0__.isTranslatedAttachment)(attachment)&&autoTranslateLanguage&&(null==attachment||null===(_attachment$translati=attachment.translations)||void 0===_attachment$translati?void 0:_attachment$translati[autoTranslateLanguage])||attachment.text||attachment.description||"";(0,_rocket_chat_core_typings__WEBPACK_IMPORTED_MODULE_0__.isFileAttachment)(attachment)&&attachment.description&&(attachment.descriptionMd=translated?textToMessageToken(text,parseOptions):null!==(_attachment$descripti=attachment.descriptionMd)&&void 0!==_attachment$descripti?_attachment$descripti:textToMessageToken(text,parseOptions));return _objectSpread(_objectSpread({},attachment),{},{md:translated?textToMessageToken(text,parseOptions):null!==(_attachment$md=attachment.md)&&void 0!==_attachment$md?_attachment$md:textToMessageToken(text,parseOptions)})},parseMessageAttachments=function parseMessageAttachments(attachments,parseOptions,autoTranslateOptions){return attachments.map((function(attachment){return parseMessageAttachment(attachment,parseOptions,autoTranslateOptions)}))},isNotNullOrUndefined=function isNotNullOrUndefined(value){return null!=value},removePossibleNullMessageValues=function removePossibleNullMessageValues(_ref){var editedBy=_ref.editedBy,editedAt=_ref.editedAt,emoji=_ref.emoji,avatar=_ref.avatar,alias=_ref.alias,customFields=_ref.customFields,groupable=_ref.groupable,attachments=_ref.attachments,reactions=_ref.reactions;return _objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)o=s[r],t.includes(o)||{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,_excluded)),isNotNullOrUndefined(editedBy)&&{editedBy:editedBy}),isNotNullOrUndefined(editedAt)&&{editedAt:editedAt}),isNotNullOrUndefined(emoji)&&{emoji:emoji}),isNotNullOrUndefined(avatar)&&{avatar:avatar}),isNotNullOrUndefined(alias)&&{alias:alias}),isNotNullOrUndefined(customFields)&&{customFields:customFields}),isNotNullOrUndefined(groupable)&&{groupable:groupable}),isNotNullOrUndefined(attachments)&&{attachments:attachments}),isNotNullOrUndefined(reactions)&&{reactions:reactions})},textToMessageToken=function textToMessageToken(textOrRoot,parseOptions){if(!textOrRoot)return[];if((0,_views_room_MessageList_lib_isParsedMessage__WEBPACK_IMPORTED_MODULE_2__.T)(textOrRoot))return textOrRoot;var parsedMessage=(0,_rocket_chat_message_parser__WEBPACK_IMPORTED_MODULE_1__.parse)(textOrRoot,parseOptions);return"LINE_BREAK"!==parsedMessage[0].type?parsedMessage:parsedMessage.slice(1)}},"./client/providers/AttachmentProvider.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _rocket_chat_fuselage_hooks__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@rocket.chat/fuselage-hooks/dist/index.module.js"),_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/index.js"),_app_utils_client__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./app/utils/client/index.ts"),AttachmentProvider=function AttachmentProvider(_ref){var children=_ref.children,_ref$width=_ref.width,width=void 0===_ref$width?360:_ref$width,_ref$height=_ref.height,height=void 0===_ref$height?360:_ref$height,isMobile=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__.useLayout)().isMobile,reducedData=(0,_rocket_chat_fuselage_hooks__WEBPACK_IMPORTED_MODULE_0__.usePrefersReducedData)(),collapsedByDefault=!!(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__.useUserPreference)("collapseMediaByDefault"),autoLoadEmbedMedias=!!(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__.useUserPreference)("autoImageLoad"),saveMobileBandwidth=!!(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__.useUserPreference)("saveMobileBandwidth"),contextValue=(0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)((function(){return{getURL:function getURL(url){return(0,_app_utils_client__WEBPACK_IMPORTED_MODULE_3__.AP)(url,{full:!0})},collapsedByDefault:collapsedByDefault,autoLoadEmbedMedias:!reducedData&&autoLoadEmbedMedias&&(!saveMobileBandwidth||!isMobile),dimensions:{width:width,height:height}}}),[collapsedByDefault,reducedData,autoLoadEmbedMedias,saveMobileBandwidth,isMobile,width,height]);return react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__.AttachmentContext.Provider,{children:children,value:contextValue})};__webpack_exports__.A=AttachmentProvider,AttachmentProvider.__docgenInfo={description:"",methods:[],displayName:"AttachmentProvider",props:{children:{required:!1,tsType:{name:"ReactNode"},description:""},width:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"360",computed:!1}},height:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"360",computed:!1}}}}},"./client/views/room/MessageList/MessageListErrorBoundary.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@rocket.chat/fuselage/index.js"),_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/index.js"),react_error_boundary__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react-error-boundary/dist/react-error-boundary.umd.js"),_contexts_RoomContext__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./client/views/room/contexts/RoomContext.ts"),MessageListErrorBoundary=function MessageListErrorBoundary(_ref){var children=_ref.children,t=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__.useTranslation)(),room=(0,_contexts_RoomContext__WEBPACK_IMPORTED_MODULE_3__.nq)();return react__WEBPACK_IMPORTED_MODULE_2__.createElement(react_error_boundary__WEBPACK_IMPORTED_MODULE_4__.ErrorBoundary,{children:children,resetKeys:[room._id],fallback:react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.States,null,react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.StatesIcon,{name:"circle-exclamation",variation:"danger"}),react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.StatesTitle,null,t("Error")),react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.StatesSubtitle,null,t("Error_something_went_wrong")),react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.StatesActions,null,react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.StatesAction,{onClick:function onClick(){location.reload()}},react__WEBPACK_IMPORTED_MODULE_2__.createElement(_rocket_chat_fuselage__WEBPACK_IMPORTED_MODULE_0__.Icon,{name:"reload"})," ",t("Reload"))))})};__webpack_exports__.A=MessageListErrorBoundary,MessageListErrorBoundary.__docgenInfo={description:"",methods:[],displayName:"MessageListErrorBoundary",props:{children:{required:!0,tsType:{name:"ReactNode"},description:""}}}},"./client/views/room/MessageList/contexts/MessageHighlightContext.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{B:function(){return useIsMessageHighlight}});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),MessageHighlightContext=(0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)({}),useIsMessageHighlight=function useIsMessageHighlight(_id){return(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(MessageHighlightContext).highlightMessageId===_id};__webpack_exports__.A=MessageHighlightContext},"./client/views/room/MessageList/contexts/SelectedMessagesContext.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{GS:function(){return useToggleSelect},IV:function(){return useIsSelecting},MS:function(){return useCountSelected},OH:function(){return SelectedMessageContext},qA:function(){return useIsSelectedMessage}});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),use_sync_external_store_shim__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/use-sync-external-store/shim/index.js"),_providers_SelectedMessagesProvider__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./client/views/room/providers/SelectedMessagesProvider.tsx"),SelectedMessageContext=(0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)({selectedMessageStore:_providers_SelectedMessagesProvider__WEBPACK_IMPORTED_MODULE_2__.S}),useIsSelectedMessage=function useIsSelectedMessage(mid){var selectedMessageStore=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(SelectedMessageContext).selectedMessageStore,subscribe=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(callback){return selectedMessageStore.on(mid,callback)}),[selectedMessageStore,mid]);return(0,use_sync_external_store_shim__WEBPACK_IMPORTED_MODULE_1__.useSyncExternalStore)(subscribe,(function getSnapshot(){return selectedMessageStore.isSelected(mid)}))},useIsSelecting=function useIsSelecting(){var selectedMessageStore=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(SelectedMessageContext).selectedMessageStore,subscribe=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(callback){return selectedMessageStore.on("toggleIsSelecting",callback)}),[selectedMessageStore]);return(0,use_sync_external_store_shim__WEBPACK_IMPORTED_MODULE_1__.useSyncExternalStore)(subscribe,(function getSnapshot(){return selectedMessageStore.getIsSelecting()}))},useToggleSelect=function useToggleSelect(mid){var selectedMessageStore=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(SelectedMessageContext).selectedMessageStore;return(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){selectedMessageStore.toggle(mid)}),[mid,selectedMessageStore])},useCountSelected=function useCountSelected(){var selectedMessageStore=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(SelectedMessageContext).selectedMessageStore,subscribe=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(callback){return selectedMessageStore.on("change",callback)}),[selectedMessageStore]);return(0,use_sync_external_store_shim__WEBPACK_IMPORTED_MODULE_1__.useSyncExternalStore)(subscribe,(function getSnapshot(){return selectedMessageStore.count()}))}},"./client/views/room/MessageList/hooks/useAutoLinkDomains.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{I:function(){return useAutoLinkDomains}});var _rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),useAutoLinkDomains=function useAutoLinkDomains(){var domains=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__.useSetting)("Message_CustomDomain_AutoLink"),customDomains=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((function(){return domains?domains.split(",").map((function(domain){return domain.trim()})):[]}),[domains]);return(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((function(){return customDomains}),[customDomains])}},"./client/views/room/MessageList/hooks/useAutoTranslate.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{F:function(){return useAutoTranslate}});var dist=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react=__webpack_require__("./node_modules/react/index.js"),meteor=__webpack_require__("./.storybook/mocks/meteor.js"),roomCoordinator=__webpack_require__("./client/lib/rooms/roomCoordinator.tsx"),messageArgs=__webpack_require__("./client/lib/utils/messageArgs.ts"),core_typings_dist=__webpack_require__("../../packages/core-typings/dist/index.js"),autoTranslate_hasTranslationLanguageInMessage=function hasTranslationLanguageInMessage(message,language){var _message$translations;return(0,core_typings_dist.isTranslatedMessage)(message)&&Boolean(null===(_message$translations=message.translations)||void 0===_message$translations?void 0:_message$translations[language])},autoTranslate_hasTranslationLanguageInAttachments=function hasTranslationLanguageInAttachments(){var attachments=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],language=arguments.length>1?arguments[1]:void 0;return(0,core_typings_dist.isTranslatedMessageAttachment)(attachments)&&(null==attachments?void 0:attachments.some((function(attachment){var _attachment$translati;return null==attachment||null===(_attachment$translati=attachment.translations)||void 0===_attachment$translati?void 0:_attachment$translati[language]})))},client=__webpack_require__("./app/authorization/client/index.ts"),models_client=__webpack_require__("./app/models/client/index.ts"),settings_client=__webpack_require__("./app/settings/client/index.ts"),MessageAction=__webpack_require__("./app/ui-utils/client/lib/MessageAction.ts"),SDKClient=__webpack_require__("./app/utils/client/lib/SDKClient.ts"),mem_dist=__webpack_require__("./node_modules/mem/dist/index.js"),mem_dist_default=__webpack_require__.n(mem_dist);function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||_unsupportedIterableToArray(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var userLanguage="en",username="";meteor.fj.startup((function(){meteor.JD.autorun((function(){var user=meteor.fj.user();user&&(userLanguage=user.language||"en",username=user.username||"")}))}));var AutoTranslate={initialized:!1,providersMetadata:{},messageIdsToWait:{},supportedLanguages:[],findSubscriptionByRid:mem_dist_default()((function(rid){return models_client.Subscriptions.findOne({rid:rid})})),getLanguage:function getLanguage(rid){var _subscription,_window$defaultUserLa,_window,subscription;rid&&(subscription=this.findSubscriptionByRid(rid));var language=(null===(_subscription=subscription)||void 0===_subscription?void 0:_subscription.autoTranslateLanguage)||userLanguage||(null===(_window$defaultUserLa=(_window=window).defaultUserLanguage)||void 0===_window$defaultUserLa?void 0:_window$defaultUserLa.call(_window));return-1===language.indexOf("-")||(this.supportedLanguages||[]).some((function(supportedLanguage){return supportedLanguage.language===language}))?language:language.slice(0,2)},translateAttachments:function translateAttachments(attachments,language,autoTranslateShowInverse){if(!(0,core_typings_dist.isTranslatedMessageAttachment)(attachments))return attachments;var _step,_iterator=function _createForOfIteratorHelper(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=_unsupportedIterableToArray(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var _n=0,F=function F(){};return{s:F,n:function n(){return _n>=r.length?{done:!0}:{done:!1,value:r[_n++]}},e:function e(r){throw r},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function s(){t=t.call(r)},n:function n(){var r=t.next();return a=r.done,r},e:function e(r){u=!0,o=r},f:function f(){try{a||null==t.return||t.return()}finally{if(u)throw o}}}}(attachments);try{for(_iterator.s();!(_step=_iterator.n()).done;){var attachment=_step.value;attachment.author_name!==username&&(attachment.text&&attachment.translations&&attachment.translations[language]&&(attachment.translations.original=attachment.text,attachment.text=autoTranslateShowInverse?attachment.translations.original:attachment.translations[language]),attachment.description&&attachment.translations&&attachment.translations[language]&&(attachment.translations.original=attachment.description,attachment.description=autoTranslateShowInverse?attachment.translations.original:attachment.translations[language]),attachment.attachments&&attachment.attachments.length>0&&(attachment.attachments=this.translateAttachments(attachment.attachments,language)))}}catch(err){_iterator.e(err)}finally{_iterator.f()}return attachments},init:function init(){var _this=this;this.initialized||(meteor.JD.autorun(function(){var _ref=function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)}))}}(_regeneratorRuntime().mark((function _callee(c){var uid,_yield$Promise$all,_yield$Promise$all2;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(uid=meteor.fj.userId(),settings_client.W.get("AutoTranslate_Enabled")&&uid&&(0,client._m)("auto-translate")){_context.next=3;break}return _context.abrupt("return");case 3:return c.stop(),_context.prev=4,_context.next=7,Promise.all([SDKClient.sdk.call("autoTranslate.getProviderUiMetadata"),SDKClient.sdk.call("autoTranslate.getSupportedLanguages","en")]);case 7:_yield$Promise$all=_context.sent,_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2),_this.providersMetadata=_yield$Promise$all2[0],_this.supportedLanguages=_yield$Promise$all2[1],_context.next=16;break;case 13:_context.prev=13,_context.t0=_context.catch(4),console.error(_context.t0.message);case 16:case"end":return _context.stop()}}),_callee,null,[[4,13]])})));return function(_x){return _ref.apply(this,arguments)}}()),models_client.Subscriptions.find().observeChanges({changed:function changed(_id,fields){(fields.hasOwnProperty("autoTranslate")||fields.hasOwnProperty("autoTranslateLanguage"))&&mem_dist_default().clear(_this.findSubscriptionByRid)}}),this.initialized=!0)}};function actionButton_typeof(o){return actionButton_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},actionButton_typeof(o)}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=actionButton_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=actionButton_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==actionButton_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}meteor.fj.startup((function(){AutoTranslate.init(),meteor.JD.autorun((function(){settings_client.W.get("AutoTranslate_Enabled")&&(0,client.WX)(["auto-translate"])?(MessageAction.q.addButton({id:"translate",icon:"language",label:"Translate",context:["message","message-mobile","threads"],type:"interaction",action:function action(_,props){var _props$message=props.message,message=void 0===_props$message?(0,messageArgs.R)(this).msg:_props$message,language=AutoTranslate.getLanguage(message.rid);autoTranslate_hasTranslationLanguageInMessage(message,language)||autoTranslate_hasTranslationLanguageInAttachments(message.attachments,language)||(AutoTranslate.messageIdsToWait[message._id]=!0,models_client.Messages.update({_id:message._id},{$set:{autoTranslateFetching:!0}}),SDKClient.sdk.call("autoTranslate.translateMessage",message,language));var action="autoTranslateShowInverse"in message?"$unset":"$set";models_client.Messages.update({_id:message._id},_defineProperty({},action,{autoTranslateShowInverse:!0}))},condition:function condition(_ref){var message=_ref.message,subscription=_ref.subscription,user=_ref.user,room=_ref.room;if(!user)return!1;var language=(null==subscription?void 0:subscription.autoTranslateLanguage)||AutoTranslate.getLanguage(message.rid)||"",isLivechatRoom=roomCoordinator.roomCoordinator.isLivechatRoom(null==room?void 0:room.t),isDifferentUser=(null==message?void 0:message.u)&&message.u._id!==user._id,autoTranslateEnabled=(null==subscription?void 0:subscription.autoTranslate)||isLivechatRoom,hasLanguage=autoTranslate_hasTranslationLanguageInMessage(message,language)||autoTranslate_hasTranslationLanguageInAttachments(message.attachments,language);return Boolean(message.autoTranslateShowInverse||isDifferentUser&&autoTranslateEnabled&&!hasLanguage)},order:90}),MessageAction.q.addButton({id:"view-original",icon:"language",label:"View_original",context:["message","message-mobile","threads"],type:"interaction",action:function action(_,props){var _props$message2=props.message,message=void 0===_props$message2?(0,messageArgs.R)(this).msg:_props$message2,language=AutoTranslate.getLanguage(message.rid);autoTranslate_hasTranslationLanguageInMessage(message,language)||autoTranslate_hasTranslationLanguageInAttachments(message.attachments,language)||(AutoTranslate.messageIdsToWait[message._id]=!0,models_client.Messages.update({_id:message._id},{$set:{autoTranslateFetching:!0}}),SDKClient.sdk.call("autoTranslate.translateMessage",message,language));var action="autoTranslateShowInverse"in message?"$unset":"$set";models_client.Messages.update({_id:message._id},_defineProperty({},action,{autoTranslateShowInverse:!0}))},condition:function condition(_ref2){var message=_ref2.message,subscription=_ref2.subscription,user=_ref2.user,room=_ref2.room,language=(null==subscription?void 0:subscription.autoTranslateLanguage)||AutoTranslate.getLanguage(message.rid)||"",isLivechatRoom=roomCoordinator.roomCoordinator.isLivechatRoom(null==room?void 0:room.t);if(!user)return!1;var isDifferentUser=(null==message?void 0:message.u)&&message.u._id!==user._id,autoTranslateEnabled=(null==subscription?void 0:subscription.autoTranslate)||isLivechatRoom,hasLanguage=autoTranslate_hasTranslationLanguageInMessage(message,language)||autoTranslate_hasTranslationLanguageInAttachments(message.attachments,language);return Boolean(!message.autoTranslateShowInverse&&isDifferentUser&&autoTranslateEnabled&&hasLanguage)},order:90})):MessageAction.q.removeButton("toggle-language")}))}));var useAutoTranslate=function useAutoTranslate(subscription){var isSubscriptionEnabled=Boolean((0,dist.useSetting)("AutoTranslate_Enabled"))&&(null==subscription?void 0:subscription.autoTranslateLanguage)&&(null==subscription?void 0:subscription.autoTranslate),isLivechatRoom=(0,react.useMemo)((function(){return subscription&&roomCoordinator.roomCoordinator.isLivechatRoom(null==subscription?void 0:subscription.t)}),[subscription]),autoTranslateEnabled=Boolean(isSubscriptionEnabled||isLivechatRoom),autoTranslateLanguage=autoTranslateEnabled&&subscription?AutoTranslate.getLanguage(subscription.rid):void 0,showAutoTranslate=(0,react.useCallback)((function(message){return!(!autoTranslateEnabled||!autoTranslateLanguage)&&(!function isOwnUserMessage(message,subscription){return message.u._id===(null==subscription?void 0:subscription.u._id)}(message,subscription)&&!message.autoTranslateShowInverse&&(autoTranslate_hasTranslationLanguageInMessage(message,autoTranslateLanguage)||autoTranslate_hasTranslationLanguageInAttachments(message.attachments,autoTranslateLanguage)))}),[subscription,autoTranslateEnabled,autoTranslateLanguage]);return(0,react.useMemo)((function(){return{autoTranslateEnabled:autoTranslateEnabled,autoTranslateLanguage:autoTranslateLanguage,showAutoTranslate:showAutoTranslate}}),[autoTranslateEnabled,autoTranslateLanguage,showAutoTranslate])}},"./client/views/room/MessageList/hooks/useJumpToMessage.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{_:function(){return useJumpToMessage}});var _rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_components_message_list_MessageListContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./client/components/message/list/MessageListContext.tsx"),_providers_messageHighlightSubscription__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./client/views/room/MessageList/providers/messageHighlightSubscription.ts"),_excluded=["msg"];var useJumpToMessage=function useJumpToMessage(messageId){var jumpToMessageParam=(0,_components_message_list_MessageListContext__WEBPACK_IMPORTED_MODULE_2__.A8)(),listRef=(0,_components_message_list_MessageListContext__WEBPACK_IMPORTED_MODULE_2__.Uv)(),router=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__.useRouter)(),ref=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(node){node&&scroll&&setTimeout((function(){if(null!=listRef&&listRef.current){var wrapper=listRef.current,containerRect=wrapper.getBoundingClientRect(),offset=node.getBoundingClientRect().top-containerRect.top,newScrollPosition=wrapper.scrollTop+offset-60;wrapper.scrollTo({top:newScrollPosition,behavior:"smooth"})}var _router$getSearchPara=router.getSearchParameters(),search=(_router$getSearchPara.msg,function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)o=s[r],t.includes(o)||{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_router$getSearchPara,_excluded));router.navigate({pathname:router.getLocationPathname(),search:search},{replace:!0}),(0,_providers_messageHighlightSubscription__WEBPACK_IMPORTED_MODULE_3__.wh)(messageId),setTimeout(_providers_messageHighlightSubscription__WEBPACK_IMPORTED_MODULE_3__.t2,2e3)}),500)}),[listRef,messageId,router]);if(jumpToMessageParam===messageId)return ref}},"./client/views/room/MessageList/hooks/useKatex.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{n:function(){return useKatex}});var _rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),useKatex=function useKatex(){var katexEnabled=Boolean((0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__.useSetting)("Katex_Enabled"));return{katexEnabled:katexEnabled,katexDollarSyntaxEnabled:Boolean((0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__.useSetting)("Katex_Dollar_Syntax"))&&katexEnabled,katexParenthesisSyntaxEnabled:Boolean((0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__.useSetting)("Katex_Parenthesis_Syntax"))&&katexEnabled}}},"./client/views/room/MessageList/lib/isParsedMessage.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{T:function(){return isParsedMessage}});var isParsedMessage=function isParsedMessage(text){return Array.isArray(text)&&text.length>0}},"./client/views/room/MessageList/providers/MessageListProvider.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{A:function(){return providers_MessageListProvider}});var dist=__webpack_require__("../../packages/core-typings/dist/index.js"),ui_contexts_dist=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react=__webpack_require__("./node_modules/react/index.js"),esm=__webpack_require__("./node_modules/@rocket.chat/string-helpers/dist/esm/index.js"),getRegexHighlight=function getRegexHighlight(highlight){return new RegExp("(^|\\b|[\\s\\n\\r\\t.,'\\\"\\+!?:-])(".concat((0,esm.Nt)(highlight),")($|\\b|[\\s\\n\\r\\t.,'\\\"\\+!?:-])(?![^<]*>|[^<>]*<\\/)"),"gmi")},getRegexHighlightUrl=function getRegexHighlightUrl(highlight){return new RegExp("https?://(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)(".concat((0,esm.Nt)(highlight),")\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)"),"gmi")},MessageListContext=__webpack_require__("./client/components/message/list/MessageListContext.tsx"),AttachmentProvider=__webpack_require__("./client/providers/AttachmentProvider.tsx"),ChatContext=__webpack_require__("./client/views/room/contexts/ChatContext.ts"),RoomContext=__webpack_require__("./client/views/room/contexts/RoomContext.ts"),useAutoTranslate=__webpack_require__("./client/views/room/MessageList/hooks/useAutoTranslate.ts"),useKatex=__webpack_require__("./client/views/room/MessageList/hooks/useKatex.ts"),lib=__webpack_require__("../../node_modules/@tanstack/react-query/build/lib/index.js"),client=__webpack_require__("./app/models/client/index.ts"),ui_utils_client=__webpack_require__("./app/ui-utils/client/index.ts"),RouterProvider=__webpack_require__("./client/providers/RouterProvider.tsx"),RoomManager=__webpack_require__("./client/lib/RoomManager.ts"),goToRoomById=__webpack_require__("./client/lib/utils/goToRoomById.ts");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}var legacyJumpToMessage=function(){var _ref=function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)}))}}(_regeneratorRuntime().mark((function _callee(message){var _ChatRoom$findOne$nam,_ChatRoom$findOne,_router$getRouteParam,tab,context;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!(0,dist.isThreadMessage)(message)&&!message.tcount){_context.next=6;break}if(_router$getRouteParam=RouterProvider.Q.getRouteParameters(),tab=_router$getRouteParam.tab,context=_router$getRouteParam.context,"thread"!==tab||context!==message.tmid&&context!==message._id){_context.next=4;break}return _context.abrupt("return");case 4:return RouterProvider.Q.navigate({name:RouterProvider.Q.getRouteName(),params:{tab:"thread",context:message.tmid||message._id,rid:message.rid,name:null!==(_ChatRoom$findOne$nam=null===(_ChatRoom$findOne=client.ChatRoom.findOne({_id:message.rid}))||void 0===_ChatRoom$findOne?void 0:_ChatRoom$findOne.name)&&void 0!==_ChatRoom$findOne$nam?_ChatRoom$findOne$nam:""},search:_objectSpread(_objectSpread({},RouterProvider.Q.getSearchParameters()),{},{msg:message._id})},{replace:!1}),_context.abrupt("return");case 6:if(RoomManager.RoomManager.opened!==message.rid){_context.next=9;break}return ui_utils_client.RoomHistoryManager.getSurroundingMessages(message),_context.abrupt("return");case 9:return _context.next=11,(0,goToRoomById.P)(message.rid);case 11:setTimeout((function(){ui_utils_client.RoomHistoryManager.getSurroundingMessages(message)}),400);case 12:case"end":return _context.stop()}}),_callee)})));return function legacyJumpToMessage(_x){return _ref.apply(this,arguments)}}();function useLoadSurroundingMessages_typeof(o){return useLoadSurroundingMessages_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},useLoadSurroundingMessages_typeof(o)}function useLoadSurroundingMessages_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function useLoadSurroundingMessages_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?useLoadSurroundingMessages_ownKeys(Object(t),!0).forEach((function(r){useLoadSurroundingMessages_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):useLoadSurroundingMessages_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function useLoadSurroundingMessages_defineProperty(e,r,t){return(r=function useLoadSurroundingMessages_toPropertyKey(t){var i=function useLoadSurroundingMessages_toPrimitive(t,r){if("object"!=useLoadSurroundingMessages_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=useLoadSurroundingMessages_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==useLoadSurroundingMessages_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function MessageListProvider_typeof(o){return MessageListProvider_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},MessageListProvider_typeof(o)}function MessageListProvider_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function MessageListProvider_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?MessageListProvider_ownKeys(Object(t),!0).forEach((function(r){MessageListProvider_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):MessageListProvider_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function MessageListProvider_defineProperty(e,r,t){return(r=function MessageListProvider_toPropertyKey(t){var i=function MessageListProvider_toPrimitive(t,r){if("object"!=MessageListProvider_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=MessageListProvider_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==MessageListProvider_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var MessageListProvider=function MessageListProvider(_ref){var children=_ref.children,messageListRef=_ref.messageListRef,attachmentDimension=_ref.attachmentDimension;if(!(0,RoomContext.nq)())throw new Error("Room not found");var reactToMessage=(0,ui_contexts_dist.useEndpoint)("POST","/v1/chat.react"),user=(0,ui_contexts_dist.useUser)(),uid=null==user?void 0:user._id,username=null==user?void 0:user.username,subscription=(0,RoomContext.Mq)(),isMobile=(0,ui_contexts_dist.useLayout)().isMobile,showRealName=Boolean((0,ui_contexts_dist.useSetting)("UI_Use_Real_Name")),showColors=(0,ui_contexts_dist.useSetting)("HexColorPreview_Enabled"),displayRolesGlobal=Boolean((0,ui_contexts_dist.useSetting)("UI_DisplayRoles")),hideRolesPreference=Boolean(!(0,ui_contexts_dist.useUserPreference)("hideRoles")&&!isMobile),showRoles=displayRolesGlobal&&hideRolesPreference,showUsername=Boolean(!(0,ui_contexts_dist.useUserPreference)("hideUsernames")&&!isMobile),highlights=(0,ui_contexts_dist.useUserPreference)("highlights"),_useAutoTranslate=(0,useAutoTranslate.F)(subscription),showAutoTranslate=_useAutoTranslate.showAutoTranslate,autoTranslateLanguage=_useAutoTranslate.autoTranslateLanguage,_useKatex=(0,useKatex.n)(),katexEnabled=_useKatex.katexEnabled,katexDollarSyntaxEnabled=_useKatex.katexDollarSyntaxEnabled,katexParenthesisSyntaxEnabled=_useKatex.katexParenthesisSyntaxEnabled,hasSubscription=Boolean(subscription),msgParameter=(0,ui_contexts_dist.useSearchParameter)("msg");!function useLoadSurroundingMessages(msgId){var queryClient=(0,lib.useQueryClient)(),getMessage=(0,ui_contexts_dist.useEndpoint)("GET","/v1/chat.getMessage");(0,react.useEffect)((function(){if(msgId){var abort=new AbortController;return queryClient.fetchQuery({queryKey:["chat.getMessage",msgId],queryFn:function queryFn(){return getMessage({msgId:msgId})}}).then((function(_ref){var message=_ref.message;abort.signal.aborted||legacyJumpToMessage(useLoadSurroundingMessages_objectSpread(useLoadSurroundingMessages_objectSpread({},message),{},{ts:new Date(message.ts)}))})).catch((function(error){console.warn(error)})),function(){abort.abort()}}}),[msgId,queryClient,getMessage])}(msgParameter);var chat=(0,ChatContext.Y)(),context=(0,react.useMemo)((function(){return MessageListProvider_objectSpread(MessageListProvider_objectSpread({showColors:showColors,useUserHasReacted:username?function(message){return function(reaction){var _message$reactions;return Boolean(null===(_message$reactions=message.reactions)||void 0===_message$reactions?void 0:_message$reactions[reaction].usernames.includes(username))}}:function(){return function(){return!1}},useShowFollowing:uid?function(_ref2){var message=_ref2.message;return Boolean(message.replies&&message.replies.indexOf(uid)>-1&&!(0,dist.isThreadMainMessage)(message))}:function(){return!1},autoTranslateLanguage:autoTranslateLanguage,useShowTranslated:showAutoTranslate,useShowStarred:hasSubscription?function(_ref3){var message=_ref3.message;return Boolean(Array.isArray(message.starred)&&message.starred.find((function(star){return star._id===uid})))}:function(){return!1},useMessageDateFormatter:function useMessageDateFormatter(){return function(date){return date.toLocaleString()}},showRoles:showRoles,showRealName:showRealName,showUsername:showUsername,messageListRef:messageListRef,jumpToMessageParam:msgParameter},katexEnabled&&{katex:{dollarSyntaxEnabled:katexDollarSyntaxEnabled,parenthesisSyntaxEnabled:katexParenthesisSyntaxEnabled}}),{},{highlights:null==highlights?void 0:highlights.map((function(str){return str.trim()})).map((function(highlight){return{highlight:highlight,regex:getRegexHighlight(highlight),urlRegex:getRegexHighlightUrl(highlight)}})),useOpenEmojiPicker:uid?function(message){return function(e){e.nativeEvent.stopImmediatePropagation(),null==chat||chat.emojiPicker.open(e.currentTarget,(function(emoji){return reactToMessage({messageId:message._id,reaction:emoji})}))}}:function(){return function(){}},username:username})}),[username,uid,showAutoTranslate,hasSubscription,autoTranslateLanguage,showRoles,showRealName,showUsername,katexEnabled,katexDollarSyntaxEnabled,katexParenthesisSyntaxEnabled,highlights,reactToMessage,showColors,msgParameter,messageListRef,null==chat?void 0:chat.emojiPicker]);return react.createElement(AttachmentProvider.A,{width:null==attachmentDimension?void 0:attachmentDimension.width,height:null==attachmentDimension?void 0:attachmentDimension.height},react.createElement(MessageListContext.N5.Provider,{value:context},children))},providers_MessageListProvider=(0,react.memo)(MessageListProvider);MessageListProvider.__docgenInfo={description:"",methods:[],displayName:"MessageListProvider",props:{children:{required:!0,tsType:{name:"ReactNode"},description:""},messageListRef:{required:!1,tsType:{name:"ReactRefObject",raw:"React.RefObject<HTMLElement>",elements:[{name:"HTMLElement"}]},description:""},attachmentDimension:{required:!1,tsType:{name:"signature",type:"object",raw:"{\n\twidth?: number;\n\theight?: number;\n}",signature:{properties:[{key:"width",value:{name:"number",required:!1}},{key:"height",value:{name:"number",required:!1}}]}},description:""}}}},"./client/views/room/MessageList/providers/messageHighlightSubscription.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{B1:function(){return subscribe},dV:function(){return getSnapshot},t2:function(){return clearHighlightMessage},wh:function(){return setHighlightMessage}});var _createMessageHighlig=function createMessageHighlightSubscription(){var highlightMessageId,updateCb=function updateCb(){};return{subscribe:function subscribe(cb){return updateCb=cb,function(){updateCb=function updateCb(){}}},getSnapshot:function getSnapshot(){return highlightMessageId},setHighlight:function setHighlight(_id){highlightMessageId=_id,updateCb()},clearHighlight:function clearHighlight(){highlightMessageId=void 0,updateCb()}}}(),getSnapshot=_createMessageHighlig.getSnapshot,subscribe=_createMessageHighlig.subscribe,setHighlightMessage=_createMessageHighlig.setHighlight,clearHighlightMessage=_createMessageHighlig.clearHighlight},"./client/views/room/contextualBar/Threads/hooks/useGetMessageByID.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{J:function(){return useGetMessageByID}});var _rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_app_models_client__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./app/models/client/index.ts"),_lib_onClientMessageReceived__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./client/lib/onClientMessageReceived.ts"),_lib_utils_mapMessageFromApi__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./client/lib/utils/mapMessageFromApi.ts");function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}var useGetMessageByID=function useGetMessageByID(){var getMessage=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__.useEndpoint)("GET","/v1/chat.getMessage");return(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(function(){var _ref=function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)}))}}(_regeneratorRuntime().mark((function _callee(mid){var _yield$getMessage,rawMessage,mappedMessage,message;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,getMessage({msgId:mid});case 3:return _yield$getMessage=_context.sent,rawMessage=_yield$getMessage.message,mappedMessage=(0,_lib_utils_mapMessageFromApi__WEBPACK_IMPORTED_MODULE_4__.U)(rawMessage),_context.next=8,(0,_lib_onClientMessageReceived__WEBPACK_IMPORTED_MODULE_3__.H)(mappedMessage);case 8:if(_context.t0=_context.sent,_context.t0){_context.next=11;break}_context.t0=mappedMessage;case 11:return message=_context.t0,_app_models_client__WEBPACK_IMPORTED_MODULE_2__.Messages.upsert({_id:message._id},{$set:message}),_context.abrupt("return",message);case 16:if(_context.prev=16,_context.t1=_context.catch(0),"object"!==_typeof(_context.t1)||null===_context.t1||!("success"in _context.t1)){_context.next=20;break}throw new Error("Message not found");case 20:throw _context.t1;case 21:case"end":return _context.stop()}}),_callee,null,[[0,16]])})));return function(_x){return _ref.apply(this,arguments)}}(),[getMessage])}},"./client/views/room/contextualBar/Threads/hooks/useToggleFollowingThreadMutation.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{M:function(){return useToggleFollowingThreadMutation}});var _rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/ui-contexts/dist/index.js"),_tanstack_react_query__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/@tanstack/react-query/build/lib/index.js");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)}))}}var useToggleFollowingThreadMutation=function useToggleFollowingThreadMutation(options){var _onSuccess,followMessage=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__.useEndpoint)("POST","/v1/chat.followMessage"),unfollowMessage=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_0__.useEndpoint)("POST","/v1/chat.unfollowMessage"),queryClient=(0,_tanstack_react_query__WEBPACK_IMPORTED_MODULE_1__.useQueryClient)();return(0,_tanstack_react_query__WEBPACK_IMPORTED_MODULE_1__.useMutation)(function(){var _ref2=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(_ref){var tmid;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(tmid=_ref.tmid,!_ref.follow){_context.next=5;break}return _context.next=4,followMessage({mid:tmid});case 4:return _context.abrupt("return");case 5:return _context.next=7,unfollowMessage({mid:tmid});case 7:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref2.apply(this,arguments)}}(),_objectSpread(_objectSpread({},options),{},{onSuccess:(_onSuccess=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(data,variables,context){var _options$onSuccess;return _regeneratorRuntime().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,queryClient.invalidateQueries(["rooms",variables.rid,"threads"]);case 2:return _context2.abrupt("return",null==options||null===(_options$onSuccess=options.onSuccess)||void 0===_options$onSuccess?void 0:_options$onSuccess.call(options,data,variables,context));case 3:case"end":return _context2.stop()}}),_callee2)}))),function onSuccess(_x2,_x3,_x4){return _onSuccess.apply(this,arguments)})}))}},"./client/views/room/hooks/useGoToThread.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{R:function(){return useGoToThread}});var _rocket_chat_fuselage_hooks__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@rocket.chat/fuselage-hooks/dist/index.module.js"),_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/ui-contexts/dist/index.js");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var useGoToThread=function useGoToThread(){var _ref$replace=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).replace,replace=void 0!==_ref$replace&&_ref$replace,router=(0,_rocket_chat_ui_contexts__WEBPACK_IMPORTED_MODULE_1__.useRouter)();return(0,_rocket_chat_fuselage_hooks__WEBPACK_IMPORTED_MODULE_0__.useMutableCallback)((function(_ref2){var rid=_ref2.rid,tmid=_ref2.tmid,msg=_ref2.msg,routeName=router.getRouteName();if(!routeName)throw new Error("Route name is not defined");router.navigate({name:routeName,params:_objectSpread(_objectSpread({rid:rid},router.getRouteParameters()),{},{tab:"thread",context:tmid}),search:_objectSpread(_objectSpread({},router.getSearchParameters()),msg&&{msg:msg})},{replace:replace})}))}},"./client/views/room/providers/SelectedMessagesProvider.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{S:function(){return selectedMessageStore},j:function(){return SelectedMessagesProvider}});var _rocket_chat_emitter__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@rocket.chat/emitter/dist/index.module.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_MessageList_contexts_SelectedMessagesContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./client/views/room/MessageList/contexts/SelectedMessagesContext.tsx");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _createSuper(t){var r=_isNativeReflectConstruct();return function(){var e,o=_getPrototypeOf(t);if(r){var s=_getPrototypeOf(this).constructor;e=Reflect.construct(o,arguments,s)}else e=o.apply(this,arguments);return function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}(this,e)}}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}var selectedMessageStore=new(function(_Emitter){!function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}(SelectMessageStore,_Emitter);var _super=_createSuper(SelectMessageStore);function SelectMessageStore(){var _this;!function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}(this,SelectMessageStore);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _defineProperty(_assertThisInitialized(_this=_super.call.apply(_super,[this].concat(args))),"store",new Set),_defineProperty(_assertThisInitialized(_this),"isSelecting",!1),_this}return function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(SelectMessageStore,[{key:"setIsSelecting",value:function setIsSelecting(isSelecting){this.isSelecting=isSelecting,this.emit("toggleIsSelecting",isSelecting)}},{key:"getIsSelecting",value:function getIsSelecting(){return this.isSelecting}},{key:"isSelected",value:function isSelected(mid){return Boolean(this.store.has(mid))}},{key:"getSelectedMessages",value:function getSelectedMessages(){return Array.from(this.store)}},{key:"toggle",value:function toggle(mid){if(this.store.has(mid))return this.store.delete(mid),this.emit(mid,!1),void this.emit("change");this.store.add(mid),this.emit(mid,!0),this.emit("change")}},{key:"count",value:function count(){return this.store.size}},{key:"clearStore",value:function clearStore(){var _this2=this,selectedMessages=this.getSelectedMessages();this.store.clear(),selectedMessages.forEach((function(mid){return _this2.emit(mid,!1)})),this.emit("change")}},{key:"reset",value:function reset(){this.clearStore(),this.isSelecting=!1,this.emit("toggleIsSelecting",!1)}}]),SelectMessageStore}(_rocket_chat_emitter__WEBPACK_IMPORTED_MODULE_0__.v)),SelectedMessagesProvider=function SelectedMessagesProvider(_ref){var children=_ref.children,value=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((function(){return{selectedMessageStore:selectedMessageStore}}),[]);return react__WEBPACK_IMPORTED_MODULE_1__.createElement(_MessageList_contexts_SelectedMessagesContext__WEBPACK_IMPORTED_MODULE_2__.OH.Provider,{value:value},children)};SelectedMessagesProvider.__docgenInfo={description:"",methods:[],displayName:"SelectedMessagesProvider",props:{children:{required:!1,tsType:{name:"ReactNode"},description:""}}}}}]);